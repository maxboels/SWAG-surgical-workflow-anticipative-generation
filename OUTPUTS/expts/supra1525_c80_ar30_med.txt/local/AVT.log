[2024-04-22 17:02:40,281][func.train][INFO] - Dist info:
[2024-04-22 17:02:40,282][func.train][INFO] - torch version: 2.2.2+cu121
[2024-04-22 17:02:40,283][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-04-22 17:02:40,283][func.train][INFO] - hydra version: 1.3.2
[2024-04-22 17:02:40,296][func.train][INFO] - Loading data
[2024-04-22 17:02:40,297][func.train][INFO] - Loading datasets
[2024-04-22 17:02:47,144][func.train][INFO] - [DATASET] ALL loaded dataframe in 0m 7s
[2024-04-22 17:02:47,146][func.train][INFO] - [DATASET] ALL loaded dataframe: (4612530, 11)
[2024-04-22 17:02:49,039][func.train][INFO] - [DATASET] params: {'debug': False, 'dataset_name': 'cholec80', 'reduc_feats_folder': 'train_targets_x_mp/', 'num_classes': 7, 'num_next_labels': 6, 'last_seg_class': 7, 'predict_next_phase': True, 'get_target_feats': False, 'replace_current_with_next_class': False}
[2024-04-22 17:02:54,268][func.train][INFO] - [DATASET] train size: 2157640
[2024-04-22 17:02:54,269][func.train][INFO] - [DATASET] train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40]
[2024-04-22 17:02:54,370][func.train][INFO] - [DATASET] Sampling video_idx: 1 at 25 fps to 1733 frames
[2024-04-22 17:02:55,365][func.train][INFO] - [DATASET] Sampling video_idx: 2 at 25 fps to 2839 frames
[2024-04-22 17:02:55,854][func.train][INFO] - [DATASET] Sampling video_idx: 3 at 25 fps to 5828 frames
[2024-04-22 17:02:56,509][func.train][INFO] - [DATASET] Sampling video_idx: 4 at 25 fps to 1522 frames
[2024-04-22 17:02:56,684][func.train][INFO] - [DATASET] Sampling video_idx: 5 at 25 fps to 2344 frames
[2024-04-22 17:02:56,920][func.train][INFO] - [DATASET] Sampling video_idx: 6 at 25 fps to 2153 frames
[2024-04-22 17:02:57,268][func.train][INFO] - [DATASET] Sampling video_idx: 7 at 25 fps to 4557 frames
[2024-04-22 17:02:57,667][func.train][INFO] - [DATASET] Sampling video_idx: 8 at 25 fps to 1519 frames
[2024-04-22 17:02:58,000][func.train][INFO] - [DATASET] Sampling video_idx: 9 at 25 fps to 2702 frames
[2024-04-22 17:02:58,258][func.train][INFO] - [DATASET] Sampling video_idx: 10 at 25 fps to 1749 frames
[2024-04-22 17:02:58,539][func.train][INFO] - [DATASET] Sampling video_idx: 11 at 25 fps to 3220 frames
[2024-04-22 17:02:58,895][func.train][INFO] - [DATASET] Sampling video_idx: 12 at 25 fps to 1090 frames
[2024-04-22 17:02:59,194][func.train][INFO] - [DATASET] Sampling video_idx: 13 at 25 fps to 981 frames
[2024-04-22 17:02:59,494][func.train][INFO] - [DATASET] Sampling video_idx: 14 at 25 fps to 1708 frames
[2024-04-22 17:02:59,841][func.train][INFO] - [DATASET] Sampling video_idx: 15 at 25 fps to 2058 frames
[2024-04-22 17:03:00,185][func.train][INFO] - [DATASET] Sampling video_idx: 16 at 25 fps to 2957 frames
[2024-04-22 17:03:00,376][func.train][INFO] - [DATASET] Sampling video_idx: 17 at 25 fps to 1304 frames
[2024-04-22 17:03:00,515][func.train][INFO] - [DATASET] Sampling video_idx: 18 at 25 fps to 1942 frames
[2024-04-22 17:03:00,672][func.train][INFO] - [DATASET] Sampling video_idx: 19 at 25 fps to 2424 frames
[2024-04-22 17:03:00,884][func.train][INFO] - [DATASET] Sampling video_idx: 20 at 25 fps to 1449 frames
[2024-04-22 17:03:01,023][func.train][INFO] - [DATASET] Sampling video_idx: 21 at 25 fps to 1258 frames
[2024-04-22 17:03:01,145][func.train][INFO] - [DATASET] Sampling video_idx: 22 at 25 fps to 1532 frames
[2024-04-22 17:03:01,294][func.train][INFO] - [DATASET] Sampling video_idx: 23 at 25 fps to 1635 frames
[2024-04-22 17:03:01,456][func.train][INFO] - [DATASET] Sampling video_idx: 24 at 25 fps to 1975 frames
[2024-04-22 17:03:01,615][func.train][INFO] - [DATASET] Sampling video_idx: 25 at 25 fps to 2129 frames
[2024-04-22 17:03:01,991][func.train][INFO] - [DATASET] Sampling video_idx: 26 at 25 fps to 1773 frames
[2024-04-22 17:03:02,314][func.train][INFO] - [DATASET] Sampling video_idx: 27 at 25 fps to 2084 frames
[2024-04-22 17:03:02,507][func.train][INFO] - [DATASET] Sampling video_idx: 28 at 25 fps to 1199 frames
[2024-04-22 17:03:02,826][func.train][INFO] - [DATASET] Sampling video_idx: 29 at 25 fps to 2350 frames
[2024-04-22 17:03:03,176][func.train][INFO] - [DATASET] Sampling video_idx: 30 at 25 fps to 2925 frames
[2024-04-22 17:03:03,549][func.train][INFO] - [DATASET] Sampling video_idx: 31 at 25 fps to 3945 frames
[2024-04-22 17:03:03,905][func.train][INFO] - [DATASET] Sampling video_idx: 32 at 25 fps to 2116 frames
[2024-04-22 17:03:04,208][func.train][INFO] - [DATASET] Sampling video_idx: 33 at 25 fps to 1307 frames
[2024-04-22 17:03:04,527][func.train][INFO] - [DATASET] Sampling video_idx: 34 at 25 fps to 1323 frames
[2024-04-22 17:03:04,834][func.train][INFO] - [DATASET] Sampling video_idx: 35 at 25 fps to 2106 frames
[2024-04-22 17:03:05,168][func.train][INFO] - [DATASET] Sampling video_idx: 36 at 25 fps to 2387 frames
[2024-04-22 17:03:05,484][func.train][INFO] - [DATASET] Sampling video_idx: 37 at 25 fps to 1232 frames
[2024-04-22 17:03:05,822][func.train][INFO] - [DATASET] Sampling video_idx: 38 at 25 fps to 3080 frames
[2024-04-22 17:03:06,178][func.train][INFO] - [DATASET] Sampling video_idx: 39 at 25 fps to 1647 frames
[2024-04-22 17:03:06,311][func.train][INFO] - [DATASET] Sampling video_idx: 40 at 25 fps to 2222 frames
[2024-04-22 17:03:06,658][func.train][INFO] - [DATASET] classes_counts: {0: 93902, 1: 922150, 2: 183225, 3: 602975, 4: 92900, 5: 180478, 6: 82010}
[2024-04-22 17:03:06,662][func.train][INFO] - [DATASET] class_weights: tensor([0.3342, 1.6821, 0.5112, 3.3171, 1.7077, 3.7575, 3.2818])
[2024-04-22 17:03:08,500][func.train][INFO] - [DATASET] test size: 77576
[2024-04-22 17:03:08,500][func.train][INFO] - [DATASET] test video_indices: [41]
[2024-04-22 17:03:08,512][func.train][INFO] - [DATASET] Sampling video_idx: 41 at 25 fps to 3103 frames
[2024-04-22 17:03:10,234][func.train][INFO] - [DATASET] test size: 92801
[2024-04-22 17:03:10,234][func.train][INFO] - [DATASET] test video_indices: [42]
[2024-04-22 17:03:10,251][func.train][INFO] - [DATASET] Sampling video_idx: 42 at 25 fps to 3712 frames
[2024-04-22 17:03:11,975][func.train][INFO] - [DATASET] test size: 59051
[2024-04-22 17:03:11,976][func.train][INFO] - [DATASET] test video_indices: [43]
[2024-04-22 17:03:11,985][func.train][INFO] - [DATASET] Sampling video_idx: 43 at 25 fps to 2362 frames
[2024-04-22 17:03:13,775][func.train][INFO] - [DATASET] test size: 78176
[2024-04-22 17:03:13,776][func.train][INFO] - [DATASET] test video_indices: [44]
[2024-04-22 17:03:13,791][func.train][INFO] - [DATASET] Sampling video_idx: 44 at 25 fps to 3127 frames
[2024-04-22 17:03:15,879][func.train][INFO] - [DATASET] test size: 84676
[2024-04-22 17:03:15,879][func.train][INFO] - [DATASET] test video_indices: [45]
[2024-04-22 17:03:15,896][func.train][INFO] - [DATASET] Sampling video_idx: 45 at 25 fps to 3387 frames
[2024-04-22 17:03:17,809][func.train][INFO] - [DATASET] test size: 41326
[2024-04-22 17:03:17,810][func.train][INFO] - [DATASET] test video_indices: [46]
[2024-04-22 17:03:17,818][func.train][INFO] - [DATASET] Sampling video_idx: 46 at 25 fps to 1653 frames
[2024-04-22 17:03:19,524][func.train][INFO] - [DATASET] test size: 56476
[2024-04-22 17:03:19,525][func.train][INFO] - [DATASET] test video_indices: [47]
[2024-04-22 17:03:19,550][func.train][INFO] - [DATASET] Sampling video_idx: 47 at 25 fps to 2259 frames
[2024-04-22 17:03:22,004][func.train][INFO] - [DATASET] test size: 45851
[2024-04-22 17:03:22,004][func.train][INFO] - [DATASET] test video_indices: [48]
[2024-04-22 17:03:22,019][func.train][INFO] - [DATASET] Sampling video_idx: 48 at 25 fps to 1834 frames
[2024-04-22 17:03:25,023][func.train][INFO] - [DATASET] test size: 41776
[2024-04-22 17:03:25,023][func.train][INFO] - [DATASET] test video_indices: [49]
[2024-04-22 17:03:25,032][func.train][INFO] - [DATASET] Sampling video_idx: 49 at 25 fps to 1671 frames
[2024-04-22 17:03:26,895][func.train][INFO] - [DATASET] test size: 27351
[2024-04-22 17:03:26,895][func.train][INFO] - [DATASET] test video_indices: [50]
[2024-04-22 17:03:26,902][func.train][INFO] - [DATASET] Sampling video_idx: 50 at 25 fps to 1094 frames
[2024-04-22 17:03:29,076][func.train][INFO] - [DATASET] test size: 73601
[2024-04-22 17:03:29,076][func.train][INFO] - [DATASET] test video_indices: [51]
[2024-04-22 17:03:29,091][func.train][INFO] - [DATASET] Sampling video_idx: 51 at 25 fps to 2944 frames
[2024-04-22 17:03:30,967][func.train][INFO] - [DATASET] test size: 49151
[2024-04-22 17:03:30,968][func.train][INFO] - [DATASET] test video_indices: [52]
[2024-04-22 17:03:30,977][func.train][INFO] - [DATASET] Sampling video_idx: 52 at 25 fps to 1966 frames
[2024-04-22 17:03:32,796][func.train][INFO] - [DATASET] test size: 82076
[2024-04-22 17:03:32,797][func.train][INFO] - [DATASET] test video_indices: [53]
[2024-04-22 17:03:32,811][func.train][INFO] - [DATASET] Sampling video_idx: 53 at 25 fps to 3283 frames
[2024-04-22 17:03:34,618][func.train][INFO] - [DATASET] test size: 77501
[2024-04-22 17:03:34,618][func.train][INFO] - [DATASET] test video_indices: [54]
[2024-04-22 17:03:34,632][func.train][INFO] - [DATASET] Sampling video_idx: 54 at 25 fps to 3100 frames
[2024-04-22 17:03:36,664][func.train][INFO] - [DATASET] test size: 25926
[2024-04-22 17:03:36,665][func.train][INFO] - [DATASET] test video_indices: [55]
[2024-04-22 17:03:36,672][func.train][INFO] - [DATASET] Sampling video_idx: 55 at 25 fps to 1037 frames
[2024-04-22 17:03:38,562][func.train][INFO] - [DATASET] test size: 45851
[2024-04-22 17:03:38,562][func.train][INFO] - [DATASET] test video_indices: [56]
[2024-04-22 17:03:38,573][func.train][INFO] - [DATASET] Sampling video_idx: 56 at 25 fps to 1834 frames
[2024-04-22 17:03:40,249][func.train][INFO] - [DATASET] test size: 65801
[2024-04-22 17:03:40,249][func.train][INFO] - [DATASET] test video_indices: [57]
[2024-04-22 17:03:40,262][func.train][INFO] - [DATASET] Sampling video_idx: 57 at 25 fps to 2632 frames
[2024-04-22 17:03:41,996][func.train][INFO] - [DATASET] test size: 149826
[2024-04-22 17:03:41,997][func.train][INFO] - [DATASET] test video_indices: [58]
[2024-04-22 17:03:42,023][func.train][INFO] - [DATASET] Sampling video_idx: 58 at 25 fps to 5993 frames
[2024-04-22 17:03:43,747][func.train][INFO] - [DATASET] test size: 26151
[2024-04-22 17:03:43,747][func.train][INFO] - [DATASET] test video_indices: [59]
[2024-04-22 17:03:43,753][func.train][INFO] - [DATASET] Sampling video_idx: 59 at 25 fps to 1046 frames
[2024-04-22 17:03:45,379][func.train][INFO] - [DATASET] test size: 63301
[2024-04-22 17:03:45,380][func.train][INFO] - [DATASET] test video_indices: [60]
[2024-04-22 17:03:45,391][func.train][INFO] - [DATASET] Sampling video_idx: 60 at 25 fps to 2532 frames
[2024-04-22 17:03:47,248][func.train][INFO] - [DATASET] test size: 110226
[2024-04-22 17:03:47,249][func.train][INFO] - [DATASET] test video_indices: [61]
[2024-04-22 17:03:47,269][func.train][INFO] - [DATASET] Sampling video_idx: 61 at 25 fps to 4409 frames
[2024-04-22 17:03:49,153][func.train][INFO] - [DATASET] test size: 50801
[2024-04-22 17:03:49,153][func.train][INFO] - [DATASET] test video_indices: [62]
[2024-04-22 17:03:49,162][func.train][INFO] - [DATASET] Sampling video_idx: 62 at 25 fps to 2032 frames
[2024-04-22 17:03:50,905][func.train][INFO] - [DATASET] test size: 85826
[2024-04-22 17:03:50,906][func.train][INFO] - [DATASET] test video_indices: [63]
[2024-04-22 17:03:50,920][func.train][INFO] - [DATASET] Sampling video_idx: 63 at 25 fps to 3433 frames
[2024-04-22 17:03:52,777][func.train][INFO] - [DATASET] test size: 59951
[2024-04-22 17:03:52,778][func.train][INFO] - [DATASET] test video_indices: [64]
[2024-04-22 17:03:52,790][func.train][INFO] - [DATASET] Sampling video_idx: 64 at 25 fps to 2398 frames
[2024-04-22 17:03:54,599][func.train][INFO] - [DATASET] test size: 46826
[2024-04-22 17:03:54,599][func.train][INFO] - [DATASET] test video_indices: [65]
[2024-04-22 17:03:54,608][func.train][INFO] - [DATASET] Sampling video_idx: 65 at 25 fps to 1873 frames
[2024-04-22 17:03:56,861][func.train][INFO] - [DATASET] test size: 45601
[2024-04-22 17:03:56,861][func.train][INFO] - [DATASET] test video_indices: [66]
[2024-04-22 17:03:56,872][func.train][INFO] - [DATASET] Sampling video_idx: 66 at 25 fps to 1824 frames
[2024-04-22 17:03:59,167][func.train][INFO] - [DATASET] test size: 58826
[2024-04-22 17:03:59,168][func.train][INFO] - [DATASET] test video_indices: [67]
[2024-04-22 17:03:59,188][func.train][INFO] - [DATASET] Sampling video_idx: 67 at 25 fps to 2353 frames
[2024-04-22 17:04:04,495][func.train][INFO] - [DATASET] test size: 49301
[2024-04-22 17:04:04,496][func.train][INFO] - [DATASET] test video_indices: [68]
[2024-04-22 17:04:04,510][func.train][INFO] - [DATASET] Sampling video_idx: 68 at 25 fps to 1972 frames
[2024-04-22 17:04:09,501][func.train][INFO] - [DATASET] test size: 114376
[2024-04-22 17:04:09,502][func.train][INFO] - [DATASET] test video_indices: [69]
[2024-04-22 17:04:09,536][func.train][INFO] - [DATASET] Sampling video_idx: 69 at 25 fps to 4575 frames
[2024-04-22 17:04:13,745][func.train][INFO] - [DATASET] test size: 29851
[2024-04-22 17:04:13,746][func.train][INFO] - [DATASET] test video_indices: [70]
[2024-04-22 17:04:13,763][func.train][INFO] - [DATASET] Sampling video_idx: 70 at 25 fps to 1194 frames
[2024-04-22 17:04:17,380][func.train][INFO] - [DATASET] test size: 62876
[2024-04-22 17:04:17,381][func.train][INFO] - [DATASET] test video_indices: [71]
[2024-04-22 17:04:17,410][func.train][INFO] - [DATASET] Sampling video_idx: 71 at 25 fps to 2515 frames
[2024-04-22 17:04:21,382][func.train][INFO] - [DATASET] test size: 77651
[2024-04-22 17:04:21,383][func.train][INFO] - [DATASET] test video_indices: [72]
[2024-04-22 17:04:21,402][func.train][INFO] - [DATASET] Sampling video_idx: 72 at 25 fps to 3106 frames
[2024-04-22 17:04:23,775][func.train][INFO] - [DATASET] test size: 33901
[2024-04-22 17:04:23,775][func.train][INFO] - [DATASET] test video_indices: [73]
[2024-04-22 17:04:23,784][func.train][INFO] - [DATASET] Sampling video_idx: 73 at 25 fps to 1356 frames
[2024-04-22 17:04:25,853][func.train][INFO] - [DATASET] test size: 40851
[2024-04-22 17:04:25,853][func.train][INFO] - [DATASET] test video_indices: [74]
[2024-04-22 17:04:25,862][func.train][INFO] - [DATASET] Sampling video_idx: 74 at 25 fps to 1634 frames
[2024-04-22 17:04:27,793][func.train][INFO] - [DATASET] test size: 48076
[2024-04-22 17:04:27,793][func.train][INFO] - [DATASET] test video_indices: [75]
[2024-04-22 17:04:27,805][func.train][INFO] - [DATASET] Sampling video_idx: 75 at 25 fps to 1923 frames
[2024-04-22 17:04:32,586][func.train][INFO] - [DATASET] test size: 66226
[2024-04-22 17:04:32,587][func.train][INFO] - [DATASET] test video_indices: [76]
[2024-04-22 17:04:32,619][func.train][INFO] - [DATASET] Sampling video_idx: 76 at 25 fps to 2649 frames
[2024-04-22 17:04:37,344][func.train][INFO] - [DATASET] test size: 62551
[2024-04-22 17:04:37,345][func.train][INFO] - [DATASET] test video_indices: [77]
[2024-04-22 17:04:37,361][func.train][INFO] - [DATASET] Sampling video_idx: 77 at 25 fps to 2502 frames
[2024-04-22 17:04:41,261][func.train][INFO] - [DATASET] test size: 18476
[2024-04-22 17:04:41,261][func.train][INFO] - [DATASET] test video_indices: [78]
[2024-04-22 17:04:41,266][func.train][INFO] - [DATASET] Sampling video_idx: 78 at 25 fps to 739 frames
[2024-04-22 17:04:42,917][func.train][INFO] - [DATASET] test size: 85351
[2024-04-22 17:04:42,918][func.train][INFO] - [DATASET] test video_indices: [79]
[2024-04-22 17:04:42,932][func.train][INFO] - [DATASET] Sampling video_idx: 79 at 25 fps to 3414 frames
[2024-04-22 17:04:44,605][func.train][INFO] - [DATASET] test size: 43101
[2024-04-22 17:04:44,605][func.train][INFO] - [DATASET] test video_indices: [80]
[2024-04-22 17:04:44,613][func.train][INFO] - [DATASET] Sampling video_idx: 80 at 25 fps to 1724 frames
[2024-04-22 17:04:44,627][func.train][INFO] - Time to load datasets: 2.07 min
[2024-04-22 17:04:44,627][func.train][INFO] - Creating data loaders
[2024-04-22 17:04:44,630][func.train][INFO] - Creating model with {'one': 7} classes
[2024-04-22 17:04:48,377][func.train][INFO] - [MAIN] Number of parameters: 86304
[2024-04-22 17:04:48,377][func.train][INFO] - [MAIN] Number of tokens: 21026518
[2024-04-22 17:04:48,378][func.train][INFO] - [MAIN] Token-to-Parameter Ratio is ideally between [1:1 to 10:1]: 0.004105
[2024-04-22 17:04:48,378][func.train][WARNING] - [MAIN] Data-to-Parameter-Ratio is outside the interval [1:1 to 10:1]
[2024-04-22 17:04:48,379][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-04-22 17:04:48,380][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-04-22 17:04:48,387][func.train][INFO] - Wrapping model into DP
[2024-04-22 17:04:48,640][func.train][INFO] - Start training
[2024-04-22 17:04:48,645][func.train][INFO] - Storing checkpoints every 60.00 mins
[2024-04-22 17:04:50,028][func.train][INFO] - [TRAINING] Step 0/10788 | Loss: 2.75 | Acc (curr_frames): 0.14 | Acc (next_frames): 0.32 | time-left: 248.63 min
[2024-04-22 17:05:14,585][func.train][INFO] - [TRAINING] Step 100/10788 | Loss: 3.13 | Acc (curr_frames): 0.55 | Acc (next_frames): 0.19 | time-left: 45.74 min
[2024-04-22 17:05:38,241][func.train][INFO] - [TRAINING] Step 200/10788 | Loss: 2.22 | Acc (curr_frames): 0.54 | Acc (next_frames): 0.27 | time-left: 43.54 min
[2024-04-22 17:06:00,044][func.train][INFO] - [TRAINING] Step 300/10788 | Loss: 1.57 | Acc (curr_frames): 0.39 | Acc (next_frames): 0.40 | time-left: 41.46 min
[2024-04-22 17:06:21,250][func.train][INFO] - [TRAINING] Step 400/10788 | Loss: 1.81 | Acc (curr_frames): 0.72 | Acc (next_frames): 0.31 | time-left: 39.98 min
[2024-04-22 17:06:40,518][func.train][INFO] - [TRAINING] Step 500/10788 | Loss: 1.64 | Acc (curr_frames): 0.60 | Acc (next_frames): 0.49 | time-left: 38.28 min
[2024-04-22 17:07:01,658][func.train][INFO] - [TRAINING] Step 600/10788 | Loss: 2.36 | Acc (curr_frames): 0.28 | Acc (next_frames): 0.36 | time-left: 37.58 min
[2024-04-22 17:07:20,511][func.train][INFO] - [TRAINING] Step 700/10788 | Loss: 1.80 | Acc (curr_frames): 0.44 | Acc (next_frames): 0.45 | time-left: 36.42 min
