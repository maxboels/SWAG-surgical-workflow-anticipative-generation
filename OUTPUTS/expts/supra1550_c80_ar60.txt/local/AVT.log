[2024-04-18 22:01:01,936][func.train][INFO] - Dist info:
[2024-04-18 22:01:01,937][func.train][INFO] - torch version: 2.2.2+cu121
[2024-04-18 22:01:01,938][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-04-18 22:01:01,938][func.train][INFO] - hydra version: 1.3.2
[2024-04-18 22:01:01,943][func.train][INFO] - Loading data
[2024-04-18 22:01:01,943][func.train][INFO] - Loading datasets
[2024-04-18 22:01:05,027][func.train][INFO] - [DATASET] ALL loaded dataframe in 0m 3s
[2024-04-18 22:01:05,028][func.train][INFO] - [DATASET] ALL loaded dataframe: (4612530, 11)
[2024-04-18 22:01:05,961][func.train][INFO] - [DATASET] params: {'debug': False, 'dataset_name': 'cholec80', 'reduc_feats_folder': 'train_targets_x_mp/', 'num_classes': 7, 'feats_dim': 64, 'num_next_labels': 6, 'last_seg_class': 7, 'predict_next_phase': True, 'get_target_feats': False, 'replace_current_with_next_class': False}
[2024-04-18 22:01:10,904][func.train][INFO] - [DATASET] train size: 2157640
[2024-04-18 22:01:10,905][func.train][INFO] - [DATASET] train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40]
[2024-04-18 22:01:19,846][func.train][INFO] - [DATASET] test size: 77576
[2024-04-18 22:01:19,846][func.train][INFO] - [DATASET] test video_indices: [41]
[2024-04-18 22:01:22,504][func.train][INFO] - [DATASET] test size: 92801
[2024-04-18 22:01:22,505][func.train][INFO] - [DATASET] test video_indices: [42]
[2024-04-18 22:01:25,605][func.train][INFO] - [DATASET] test size: 59051
[2024-04-18 22:01:25,606][func.train][INFO] - [DATASET] test video_indices: [43]
[2024-04-18 22:01:28,300][func.train][INFO] - [DATASET] test size: 78176
[2024-04-18 22:01:28,301][func.train][INFO] - [DATASET] test video_indices: [44]
[2024-04-18 22:01:30,680][func.train][INFO] - [DATASET] test size: 84676
[2024-04-18 22:01:30,680][func.train][INFO] - [DATASET] test video_indices: [45]
[2024-04-18 22:01:33,053][func.train][INFO] - [DATASET] test size: 41326
[2024-04-18 22:01:33,054][func.train][INFO] - [DATASET] test video_indices: [46]
[2024-04-18 22:01:35,131][func.train][INFO] - [DATASET] test size: 56476
[2024-04-18 22:01:35,132][func.train][INFO] - [DATASET] test video_indices: [47]
[2024-04-18 22:01:37,606][func.train][INFO] - [DATASET] test size: 45851
[2024-04-18 22:01:37,607][func.train][INFO] - [DATASET] test video_indices: [48]
[2024-04-18 22:01:39,717][func.train][INFO] - [DATASET] test size: 41776
[2024-04-18 22:01:39,718][func.train][INFO] - [DATASET] test video_indices: [49]
[2024-04-18 22:01:42,175][func.train][INFO] - [DATASET] test size: 27351
[2024-04-18 22:01:42,176][func.train][INFO] - [DATASET] test video_indices: [50]
[2024-04-18 22:01:44,653][func.train][INFO] - [DATASET] test size: 73601
[2024-04-18 22:01:44,653][func.train][INFO] - [DATASET] test video_indices: [51]
[2024-04-18 22:01:46,761][func.train][INFO] - [DATASET] test size: 49151
[2024-04-18 22:01:46,762][func.train][INFO] - [DATASET] test video_indices: [52]
[2024-04-18 22:01:48,782][func.train][INFO] - [DATASET] test size: 82076
[2024-04-18 22:01:48,782][func.train][INFO] - [DATASET] test video_indices: [53]
[2024-04-18 22:01:50,714][func.train][INFO] - [DATASET] test size: 77501
[2024-04-18 22:01:50,714][func.train][INFO] - [DATASET] test video_indices: [54]
[2024-04-18 22:01:52,767][func.train][INFO] - [DATASET] test size: 25926
[2024-04-18 22:01:52,767][func.train][INFO] - [DATASET] test video_indices: [55]
[2024-04-18 22:01:55,637][func.train][INFO] - [DATASET] test size: 45851
[2024-04-18 22:01:55,638][func.train][INFO] - [DATASET] test video_indices: [56]
[2024-04-18 22:01:57,867][func.train][INFO] - [DATASET] test size: 65801
[2024-04-18 22:01:57,868][func.train][INFO] - [DATASET] test video_indices: [57]
[2024-04-18 22:02:01,013][func.train][INFO] - [DATASET] test size: 149826
[2024-04-18 22:02:01,014][func.train][INFO] - [DATASET] test video_indices: [58]
[2024-04-18 22:02:03,759][func.train][INFO] - [DATASET] test size: 26151
[2024-04-18 22:02:03,759][func.train][INFO] - [DATASET] test video_indices: [59]
[2024-04-18 22:02:05,886][func.train][INFO] - [DATASET] test size: 63301
[2024-04-18 22:02:05,886][func.train][INFO] - [DATASET] test video_indices: [60]
[2024-04-18 22:02:08,271][func.train][INFO] - [DATASET] test size: 110226
[2024-04-18 22:02:08,271][func.train][INFO] - [DATASET] test video_indices: [61]
[2024-04-18 22:02:11,049][func.train][INFO] - [DATASET] test size: 50801
[2024-04-18 22:02:11,050][func.train][INFO] - [DATASET] test video_indices: [62]
[2024-04-18 22:02:13,579][func.train][INFO] - [DATASET] test size: 85826
[2024-04-18 22:02:13,579][func.train][INFO] - [DATASET] test video_indices: [63]
[2024-04-18 22:02:15,855][func.train][INFO] - [DATASET] test size: 59951
[2024-04-18 22:02:15,855][func.train][INFO] - [DATASET] test video_indices: [64]
[2024-04-18 22:02:18,283][func.train][INFO] - [DATASET] test size: 46826
[2024-04-18 22:02:18,284][func.train][INFO] - [DATASET] test video_indices: [65]
[2024-04-18 22:02:20,467][func.train][INFO] - [DATASET] test size: 45601
[2024-04-18 22:02:20,467][func.train][INFO] - [DATASET] test video_indices: [66]
[2024-04-18 22:02:22,752][func.train][INFO] - [DATASET] test size: 58826
[2024-04-18 22:02:22,752][func.train][INFO] - [DATASET] test video_indices: [67]
[2024-04-18 22:02:24,988][func.train][INFO] - [DATASET] test size: 49301
[2024-04-18 22:02:24,989][func.train][INFO] - [DATASET] test video_indices: [68]
[2024-04-18 22:02:27,275][func.train][INFO] - [DATASET] test size: 114376
[2024-04-18 22:02:27,276][func.train][INFO] - [DATASET] test video_indices: [69]
[2024-04-18 22:02:29,931][func.train][INFO] - [DATASET] test size: 29851
[2024-04-18 22:02:29,931][func.train][INFO] - [DATASET] test video_indices: [70]
[2024-04-18 22:02:31,966][func.train][INFO] - [DATASET] test size: 62876
[2024-04-18 22:02:31,966][func.train][INFO] - [DATASET] test video_indices: [71]
[2024-04-18 22:02:34,145][func.train][INFO] - [DATASET] test size: 77651
[2024-04-18 22:02:34,145][func.train][INFO] - [DATASET] test video_indices: [72]
[2024-04-18 22:02:36,116][func.train][INFO] - [DATASET] test size: 33901
[2024-04-18 22:02:36,117][func.train][INFO] - [DATASET] test video_indices: [73]
[2024-04-18 22:02:38,186][func.train][INFO] - [DATASET] test size: 40851
[2024-04-18 22:02:38,186][func.train][INFO] - [DATASET] test video_indices: [74]
[2024-04-18 22:02:40,248][func.train][INFO] - [DATASET] test size: 48076
[2024-04-18 22:02:40,248][func.train][INFO] - [DATASET] test video_indices: [75]
[2024-04-18 22:02:42,394][func.train][INFO] - [DATASET] test size: 66226
[2024-04-18 22:02:42,395][func.train][INFO] - [DATASET] test video_indices: [76]
[2024-04-18 22:02:44,318][func.train][INFO] - [DATASET] test size: 62551
[2024-04-18 22:02:44,318][func.train][INFO] - [DATASET] test video_indices: [77]
[2024-04-18 22:02:46,121][func.train][INFO] - [DATASET] test size: 18476
[2024-04-18 22:02:46,121][func.train][INFO] - [DATASET] test video_indices: [78]
[2024-04-18 22:02:47,978][func.train][INFO] - [DATASET] test size: 85351
[2024-04-18 22:02:47,978][func.train][INFO] - [DATASET] test video_indices: [79]
[2024-04-18 22:02:49,858][func.train][INFO] - [DATASET] test size: 43101
[2024-04-18 22:02:49,858][func.train][INFO] - [DATASET] test video_indices: [80]
[2024-04-18 22:02:49,881][func.train][INFO] - Time taken to load datasets: 107.936938
[2024-04-18 22:02:49,882][func.train][INFO] - Creating data loaders
[2024-04-18 22:02:49,885][func.train][INFO] - Creating model with {'one': 7} classes
[2024-04-18 22:02:51,080][func.train][INFO] - [MAIN] Number of parameters: 39530989
[2024-04-18 22:02:51,080][func.train][INFO] - [MAIN] Number of samples: 86304
[2024-04-18 22:02:51,081][func.train][INFO] - [MAIN] Data-to-Parameter-Ratio is ideally between [1:1 to 10:1]: 458.043532
[2024-04-18 22:02:51,082][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-04-18 22:02:51,082][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-04-18 22:02:51,090][func.train][INFO] - Wrapping model into DP
[2024-04-18 22:02:51,198][func.train][INFO] - Start training
[2024-04-18 22:02:51,203][func.train][INFO] - Storing checkpoints every 60.00 mins
[2024-04-19 15:11:49,461][func.train][INFO] - Dist info:
[2024-04-19 15:11:49,462][func.train][INFO] - torch version: 2.2.2+cu121
[2024-04-19 15:11:49,463][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-04-19 15:11:49,463][func.train][INFO] - hydra version: 1.3.2
[2024-04-19 15:11:49,467][func.train][INFO] - Loading data
[2024-04-19 15:11:49,467][func.train][INFO] - Loading datasets
[2024-04-19 15:15:05,511][func.train][INFO] - Dist info:
[2024-04-19 15:15:05,513][func.train][INFO] - torch version: 2.2.2+cu121
[2024-04-19 15:15:05,514][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-04-19 15:15:05,515][func.train][INFO] - hydra version: 1.3.2
[2024-04-19 15:15:05,521][func.train][INFO] - Loading data
[2024-04-19 15:15:05,521][func.train][INFO] - Loading datasets
[2024-04-19 15:15:10,314][func.train][INFO] - [DATASET] ALL loaded dataframe in 0m 5s
[2024-04-19 15:15:10,315][func.train][INFO] - [DATASET] ALL loaded dataframe: (4612530, 11)
[2024-04-19 15:25:00,155][func.train][INFO] - Dist info:
[2024-04-19 15:25:00,156][func.train][INFO] - torch version: 2.2.2+cu121
[2024-04-19 15:25:00,157][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-04-19 15:25:00,157][func.train][INFO] - hydra version: 1.3.2
[2024-04-19 15:25:00,172][func.train][INFO] - Loading data
[2024-04-19 15:25:00,173][func.train][INFO] - Loading datasets
[2024-04-19 15:25:03,970][func.train][INFO] - [DATASET] ALL loaded dataframe in 0m 4s
[2024-04-19 15:25:03,970][func.train][INFO] - [DATASET] ALL loaded dataframe: (4612530, 11)
[2024-04-19 15:25:05,157][func.train][INFO] - [DATASET] params: {'debug': False, 'dataset_name': 'cholec80', 'reduc_feats_folder': 'train_targets_x_mp/', 'num_classes': 7, 'num_next_labels': 6, 'last_seg_class': 7, 'predict_next_phase': True, 'get_target_feats': False, 'replace_current_with_next_class': False}
[2024-04-19 15:25:10,320][func.train][INFO] - [DATASET] train size: 2157640
[2024-04-19 15:25:10,321][func.train][INFO] - [DATASET] train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40]
[2024-04-19 15:25:26,601][func.train][INFO] - [DATASET] test size: 77576
[2024-04-19 15:25:26,602][func.train][INFO] - [DATASET] test video_indices: [41]
[2024-04-19 15:25:29,663][func.train][INFO] - [DATASET] test size: 92801
[2024-04-19 15:25:29,664][func.train][INFO] - [DATASET] test video_indices: [42]
[2024-04-19 15:25:33,228][func.train][INFO] - [DATASET] test size: 59051
[2024-04-19 15:25:33,229][func.train][INFO] - [DATASET] test video_indices: [43]
[2024-04-19 15:25:36,307][func.train][INFO] - [DATASET] test size: 78176
[2024-04-19 15:25:36,307][func.train][INFO] - [DATASET] test video_indices: [44]
[2024-04-19 15:25:39,017][func.train][INFO] - [DATASET] test size: 84676
[2024-04-19 15:25:39,017][func.train][INFO] - [DATASET] test video_indices: [45]
[2024-04-19 15:25:41,874][func.train][INFO] - [DATASET] test size: 41326
[2024-04-19 15:25:41,874][func.train][INFO] - [DATASET] test video_indices: [46]
[2024-04-19 15:25:44,818][func.train][INFO] - [DATASET] test size: 56476
[2024-04-19 15:25:44,819][func.train][INFO] - [DATASET] test video_indices: [47]
[2024-04-19 15:25:47,588][func.train][INFO] - [DATASET] test size: 45851
[2024-04-19 15:25:47,589][func.train][INFO] - [DATASET] test video_indices: [48]
[2024-04-19 15:25:51,704][func.train][INFO] - [DATASET] test size: 41776
[2024-04-19 15:25:51,704][func.train][INFO] - [DATASET] test video_indices: [49]
[2024-04-19 15:26:47,793][func.train][INFO] - [DATASET] test size: 27351
[2024-04-19 15:26:47,794][func.train][INFO] - [DATASET] test video_indices: [50]
[2024-04-19 15:26:51,981][func.train][INFO] - [DATASET] test size: 73601
[2024-04-19 15:26:51,982][func.train][INFO] - [DATASET] test video_indices: [51]
[2024-04-19 15:26:55,215][func.train][INFO] - [DATASET] test size: 49151
[2024-04-19 15:26:55,216][func.train][INFO] - [DATASET] test video_indices: [52]
[2024-04-19 15:26:59,909][func.train][INFO] - [DATASET] test size: 82076
[2024-04-19 15:26:59,911][func.train][INFO] - [DATASET] test video_indices: [53]
[2024-04-19 15:27:02,718][func.train][INFO] - [DATASET] test size: 77501
[2024-04-19 15:27:02,718][func.train][INFO] - [DATASET] test video_indices: [54]
[2024-04-19 15:27:05,847][func.train][INFO] - [DATASET] test size: 25926
[2024-04-19 15:27:05,847][func.train][INFO] - [DATASET] test video_indices: [55]
[2024-04-19 15:27:08,704][func.train][INFO] - [DATASET] test size: 45851
[2024-04-19 15:27:08,704][func.train][INFO] - [DATASET] test video_indices: [56]
[2024-04-19 15:27:11,513][func.train][INFO] - [DATASET] test size: 65801
[2024-04-19 15:27:11,514][func.train][INFO] - [DATASET] test video_indices: [57]
[2024-04-19 15:27:14,750][func.train][INFO] - [DATASET] test size: 149826
[2024-04-19 15:27:14,750][func.train][INFO] - [DATASET] test video_indices: [58]
[2024-04-19 15:27:18,533][func.train][INFO] - [DATASET] test size: 26151
[2024-04-19 15:27:18,534][func.train][INFO] - [DATASET] test video_indices: [59]
[2024-04-19 15:27:21,071][func.train][INFO] - [DATASET] test size: 63301
[2024-04-19 15:27:21,072][func.train][INFO] - [DATASET] test video_indices: [60]
[2024-04-19 15:27:23,563][func.train][INFO] - [DATASET] test size: 110226
[2024-04-19 15:27:23,564][func.train][INFO] - [DATASET] test video_indices: [61]
[2024-04-19 15:27:27,756][func.train][INFO] - [DATASET] test size: 50801
[2024-04-19 15:27:27,757][func.train][INFO] - [DATASET] test video_indices: [62]
