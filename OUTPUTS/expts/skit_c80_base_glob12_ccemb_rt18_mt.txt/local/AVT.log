[2024-07-11 13:41:41,321][func.train][INFO] - Dist info:
[2024-07-11 13:41:41,321][func.train][INFO] - torch version: 2.2.2+cu121
[2024-07-11 13:41:41,322][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-07-11 13:41:41,322][func.train][INFO] - hydra version: 1.3.2
[2024-07-11 13:41:41,327][func.train][INFO] - Loading data
[2024-07-11 13:41:41,327][func.train][INFO] - Loading datasets
[2024-07-11 13:41:43,678][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe in 0m 2s
[2024-07-11 13:41:43,678][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe: (4612530, 11)
[2024-07-11 13:41:43,894][func.train][INFO] - [SELECT DATASET] labels are already starting from 0
[2024-07-11 13:41:44,249][func.train][INFO] - [SELECT DATASET] ALL unique classes: [0 1 2 3 4 5 6]
[2024-07-11 13:41:44,265][func.train][INFO] - [SELECT DATASET] aLL dataframe (head):                    image_path class  ... tool_Irrigator tool_SpecimenBag
0  video01/video01_000001.png     0  ...              0                0
1  video01/video01_000002.png     0  ...              0                0
2  video01/video01_000003.png     0  ...              0                0
3  video01/video01_000004.png     0  ...              0                0
4  video01/video01_000005.png     0  ...              0                0

[5 rows x 11 columns]
[2024-07-11 13:41:44,277][func.train][INFO] - [SELECT DATASET] ALL dataframe (tail):                          image_path class  ... tool_Irrigator tool_SpecimenBag
4612525  video80/video80_043097.png     6  ...              0                0
4612526  video80/video80_043098.png     6  ...              0                0
4612527  video80/video80_043099.png     6  ...              0                0
4612528  video80/video80_043100.png     6  ...              0                0
4612529  video80/video80_043101.png     6  ...              0                0

[5 rows x 11 columns]
[2024-07-11 13:41:44,278][func.train][INFO] - [DATASET] params: {'debug': False, 'dataset_name': 'cholec80', 'reduc_feats_folder': 'train_targets_x_mp/', 'num_classes': 7, 'num_next_labels': 6, 'last_seg_class': 7, 'predict_next_phase': True, 'get_target_feats': False, 'replace_current_with_next_class': False}
[2024-07-11 13:41:45,751][func.train][INFO] - [DATASET] df unique videos: [1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27
 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51
 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75
 76 77 78 79 80]
[2024-07-11 13:41:45,752][func.train][INFO] - [DATASET] split: train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40]
[2024-07-11 13:41:47,663][func.train][INFO] - [DATASET] train size: 2157640
[2024-07-11 13:41:47,663][func.train][INFO] - [DATASET] train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40]
[2024-07-11 13:41:47,663][func.train][INFO] - [DATASET] video_idx: 1
[2024-07-11 13:41:47,750][func.train][INFO] - [DATASET] Sampled video_idx: 1 at 25 fps to 1733 frames
[2024-07-11 13:41:47,774][func.train][INFO] - [DATASET] video 1 phase_labels: torch.Size([1733])
[2024-07-11 13:41:48,232][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([1733, 8])
[2024-07-11 13:41:48,232][func.train][INFO] - 

[2024-07-11 13:41:48,233][func.train][INFO] - [DATASET] video_idx: 2
[2024-07-11 13:41:48,321][func.train][INFO] - [DATASET] Sampled video_idx: 2 at 25 fps to 2839 frames
[2024-07-11 13:41:48,322][func.train][INFO] - [DATASET] video 2 phase_labels: torch.Size([2839])
[2024-07-11 13:41:48,443][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([2839, 8])
[2024-07-11 13:41:48,443][func.train][INFO] - 

[2024-07-11 13:41:48,443][func.train][INFO] - [DATASET] video_idx: 3
[2024-07-11 13:41:48,546][func.train][INFO] - [DATASET] Sampled video_idx: 3 at 25 fps to 5828 frames
[2024-07-11 13:41:48,547][func.train][INFO] - [DATASET] video 3 phase_labels: torch.Size([5828])
[2024-07-11 13:41:48,679][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([5828, 8])
[2024-07-11 13:41:48,680][func.train][INFO] - 

[2024-07-11 13:41:48,680][func.train][INFO] - [DATASET] video_idx: 4
[2024-07-11 13:41:48,763][func.train][INFO] - [DATASET] Sampled video_idx: 4 at 25 fps to 1522 frames
[2024-07-11 13:41:48,763][func.train][INFO] - [DATASET] video 4 phase_labels: torch.Size([1522])
[2024-07-11 13:41:48,870][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([1522, 8])
[2024-07-11 13:41:48,870][func.train][INFO] - 

[2024-07-11 13:41:48,870][func.train][INFO] - [DATASET] video_idx: 5
[2024-07-11 13:41:48,954][func.train][INFO] - [DATASET] Sampled video_idx: 5 at 25 fps to 2344 frames
[2024-07-11 13:41:48,954][func.train][INFO] - [DATASET] video 5 phase_labels: torch.Size([2344])
[2024-07-11 13:41:49,064][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([2344, 8])
[2024-07-11 13:41:49,064][func.train][INFO] - 

[2024-07-11 13:41:49,064][func.train][INFO] - [DATASET] video_idx: 6
[2024-07-11 13:41:49,148][func.train][INFO] - [DATASET] Sampled video_idx: 6 at 25 fps to 2153 frames
[2024-07-11 13:41:49,149][func.train][INFO] - [DATASET] video 6 phase_labels: torch.Size([2153])
[2024-07-11 13:41:49,258][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([2153, 8])
[2024-07-11 13:41:49,258][func.train][INFO] - 

[2024-07-11 13:41:49,258][func.train][INFO] - [DATASET] video_idx: 7
[2024-07-11 13:41:49,349][func.train][INFO] - [DATASET] Sampled video_idx: 7 at 25 fps to 4557 frames
[2024-07-11 13:41:49,350][func.train][INFO] - [DATASET] video 7 phase_labels: torch.Size([4557])
[2024-07-11 13:41:49,457][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([4557, 8])
[2024-07-11 13:41:49,458][func.train][INFO] - 

[2024-07-11 13:41:49,458][func.train][INFO] - [DATASET] video_idx: 8
[2024-07-11 13:41:49,539][func.train][INFO] - [DATASET] Sampled video_idx: 8 at 25 fps to 1519 frames
[2024-07-11 13:41:49,540][func.train][INFO] - [DATASET] video 8 phase_labels: torch.Size([1519])
[2024-07-11 13:41:49,642][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([1519, 8])
[2024-07-11 13:41:49,643][func.train][INFO] - 

[2024-07-11 13:41:49,643][func.train][INFO] - [DATASET] video_idx: 9
[2024-07-11 13:41:49,736][func.train][INFO] - [DATASET] Sampled video_idx: 9 at 25 fps to 2702 frames
[2024-07-11 13:41:49,736][func.train][INFO] - [DATASET] video 9 phase_labels: torch.Size([2702])
[2024-07-11 13:41:49,860][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([2702, 8])
[2024-07-11 13:41:49,860][func.train][INFO] - 

[2024-07-11 13:41:49,860][func.train][INFO] - [DATASET] video_idx: 10
[2024-07-11 13:41:49,948][func.train][INFO] - [DATASET] Sampled video_idx: 10 at 25 fps to 1749 frames
[2024-07-11 13:41:49,948][func.train][INFO] - [DATASET] video 10 phase_labels: torch.Size([1749])
[2024-07-11 13:41:50,061][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([1749, 8])
[2024-07-11 13:41:50,061][func.train][INFO] - 

[2024-07-11 13:41:50,061][func.train][INFO] - [DATASET] video_idx: 11
[2024-07-11 13:41:50,154][func.train][INFO] - [DATASET] Sampled video_idx: 11 at 25 fps to 3220 frames
[2024-07-11 13:41:50,155][func.train][INFO] - [DATASET] video 11 phase_labels: torch.Size([3220])
[2024-07-11 13:41:50,273][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([3220, 8])
[2024-07-11 13:41:50,273][func.train][INFO] - 

[2024-07-11 13:41:50,273][func.train][INFO] - [DATASET] video_idx: 12
[2024-07-11 13:41:50,358][func.train][INFO] - [DATASET] Sampled video_idx: 12 at 25 fps to 1090 frames
[2024-07-11 13:41:50,359][func.train][INFO] - [DATASET] video 12 phase_labels: torch.Size([1090])
[2024-07-11 13:41:50,449][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([1090, 8])
[2024-07-11 13:41:50,450][func.train][INFO] - 

[2024-07-11 13:41:50,450][func.train][INFO] - [DATASET] video_idx: 13
[2024-07-11 13:41:50,534][func.train][INFO] - [DATASET] Sampled video_idx: 13 at 25 fps to 981 frames
[2024-07-11 13:41:50,534][func.train][INFO] - [DATASET] video 13 phase_labels: torch.Size([981])
[2024-07-11 13:41:50,610][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([981, 8])
[2024-07-11 13:41:50,610][func.train][INFO] - 

[2024-07-11 13:41:50,610][func.train][INFO] - [DATASET] video_idx: 14
[2024-07-11 13:41:50,696][func.train][INFO] - [DATASET] Sampled video_idx: 14 at 25 fps to 1708 frames
[2024-07-11 13:41:50,697][func.train][INFO] - [DATASET] video 14 phase_labels: torch.Size([1708])
[2024-07-11 13:41:50,793][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([1708, 8])
[2024-07-11 13:41:50,794][func.train][INFO] - 

[2024-07-11 13:41:50,794][func.train][INFO] - [DATASET] video_idx: 15
[2024-07-11 13:41:50,881][func.train][INFO] - [DATASET] Sampled video_idx: 15 at 25 fps to 2058 frames
[2024-07-11 13:41:50,882][func.train][INFO] - [DATASET] video 15 phase_labels: torch.Size([2058])
[2024-07-11 13:41:50,981][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([2058, 8])
[2024-07-11 13:41:50,981][func.train][INFO] - 

[2024-07-11 13:41:50,981][func.train][INFO] - [DATASET] video_idx: 16
[2024-07-11 13:41:51,071][func.train][INFO] - [DATASET] Sampled video_idx: 16 at 25 fps to 2957 frames
[2024-07-11 13:41:51,072][func.train][INFO] - [DATASET] video 16 phase_labels: torch.Size([2957])
[2024-07-11 13:41:51,190][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([2957, 8])
[2024-07-11 13:41:51,190][func.train][INFO] - 

[2024-07-11 13:41:51,190][func.train][INFO] - [DATASET] video_idx: 17
[2024-07-11 13:41:51,272][func.train][INFO] - [DATASET] Sampled video_idx: 17 at 25 fps to 1304 frames
[2024-07-11 13:41:51,273][func.train][INFO] - [DATASET] video 17 phase_labels: torch.Size([1304])
[2024-07-11 13:41:51,367][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([1304, 8])
[2024-07-11 13:41:51,367][func.train][INFO] - 

[2024-07-11 13:41:51,367][func.train][INFO] - [DATASET] video_idx: 18
[2024-07-11 13:41:51,453][func.train][INFO] - [DATASET] Sampled video_idx: 18 at 25 fps to 1942 frames
[2024-07-11 13:41:51,453][func.train][INFO] - [DATASET] video 18 phase_labels: torch.Size([1942])
[2024-07-11 13:41:51,558][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([1942, 8])
[2024-07-11 13:41:51,558][func.train][INFO] - 

[2024-07-11 13:41:51,558][func.train][INFO] - [DATASET] video_idx: 19
[2024-07-11 13:41:51,644][func.train][INFO] - [DATASET] Sampled video_idx: 19 at 25 fps to 2424 frames
[2024-07-11 13:41:51,645][func.train][INFO] - [DATASET] video 19 phase_labels: torch.Size([2424])
[2024-07-11 13:41:51,756][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([2424, 8])
[2024-07-11 13:41:51,757][func.train][INFO] - 

[2024-07-11 13:41:51,757][func.train][INFO] - [DATASET] video_idx: 20
[2024-07-11 13:41:51,841][func.train][INFO] - [DATASET] Sampled video_idx: 20 at 25 fps to 1449 frames
[2024-07-11 13:41:51,842][func.train][INFO] - [DATASET] video 20 phase_labels: torch.Size([1449])
[2024-07-11 13:41:51,937][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([1449, 8])
[2024-07-11 13:41:51,938][func.train][INFO] - 

[2024-07-11 13:41:51,938][func.train][INFO] - [DATASET] video_idx: 21
[2024-07-11 13:41:52,016][func.train][INFO] - [DATASET] Sampled video_idx: 21 at 25 fps to 1258 frames
[2024-07-11 13:41:52,016][func.train][INFO] - [DATASET] video 21 phase_labels: torch.Size([1258])
[2024-07-11 13:41:52,097][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([1258, 8])
[2024-07-11 13:41:52,098][func.train][INFO] - 

[2024-07-11 13:41:52,098][func.train][INFO] - [DATASET] video_idx: 22
[2024-07-11 13:41:52,178][func.train][INFO] - [DATASET] Sampled video_idx: 22 at 25 fps to 1532 frames
[2024-07-11 13:41:52,179][func.train][INFO] - [DATASET] video 22 phase_labels: torch.Size([1532])
[2024-07-11 13:41:52,270][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([1532, 8])
[2024-07-11 13:41:52,271][func.train][INFO] - 

[2024-07-11 13:41:52,271][func.train][INFO] - [DATASET] video_idx: 23
[2024-07-11 13:41:52,356][func.train][INFO] - [DATASET] Sampled video_idx: 23 at 25 fps to 1635 frames
[2024-07-11 13:41:52,356][func.train][INFO] - [DATASET] video 23 phase_labels: torch.Size([1635])
[2024-07-11 13:41:52,449][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([1635, 8])
[2024-07-11 13:41:52,449][func.train][INFO] - 

[2024-07-11 13:41:52,450][func.train][INFO] - [DATASET] video_idx: 24
[2024-07-11 13:41:52,529][func.train][INFO] - [DATASET] Sampled video_idx: 24 at 25 fps to 1975 frames
[2024-07-11 13:41:52,530][func.train][INFO] - [DATASET] video 24 phase_labels: torch.Size([1975])
[2024-07-11 13:41:52,635][func.train][INFO] - [DATASET] gt_remaining_time h=18: torch.Size([1975, 8])
[2024-07-11 13:41:52,635][func.train][INFO] - 

[2024-07-11 13:41:52,635][func.train][INFO] - [DATASET] video_idx: 25
[2024-07-11 13:41:52,716][func.train][INFO] - [DATASET] Sampled video_idx: 25 at 25 fps to 2129 frames
[2024-07-11 13:41:52,717][func.train][INFO] - [DATASET] video 25 phase_labels: torch.Size([2129])
