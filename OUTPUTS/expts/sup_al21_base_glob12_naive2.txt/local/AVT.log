[2024-06-12 13:14:02,070][func.train][INFO] - Dist info:
[2024-06-12 13:14:02,070][func.train][INFO] - torch version: 2.2.2+cu121
[2024-06-12 13:14:02,071][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-06-12 13:14:02,071][func.train][INFO] - hydra version: 1.3.2
[2024-06-12 13:14:02,077][func.train][INFO] - Loading data
[2024-06-12 13:14:02,077][func.train][INFO] - Loading datasets
[2024-06-12 13:14:02,416][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe in 0m 0s
[2024-06-12 13:14:02,417][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe: (83243, 4)
[2024-06-12 13:14:02,422][func.train][INFO] - [SELECT DATASET] labels are already starting from 0
[2024-06-12 13:14:02,430][func.train][INFO] - [SELECT DATASET] ALL unique classes: [0 1 2 3 4 5 6]
[2024-06-12 13:14:02,438][func.train][INFO] - [SELECT DATASET] aLL dataframe (head):                                           image_path  video_idx frame_idx class
0  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         1     1
1  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         2     1
2  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         3     1
3  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         4     1
4  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         5     1
[2024-06-12 13:14:02,445][func.train][INFO] - [SELECT DATASET] ALL dataframe (tail):                                               image_path  ...  class
83238  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83239  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83240  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83241  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83242  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6

[5 rows x 4 columns]
[2024-06-12 13:14:02,446][func.train][INFO] - [DATASET] params: {'debug': False, 'dataset_name': 'autolaparo21', 'reduc_feats_folder': 'train_targets_x_mp/', 'num_classes': 7, 'num_next_labels': 6, 'last_seg_class': 7, 'predict_next_phase': True, 'get_target_feats': False, 'replace_current_with_next_class': False}
[2024-06-12 13:14:02,484][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-12 13:14:02,485][func.train][INFO] - [DATASET] split: train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-12 13:14:02,500][func.train][INFO] - [DATASET] train size: 55183
[2024-06-12 13:14:02,500][func.train][INFO] - [DATASET] train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-12 13:14:02,503][func.train][INFO] - [DATASET] Sampling video_idx: 1 at 1 fps to 6388 frames
[2024-06-12 13:14:02,507][func.train][INFO] - [DATASET] video 1 label_list: torch.Size([6388])
[2024-06-12 13:14:02,964][func.train][INFO] - [DATASET] Sampling video_idx: 2 at 1 fps to 3620 frames
[2024-06-12 13:14:02,965][func.train][INFO] - [DATASET] video 2 label_list: torch.Size([3620])
[2024-06-12 13:14:03,018][func.train][INFO] - [DATASET] Sampling video_idx: 3 at 1 fps to 3000 frames
[2024-06-12 13:14:03,019][func.train][INFO] - [DATASET] video 3 label_list: torch.Size([3000])
[2024-06-12 13:14:03,075][func.train][INFO] - [DATASET] Sampling video_idx: 4 at 1 fps to 2938 frames
[2024-06-12 13:14:03,076][func.train][INFO] - [DATASET] video 4 label_list: torch.Size([2938])
[2024-06-12 13:14:03,137][func.train][INFO] - [DATASET] Sampling video_idx: 5 at 1 fps to 3220 frames
[2024-06-12 13:14:03,137][func.train][INFO] - [DATASET] video 5 label_list: torch.Size([3220])
[2024-06-12 13:14:03,191][func.train][INFO] - [DATASET] Sampling video_idx: 6 at 1 fps to 3908 frames
[2024-06-12 13:14:03,192][func.train][INFO] - [DATASET] video 6 label_list: torch.Size([3908])
[2024-06-12 13:14:03,243][func.train][INFO] - [DATASET] Sampling video_idx: 7 at 1 fps to 1645 frames
[2024-06-12 13:14:03,244][func.train][INFO] - [DATASET] video 7 label_list: torch.Size([1645])
[2024-06-12 13:14:03,274][func.train][INFO] - [DATASET] Sampling video_idx: 8 at 1 fps to 4692 frames
[2024-06-12 13:14:03,276][func.train][INFO] - [DATASET] video 8 label_list: torch.Size([4692])
[2024-06-12 13:14:03,340][func.train][INFO] - [DATASET] Sampling video_idx: 9 at 1 fps to 5736 frames
[2024-06-12 13:14:03,341][func.train][INFO] - [DATASET] video 9 label_list: torch.Size([5736])
[2024-06-12 13:14:03,409][func.train][INFO] - [DATASET] Sampling video_idx: 10 at 1 fps to 5064 frames
[2024-06-12 13:14:03,411][func.train][INFO] - [DATASET] video 10 label_list: torch.Size([5064])
[2024-06-12 13:14:03,482][func.train][INFO] - [DATASET] Sampling video_idx: 11 at 1 fps to 4720 frames
[2024-06-12 13:14:03,484][func.train][INFO] - [DATASET] video 11 label_list: torch.Size([4720])
[2024-06-12 13:14:03,542][func.train][INFO] - [DATASET] Sampling video_idx: 12 at 1 fps to 2916 frames
[2024-06-12 13:14:03,543][func.train][INFO] - [DATASET] video 12 label_list: torch.Size([2916])
[2024-06-12 13:14:03,586][func.train][INFO] - [DATASET] Sampling video_idx: 13 at 1 fps to 2597 frames
[2024-06-12 13:14:03,587][func.train][INFO] - [DATASET] video 13 label_list: torch.Size([2597])
[2024-06-12 13:14:03,627][func.train][INFO] - [DATASET] Sampling video_idx: 14 at 1 fps to 4739 frames
[2024-06-12 13:14:03,628][func.train][INFO] - [DATASET] video 14 label_list: torch.Size([4739])
[2024-06-12 13:14:03,684][func.train][INFO] - [DATASET] number of train videos: 14
[2024-06-12 13:14:03,684][func.train][INFO] - [DATASET] avg video length: 65.69 minutes
[2024-06-12 13:14:03,713][func.train][INFO] - [DATASET] num classes at 1fps in train: (55183,)
[2024-06-12 13:14:03,714][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915}
[2024-06-12 13:14:03,716][func.train][INFO] - [DATASET] curr_class_weights: tensor([5.5989, 0.4087, 0.6284, 1.0496, 5.9139, 0.9633, 1.6039])
[2024-06-12 13:14:03,717][func.train][INFO] - [DATASET] eos_weight: count
[2024-06-12 13:14:03,717][func.train][INFO] - [DATASET] num_eos_vals: 840
[2024-06-12 13:14:03,717][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915, 7: 840}
[2024-06-12 13:14:03,717][func.train][INFO] - [DATASET] next_class_weights: tensor([4.9736, 0.3631, 0.5582, 0.9323, 5.2535, 0.8557, 1.4248, 8.3368])
[2024-06-12 13:14:03,790][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-12 13:14:03,790][func.train][INFO] - [DATASET] split: test video_indices: [15]
[2024-06-12 13:14:03,793][func.train][INFO] - [DATASET] test size: 3653
[2024-06-12 13:14:03,793][func.train][INFO] - [DATASET] test video_indices: [15]
[2024-06-12 13:14:03,795][func.train][INFO] - [DATASET] Sampling video_idx: 15 at 1 fps to 3653 frames
[2024-06-12 13:14:03,796][func.train][INFO] - [DATASET] video 15 label_list: torch.Size([3653])
[2024-06-12 13:14:03,847][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-12 13:14:03,847][func.train][INFO] - [DATASET] avg video length: 60.88 minutes
[2024-06-12 13:14:03,886][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-12 13:14:03,886][func.train][INFO] - [DATASET] split: test video_indices: [16]
[2024-06-12 13:14:03,889][func.train][INFO] - [DATASET] test size: 3612
[2024-06-12 13:14:03,889][func.train][INFO] - [DATASET] test video_indices: [16]
[2024-06-12 13:14:03,891][func.train][INFO] - [DATASET] Sampling video_idx: 16 at 1 fps to 3612 frames
[2024-06-12 13:14:03,892][func.train][INFO] - [DATASET] video 16 label_list: torch.Size([3612])
[2024-06-12 13:14:03,939][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-12 13:14:03,939][func.train][INFO] - [DATASET] avg video length: 60.20 minutes
[2024-06-12 13:14:03,987][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-12 13:14:03,987][func.train][INFO] - [DATASET] split: test video_indices: [17]
[2024-06-12 13:14:03,990][func.train][INFO] - [DATASET] test size: 4678
[2024-06-12 13:14:03,990][func.train][INFO] - [DATASET] test video_indices: [17]
[2024-06-12 13:14:03,993][func.train][INFO] - [DATASET] Sampling video_idx: 17 at 1 fps to 4678 frames
[2024-06-12 13:14:03,993][func.train][INFO] - [DATASET] video 17 label_list: torch.Size([4678])
[2024-06-12 13:14:04,063][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-12 13:14:04,063][func.train][INFO] - [DATASET] avg video length: 77.97 minutes
[2024-06-12 13:14:04,104][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-12 13:14:04,105][func.train][INFO] - [DATASET] split: test video_indices: [18]
[2024-06-12 13:14:04,108][func.train][INFO] - [DATASET] test size: 3546
[2024-06-12 13:14:04,108][func.train][INFO] - [DATASET] test video_indices: [18]
[2024-06-12 13:14:04,115][func.train][INFO] - [DATASET] Sampling video_idx: 18 at 1 fps to 3546 frames
[2024-06-12 13:14:04,116][func.train][INFO] - [DATASET] video 18 label_list: torch.Size([3546])
[2024-06-12 13:14:04,174][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-12 13:14:04,174][func.train][INFO] - [DATASET] avg video length: 59.10 minutes
[2024-06-12 13:14:04,211][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-12 13:14:04,212][func.train][INFO] - [DATASET] split: test video_indices: [19]
[2024-06-12 13:14:04,214][func.train][INFO] - [DATASET] test size: 3413
[2024-06-12 13:14:04,214][func.train][INFO] - [DATASET] test video_indices: [19]
[2024-06-12 13:14:04,217][func.train][INFO] - [DATASET] Sampling video_idx: 19 at 1 fps to 3413 frames
[2024-06-12 13:14:04,217][func.train][INFO] - [DATASET] video 19 label_list: torch.Size([3413])
[2024-06-12 13:14:04,263][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-12 13:14:04,264][func.train][INFO] - [DATASET] avg video length: 56.88 minutes
[2024-06-12 13:14:04,302][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-12 13:14:04,302][func.train][INFO] - [DATASET] split: test video_indices: [20]
[2024-06-12 13:14:04,305][func.train][INFO] - [DATASET] test size: 4832
[2024-06-12 13:14:04,305][func.train][INFO] - [DATASET] test video_indices: [20]
[2024-06-12 13:14:04,307][func.train][INFO] - [DATASET] Sampling video_idx: 20 at 1 fps to 4832 frames
[2024-06-12 13:14:04,308][func.train][INFO] - [DATASET] video 20 label_list: torch.Size([4832])
[2024-06-12 13:14:04,366][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-12 13:14:04,366][func.train][INFO] - [DATASET] avg video length: 80.53 minutes
[2024-06-12 13:14:04,406][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-12 13:14:04,406][func.train][INFO] - [DATASET] split: test video_indices: [21]
[2024-06-12 13:14:04,409][func.train][INFO] - [DATASET] test size: 4326
[2024-06-12 13:14:04,409][func.train][INFO] - [DATASET] test video_indices: [21]
[2024-06-12 13:14:04,411][func.train][INFO] - [DATASET] Sampling video_idx: 21 at 1 fps to 4326 frames
[2024-06-12 13:14:04,412][func.train][INFO] - [DATASET] video 21 label_list: torch.Size([4326])
[2024-06-12 13:14:04,463][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-12 13:14:04,463][func.train][INFO] - [DATASET] avg video length: 72.10 minutes
[2024-06-12 13:14:04,467][func.train][INFO] - Time to load datasets: 0.04 min
[2024-06-12 13:14:04,468][func.train][INFO] - Creating data loaders
[2024-06-12 13:14:04,470][func.train][INFO] - Creating model with {'one': 7} classes
[2024-06-12 13:14:05,189][func.train][INFO] - [MAIN] Number of tokens: 55183
[2024-06-12 13:14:05,189][func.train][INFO] - [MAIN] Number of parameters: 17171926
[2024-06-12 13:14:05,190][func.train][INFO] - [MAIN] Token-to-Parameter Ratio is ideally between [1:1 to 10:1]: 0.003214
[2024-06-12 13:14:05,190][func.train][WARNING] - [MAIN] Data-to-Parameter-Ratio is outside the interval [1:1 to 10:1]
[2024-06-12 13:14:05,191][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-06-12 13:14:05,191][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-06-12 13:14:05,693][func.train][WARNING] - Loaded model from checkpoint_best.pth (ep 0.000000)
[2024-06-12 13:14:05,693][func.train][INFO] - Wrapping model into DP
[2024-06-12 13:14:05,905][func.train][INFO] - Starting test_only
[2024-06-12 13:14:05,908][func.train][INFO] - [EVAL] Epoch: 1 | Anticipation time (s): 60 | Max anticipation time (m): 18 | Step size (m): 1 | Max auto-reg. steps: 18
[2024-06-12 13:14:05,909][func.train][INFO] - [EVAL] X-axis values: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
[2024-06-12 13:14:07,447][func.train][INFO] - [TESTING] video: 15 | frame: 63 / 3653
[2024-06-12 13:14:07,769][func.train][INFO] - [TESTING] video: 15 | frame: 127 / 3653
[2024-06-12 13:14:08,092][func.train][INFO] - [TESTING] video: 15 | frame: 191 / 3653
[2024-06-12 13:14:08,401][func.train][INFO] - [TESTING] video: 15 | frame: 255 / 3653
[2024-06-12 13:14:08,709][func.train][INFO] - [TESTING] video: 15 | frame: 319 / 3653
[2024-06-12 13:14:09,018][func.train][INFO] - [TESTING] video: 15 | frame: 383 / 3653
[2024-06-12 13:14:09,328][func.train][INFO] - [TESTING] video: 15 | frame: 447 / 3653
[2024-06-12 13:14:09,650][func.train][INFO] - [TESTING] video: 15 | frame: 511 / 3653
[2024-06-12 13:14:09,958][func.train][INFO] - [TESTING] video: 15 | frame: 575 / 3653
[2024-06-12 13:14:10,293][func.train][INFO] - [TESTING] video: 15 | frame: 639 / 3653
[2024-06-12 13:14:10,599][func.train][INFO] - [TESTING] video: 15 | frame: 703 / 3653
[2024-06-12 13:14:10,908][func.train][INFO] - [TESTING] video: 15 | frame: 767 / 3653
[2024-06-12 13:14:11,215][func.train][INFO] - [TESTING] video: 15 | frame: 831 / 3653
[2024-06-12 13:14:11,519][func.train][INFO] - [TESTING] video: 15 | frame: 895 / 3653
[2024-06-12 13:14:11,821][func.train][INFO] - [TESTING] video: 15 | frame: 959 / 3653
[2024-06-12 13:14:12,128][func.train][INFO] - [TESTING] video: 15 | frame: 1023 / 3653
[2024-06-12 13:14:12,436][func.train][INFO] - [TESTING] video: 15 | frame: 1087 / 3653
[2024-06-12 13:14:12,741][func.train][INFO] - [TESTING] video: 15 | frame: 1151 / 3653
[2024-06-12 13:14:13,047][func.train][INFO] - [TESTING] video: 15 | frame: 1215 / 3653
[2024-06-12 13:14:13,352][func.train][INFO] - [TESTING] video: 15 | frame: 1279 / 3653
[2024-06-12 13:14:13,656][func.train][INFO] - [TESTING] video: 15 | frame: 1343 / 3653
[2024-06-12 13:14:13,963][func.train][INFO] - [TESTING] video: 15 | frame: 1407 / 3653
[2024-06-12 13:14:14,269][func.train][INFO] - [TESTING] video: 15 | frame: 1471 / 3653
[2024-06-12 13:14:14,583][func.train][INFO] - [TESTING] video: 15 | frame: 1535 / 3653
[2024-06-12 13:14:14,882][func.train][INFO] - [TESTING] video: 15 | frame: 1599 / 3653
[2024-06-12 13:14:15,180][func.train][INFO] - [TESTING] video: 15 | frame: 1663 / 3653
[2024-06-12 13:14:15,478][func.train][INFO] - [TESTING] video: 15 | frame: 1727 / 3653
[2024-06-12 13:14:15,778][func.train][INFO] - [TESTING] video: 15 | frame: 1791 / 3653
[2024-06-12 13:14:16,081][func.train][INFO] - [TESTING] video: 15 | frame: 1855 / 3653
[2024-06-12 13:14:16,383][func.train][INFO] - [TESTING] video: 15 | frame: 1919 / 3653
[2024-06-12 13:14:16,682][func.train][INFO] - [TESTING] video: 15 | frame: 1983 / 3653
[2024-06-12 13:14:16,985][func.train][INFO] - [TESTING] video: 15 | frame: 2047 / 3653
[2024-06-12 13:14:17,286][func.train][INFO] - [TESTING] video: 15 | frame: 2111 / 3653
[2024-06-12 13:14:17,590][func.train][INFO] - [TESTING] video: 15 | frame: 2175 / 3653
[2024-06-12 13:14:17,889][func.train][INFO] - [TESTING] video: 15 | frame: 2239 / 3653
[2024-06-12 13:14:18,187][func.train][INFO] - [TESTING] video: 15 | frame: 2303 / 3653
[2024-06-12 13:14:18,491][func.train][INFO] - [TESTING] video: 15 | frame: 2367 / 3653
[2024-06-12 13:14:18,792][func.train][INFO] - [TESTING] video: 15 | frame: 2431 / 3653
[2024-06-12 13:14:19,092][func.train][INFO] - [TESTING] video: 15 | frame: 2495 / 3653
[2024-06-12 13:14:19,395][func.train][INFO] - [TESTING] video: 15 | frame: 2559 / 3653
[2024-06-12 13:14:19,695][func.train][INFO] - [TESTING] video: 15 | frame: 2623 / 3653
[2024-06-12 13:14:19,999][func.train][INFO] - [TESTING] video: 15 | frame: 2687 / 3653
[2024-06-12 13:14:20,303][func.train][INFO] - [TESTING] video: 15 | frame: 2751 / 3653
[2024-06-12 13:14:20,610][func.train][INFO] - [TESTING] video: 15 | frame: 2815 / 3653
[2024-06-12 13:14:20,911][func.train][INFO] - [TESTING] video: 15 | frame: 2879 / 3653
[2024-06-12 13:14:21,218][func.train][INFO] - [TESTING] video: 15 | frame: 2943 / 3653
[2024-06-12 13:14:21,536][func.train][INFO] - [TESTING] video: 15 | frame: 3007 / 3653
[2024-06-12 13:14:21,836][func.train][INFO] - [TESTING] video: 15 | frame: 3071 / 3653
[2024-06-12 13:14:22,137][func.train][INFO] - [TESTING] video: 15 | frame: 3135 / 3653
[2024-06-12 13:14:22,438][func.train][INFO] - [TESTING] video: 15 | frame: 3199 / 3653
[2024-06-12 13:14:22,744][func.train][INFO] - [TESTING] video: 15 | frame: 3263 / 3653
[2024-06-12 13:14:23,045][func.train][INFO] - [TESTING] video: 15 | frame: 3327 / 3653
[2024-06-12 13:14:23,350][func.train][INFO] - [TESTING] video: 15 | frame: 3391 / 3653
[2024-06-12 13:14:23,668][func.train][INFO] - [TESTING] video: 15 | frame: 3455 / 3653
[2024-06-12 13:14:23,973][func.train][INFO] - [TESTING] video: 15 | frame: 3519 / 3653
[2024-06-12 13:14:24,271][func.train][INFO] - [TESTING] video: 15 | frame: 3583 / 3653
[2024-06-12 13:14:24,567][func.train][INFO] - [TESTING] video: 15 | frame: 3647 / 3653
[2024-06-12 13:14:24,789][func.train][INFO] - [TESTING] video: 15 | frame: 3652 / 3653
[2024-06-12 13:14:24,789][func.train][INFO] - [TESTING] video: 15 | video test time: 0.31 min | total test time: 0.31 min
[2024-06-12 13:14:24,830][func.train][INFO] - [TESTING] video: 15 | video_mean_curr_acc: 0.8538 | mean_acc_future_frames: 0.3571 | video_mean_cum_acc_future: 0.5443
[2024-06-12 13:14:25,150][func.train][INFO] - [TESTING] video: 16 | frame: 63 / 3612
[2024-06-12 13:14:25,466][func.train][INFO] - [TESTING] video: 16 | frame: 127 / 3612
[2024-06-12 13:14:25,773][func.train][INFO] - [TESTING] video: 16 | frame: 191 / 3612
[2024-06-12 13:14:26,079][func.train][INFO] - [TESTING] video: 16 | frame: 255 / 3612
[2024-06-12 13:14:26,384][func.train][INFO] - [TESTING] video: 16 | frame: 319 / 3612
[2024-06-12 13:14:26,698][func.train][INFO] - [TESTING] video: 16 | frame: 383 / 3612
[2024-06-12 13:14:27,005][func.train][INFO] - [TESTING] video: 16 | frame: 447 / 3612
[2024-06-12 13:14:27,313][func.train][INFO] - [TESTING] video: 16 | frame: 511 / 3612
[2024-06-12 13:14:27,622][func.train][INFO] - [TESTING] video: 16 | frame: 575 / 3612
[2024-06-12 13:14:27,930][func.train][INFO] - [TESTING] video: 16 | frame: 639 / 3612
[2024-06-12 13:14:28,239][func.train][INFO] - [TESTING] video: 16 | frame: 703 / 3612
[2024-06-12 13:14:28,549][func.train][INFO] - [TESTING] video: 16 | frame: 767 / 3612
[2024-06-12 13:14:28,864][func.train][INFO] - [TESTING] video: 16 | frame: 831 / 3612
[2024-06-12 13:14:29,171][func.train][INFO] - [TESTING] video: 16 | frame: 895 / 3612
[2024-06-12 13:14:29,477][func.train][INFO] - [TESTING] video: 16 | frame: 959 / 3612
[2024-06-12 13:14:29,790][func.train][INFO] - [TESTING] video: 16 | frame: 1023 / 3612
[2024-06-12 13:14:30,115][func.train][INFO] - [TESTING] video: 16 | frame: 1087 / 3612
[2024-06-12 13:14:30,422][func.train][INFO] - [TESTING] video: 16 | frame: 1151 / 3612
[2024-06-12 13:14:30,731][func.train][INFO] - [TESTING] video: 16 | frame: 1215 / 3612
[2024-06-12 13:14:31,047][func.train][INFO] - [TESTING] video: 16 | frame: 1279 / 3612
[2024-06-12 13:14:31,357][func.train][INFO] - [TESTING] video: 16 | frame: 1343 / 3612
[2024-06-12 13:14:31,666][func.train][INFO] - [TESTING] video: 16 | frame: 1407 / 3612
[2024-06-12 13:14:31,973][func.train][INFO] - [TESTING] video: 16 | frame: 1471 / 3612
[2024-06-12 13:14:32,275][func.train][INFO] - [TESTING] video: 16 | frame: 1535 / 3612
[2024-06-12 13:14:32,577][func.train][INFO] - [TESTING] video: 16 | frame: 1599 / 3612
[2024-06-12 13:14:32,880][func.train][INFO] - [TESTING] video: 16 | frame: 1663 / 3612
[2024-06-12 13:14:33,194][func.train][INFO] - [TESTING] video: 16 | frame: 1727 / 3612
[2024-06-12 13:14:33,497][func.train][INFO] - [TESTING] video: 16 | frame: 1791 / 3612
[2024-06-12 13:14:33,798][func.train][INFO] - [TESTING] video: 16 | frame: 1855 / 3612
[2024-06-12 13:14:34,101][func.train][INFO] - [TESTING] video: 16 | frame: 1919 / 3612
[2024-06-12 13:14:34,404][func.train][INFO] - [TESTING] video: 16 | frame: 1983 / 3612
[2024-06-12 13:14:34,705][func.train][INFO] - [TESTING] video: 16 | frame: 2047 / 3612
[2024-06-12 13:14:35,008][func.train][INFO] - [TESTING] video: 16 | frame: 2111 / 3612
[2024-06-12 13:14:35,319][func.train][INFO] - [TESTING] video: 16 | frame: 2175 / 3612
[2024-06-12 13:14:35,621][func.train][INFO] - [TESTING] video: 16 | frame: 2239 / 3612
[2024-06-12 13:14:35,920][func.train][INFO] - [TESTING] video: 16 | frame: 2303 / 3612
[2024-06-12 13:14:36,220][func.train][INFO] - [TESTING] video: 16 | frame: 2367 / 3612
[2024-06-12 13:14:36,523][func.train][INFO] - [TESTING] video: 16 | frame: 2431 / 3612
[2024-06-12 13:14:36,825][func.train][INFO] - [TESTING] video: 16 | frame: 2495 / 3612
[2024-06-12 13:14:37,130][func.train][INFO] - [TESTING] video: 16 | frame: 2559 / 3612
[2024-06-12 13:14:37,441][func.train][INFO] - [TESTING] video: 16 | frame: 2623 / 3612
[2024-06-12 13:14:37,749][func.train][INFO] - [TESTING] video: 16 | frame: 2687 / 3612
[2024-06-12 13:14:38,053][func.train][INFO] - [TESTING] video: 16 | frame: 2751 / 3612
[2024-06-12 13:14:38,360][func.train][INFO] - [TESTING] video: 16 | frame: 2815 / 3612
[2024-06-12 13:14:38,668][func.train][INFO] - [TESTING] video: 16 | frame: 2879 / 3612
[2024-06-12 13:14:38,972][func.train][INFO] - [TESTING] video: 16 | frame: 2943 / 3612
[2024-06-12 13:14:39,276][func.train][INFO] - [TESTING] video: 16 | frame: 3007 / 3612
[2024-06-12 13:14:39,593][func.train][INFO] - [TESTING] video: 16 | frame: 3071 / 3612
[2024-06-12 13:14:39,898][func.train][INFO] - [TESTING] video: 16 | frame: 3135 / 3612
[2024-06-12 13:14:40,202][func.train][INFO] - [TESTING] video: 16 | frame: 3199 / 3612
[2024-06-12 13:14:40,506][func.train][INFO] - [TESTING] video: 16 | frame: 3263 / 3612
[2024-06-12 13:14:40,810][func.train][INFO] - [TESTING] video: 16 | frame: 3327 / 3612
[2024-06-12 13:14:41,110][func.train][INFO] - [TESTING] video: 16 | frame: 3391 / 3612
[2024-06-12 13:14:41,412][func.train][INFO] - [TESTING] video: 16 | frame: 3455 / 3612
[2024-06-12 13:14:41,721][func.train][INFO] - [TESTING] video: 16 | frame: 3519 / 3612
[2024-06-12 13:14:42,018][func.train][INFO] - [TESTING] video: 16 | frame: 3583 / 3612
[2024-06-12 13:14:43,428][func.train][INFO] - [TESTING] video: 16 | frame: 3611 / 3612
[2024-06-12 13:14:43,428][func.train][INFO] - [TESTING] video: 16 | video test time: 0.31 min | total test time: 0.63 min
[2024-06-12 13:14:43,470][func.train][INFO] - [TESTING] video: 16 | video_mean_curr_acc: 0.8059 | mean_acc_future_frames: 0.314 | video_mean_cum_acc_future: 0.4814
[2024-06-12 13:14:43,789][func.train][INFO] - [TESTING] video: 17 | frame: 63 / 4678
[2024-06-12 13:14:44,103][func.train][INFO] - [TESTING] video: 17 | frame: 127 / 4678
[2024-06-12 13:14:44,406][func.train][INFO] - [TESTING] video: 17 | frame: 191 / 4678
[2024-06-12 13:14:44,712][func.train][INFO] - [TESTING] video: 17 | frame: 255 / 4678
[2024-06-12 13:14:45,025][func.train][INFO] - [TESTING] video: 17 | frame: 319 / 4678
[2024-06-12 13:14:45,329][func.train][INFO] - [TESTING] video: 17 | frame: 383 / 4678
[2024-06-12 13:14:45,633][func.train][INFO] - [TESTING] video: 17 | frame: 447 / 4678
[2024-06-12 13:14:45,937][func.train][INFO] - [TESTING] video: 17 | frame: 511 / 4678
[2024-06-12 13:14:46,244][func.train][INFO] - [TESTING] video: 17 | frame: 575 / 4678
[2024-06-12 13:14:46,554][func.train][INFO] - [TESTING] video: 17 | frame: 639 / 4678
[2024-06-12 13:14:46,858][func.train][INFO] - [TESTING] video: 17 | frame: 703 / 4678
[2024-06-12 13:14:47,167][func.train][INFO] - [TESTING] video: 17 | frame: 767 / 4678
[2024-06-12 13:14:47,482][func.train][INFO] - [TESTING] video: 17 | frame: 831 / 4678
[2024-06-12 13:14:47,788][func.train][INFO] - [TESTING] video: 17 | frame: 895 / 4678
[2024-06-12 13:14:48,101][func.train][INFO] - [TESTING] video: 17 | frame: 959 / 4678
[2024-06-12 13:14:48,409][func.train][INFO] - [TESTING] video: 17 | frame: 1023 / 4678
[2024-06-12 13:14:48,718][func.train][INFO] - [TESTING] video: 17 | frame: 1087 / 4678
[2024-06-12 13:14:49,024][func.train][INFO] - [TESTING] video: 17 | frame: 1151 / 4678
[2024-06-12 13:14:49,330][func.train][INFO] - [TESTING] video: 17 | frame: 1215 / 4678
[2024-06-12 13:14:49,639][func.train][INFO] - [TESTING] video: 17 | frame: 1279 / 4678
[2024-06-12 13:14:49,946][func.train][INFO] - [TESTING] video: 17 | frame: 1343 / 4678
[2024-06-12 13:14:50,255][func.train][INFO] - [TESTING] video: 17 | frame: 1407 / 4678
[2024-06-12 13:14:50,561][func.train][INFO] - [TESTING] video: 17 | frame: 1471 / 4678
[2024-06-12 13:14:50,863][func.train][INFO] - [TESTING] video: 17 | frame: 1535 / 4678
[2024-06-12 13:14:51,186][func.train][INFO] - [TESTING] video: 17 | frame: 1599 / 4678
[2024-06-12 13:14:51,499][func.train][INFO] - [TESTING] video: 17 | frame: 1663 / 4678
[2024-06-12 13:14:51,809][func.train][INFO] - [TESTING] video: 17 | frame: 1727 / 4678
[2024-06-12 13:14:52,122][func.train][INFO] - [TESTING] video: 17 | frame: 1791 / 4678
[2024-06-12 13:14:52,426][func.train][INFO] - [TESTING] video: 17 | frame: 1855 / 4678
[2024-06-12 13:14:52,728][func.train][INFO] - [TESTING] video: 17 | frame: 1919 / 4678
[2024-06-12 13:14:53,030][func.train][INFO] - [TESTING] video: 17 | frame: 1983 / 4678
[2024-06-12 13:14:53,335][func.train][INFO] - [TESTING] video: 17 | frame: 2047 / 4678
[2024-06-12 13:14:53,641][func.train][INFO] - [TESTING] video: 17 | frame: 2111 / 4678
[2024-06-12 13:14:53,948][func.train][INFO] - [TESTING] video: 17 | frame: 2175 / 4678
[2024-06-12 13:14:54,260][func.train][INFO] - [TESTING] video: 17 | frame: 2239 / 4678
[2024-06-12 13:14:54,578][func.train][INFO] - [TESTING] video: 17 | frame: 2303 / 4678
[2024-06-12 13:14:54,884][func.train][INFO] - [TESTING] video: 17 | frame: 2367 / 4678
[2024-06-12 13:14:55,184][func.train][INFO] - [TESTING] video: 17 | frame: 2431 / 4678
[2024-06-12 13:14:55,492][func.train][INFO] - [TESTING] video: 17 | frame: 2495 / 4678
[2024-06-12 13:14:55,817][func.train][INFO] - [TESTING] video: 17 | frame: 2559 / 4678
[2024-06-12 13:14:56,125][func.train][INFO] - [TESTING] video: 17 | frame: 2623 / 4678
[2024-06-12 13:14:56,431][func.train][INFO] - [TESTING] video: 17 | frame: 2687 / 4678
[2024-06-12 13:14:56,738][func.train][INFO] - [TESTING] video: 17 | frame: 2751 / 4678
[2024-06-12 13:14:57,044][func.train][INFO] - [TESTING] video: 17 | frame: 2815 / 4678
[2024-06-12 13:14:57,350][func.train][INFO] - [TESTING] video: 17 | frame: 2879 / 4678
[2024-06-12 13:14:57,668][func.train][INFO] - [TESTING] video: 17 | frame: 2943 / 4678
[2024-06-12 13:14:57,999][func.train][INFO] - [TESTING] video: 17 | frame: 3007 / 4678
[2024-06-12 13:14:58,303][func.train][INFO] - [TESTING] video: 17 | frame: 3071 / 4678
[2024-06-12 13:14:58,606][func.train][INFO] - [TESTING] video: 17 | frame: 3135 / 4678
[2024-06-12 13:14:58,909][func.train][INFO] - [TESTING] video: 17 | frame: 3199 / 4678
[2024-06-12 13:14:59,211][func.train][INFO] - [TESTING] video: 17 | frame: 3263 / 4678
[2024-06-12 13:14:59,511][func.train][INFO] - [TESTING] video: 17 | frame: 3327 / 4678
[2024-06-12 13:14:59,818][func.train][INFO] - [TESTING] video: 17 | frame: 3391 / 4678
[2024-06-12 13:15:00,127][func.train][INFO] - [TESTING] video: 17 | frame: 3455 / 4678
[2024-06-12 13:15:00,430][func.train][INFO] - [TESTING] video: 17 | frame: 3519 / 4678
[2024-06-12 13:15:00,733][func.train][INFO] - [TESTING] video: 17 | frame: 3583 / 4678
[2024-06-12 13:15:01,043][func.train][INFO] - [TESTING] video: 17 | frame: 3647 / 4678
[2024-06-12 13:15:01,358][func.train][INFO] - [TESTING] video: 17 | frame: 3711 / 4678
[2024-06-12 13:15:01,663][func.train][INFO] - [TESTING] video: 17 | frame: 3775 / 4678
[2024-06-12 13:15:01,970][func.train][INFO] - [TESTING] video: 17 | frame: 3839 / 4678
[2024-06-12 13:15:02,282][func.train][INFO] - [TESTING] video: 17 | frame: 3903 / 4678
[2024-06-12 13:15:02,585][func.train][INFO] - [TESTING] video: 17 | frame: 3967 / 4678
[2024-06-12 13:15:02,891][func.train][INFO] - [TESTING] video: 17 | frame: 4031 / 4678
[2024-06-12 13:15:03,200][func.train][INFO] - [TESTING] video: 17 | frame: 4095 / 4678
[2024-06-12 13:15:03,505][func.train][INFO] - [TESTING] video: 17 | frame: 4159 / 4678
[2024-06-12 13:15:03,809][func.train][INFO] - [TESTING] video: 17 | frame: 4223 / 4678
[2024-06-12 13:15:04,114][func.train][INFO] - [TESTING] video: 17 | frame: 4287 / 4678
[2024-06-12 13:15:04,424][func.train][INFO] - [TESTING] video: 17 | frame: 4351 / 4678
[2024-06-12 13:15:04,726][func.train][INFO] - [TESTING] video: 17 | frame: 4415 / 4678
[2024-06-12 13:15:05,031][func.train][INFO] - [TESTING] video: 17 | frame: 4479 / 4678
[2024-06-12 13:15:05,341][func.train][INFO] - [TESTING] video: 17 | frame: 4543 / 4678
[2024-06-12 13:15:05,642][func.train][INFO] - [TESTING] video: 17 | frame: 4607 / 4678
[2024-06-12 13:15:05,935][func.train][INFO] - [TESTING] video: 17 | frame: 4671 / 4678
[2024-06-12 13:15:06,167][func.train][INFO] - [TESTING] video: 17 | frame: 4677 / 4678
[2024-06-12 13:15:06,167][func.train][INFO] - [TESTING] video: 17 | video test time: 0.38 min | total test time: 1.00 min
[2024-06-12 13:15:06,222][func.train][INFO] - [TESTING] video: 17 | video_mean_curr_acc: 0.8784 | mean_acc_future_frames: 0.3946 | video_mean_cum_acc_future: 0.5831
[2024-06-12 13:15:06,559][func.train][INFO] - [TESTING] video: 18 | frame: 63 / 3546
[2024-06-12 13:15:06,877][func.train][INFO] - [TESTING] video: 18 | frame: 127 / 3546
[2024-06-12 13:15:07,187][func.train][INFO] - [TESTING] video: 18 | frame: 191 / 3546
[2024-06-12 13:15:07,497][func.train][INFO] - [TESTING] video: 18 | frame: 255 / 3546
[2024-06-12 13:15:07,803][func.train][INFO] - [TESTING] video: 18 | frame: 319 / 3546
[2024-06-12 13:15:08,112][func.train][INFO] - [TESTING] video: 18 | frame: 383 / 3546
[2024-06-12 13:15:08,423][func.train][INFO] - [TESTING] video: 18 | frame: 447 / 3546
[2024-06-12 13:15:08,731][func.train][INFO] - [TESTING] video: 18 | frame: 511 / 3546
[2024-06-12 13:15:09,040][func.train][INFO] - [TESTING] video: 18 | frame: 575 / 3546
[2024-06-12 13:15:09,355][func.train][INFO] - [TESTING] video: 18 | frame: 639 / 3546
[2024-06-12 13:15:09,669][func.train][INFO] - [TESTING] video: 18 | frame: 703 / 3546
[2024-06-12 13:15:09,974][func.train][INFO] - [TESTING] video: 18 | frame: 767 / 3546
[2024-06-12 13:15:10,293][func.train][INFO] - [TESTING] video: 18 | frame: 831 / 3546
[2024-06-12 13:15:10,599][func.train][INFO] - [TESTING] video: 18 | frame: 895 / 3546
[2024-06-12 13:15:10,905][func.train][INFO] - [TESTING] video: 18 | frame: 959 / 3546
[2024-06-12 13:15:11,210][func.train][INFO] - [TESTING] video: 18 | frame: 1023 / 3546
[2024-06-12 13:15:11,522][func.train][INFO] - [TESTING] video: 18 | frame: 1087 / 3546
[2024-06-12 13:15:11,828][func.train][INFO] - [TESTING] video: 18 | frame: 1151 / 3546
[2024-06-12 13:15:12,132][func.train][INFO] - [TESTING] video: 18 | frame: 1215 / 3546
[2024-06-12 13:15:12,443][func.train][INFO] - [TESTING] video: 18 | frame: 1279 / 3546
[2024-06-12 13:15:12,763][func.train][INFO] - [TESTING] video: 18 | frame: 1343 / 3546
[2024-06-12 13:15:13,074][func.train][INFO] - [TESTING] video: 18 | frame: 1407 / 3546
[2024-06-12 13:15:13,381][func.train][INFO] - [TESTING] video: 18 | frame: 1471 / 3546
[2024-06-12 13:15:13,681][func.train][INFO] - [TESTING] video: 18 | frame: 1535 / 3546
[2024-06-12 13:15:13,983][func.train][INFO] - [TESTING] video: 18 | frame: 1599 / 3546
[2024-06-12 13:15:14,284][func.train][INFO] - [TESTING] video: 18 | frame: 1663 / 3546
[2024-06-12 13:15:14,589][func.train][INFO] - [TESTING] video: 18 | frame: 1727 / 3546
[2024-06-12 13:15:14,888][func.train][INFO] - [TESTING] video: 18 | frame: 1791 / 3546
[2024-06-12 13:15:15,191][func.train][INFO] - [TESTING] video: 18 | frame: 1855 / 3546
[2024-06-12 13:15:15,497][func.train][INFO] - [TESTING] video: 18 | frame: 1919 / 3546
[2024-06-12 13:15:15,800][func.train][INFO] - [TESTING] video: 18 | frame: 1983 / 3546
[2024-06-12 13:15:16,101][func.train][INFO] - [TESTING] video: 18 | frame: 2047 / 3546
[2024-06-12 13:15:16,403][func.train][INFO] - [TESTING] video: 18 | frame: 2111 / 3546
[2024-06-12 13:15:16,706][func.train][INFO] - [TESTING] video: 18 | frame: 2175 / 3546
[2024-06-12 13:15:17,010][func.train][INFO] - [TESTING] video: 18 | frame: 2239 / 3546
[2024-06-12 13:15:17,314][func.train][INFO] - [TESTING] video: 18 | frame: 2303 / 3546
[2024-06-12 13:15:17,619][func.train][INFO] - [TESTING] video: 18 | frame: 2367 / 3546
[2024-06-12 13:15:17,921][func.train][INFO] - [TESTING] video: 18 | frame: 2431 / 3546
[2024-06-12 13:15:18,227][func.train][INFO] - [TESTING] video: 18 | frame: 2495 / 3546
[2024-06-12 13:15:18,537][func.train][INFO] - [TESTING] video: 18 | frame: 2559 / 3546
[2024-06-12 13:15:18,848][func.train][INFO] - [TESTING] video: 18 | frame: 2623 / 3546
[2024-06-12 13:15:19,157][func.train][INFO] - [TESTING] video: 18 | frame: 2687 / 3546
[2024-06-12 13:15:19,463][func.train][INFO] - [TESTING] video: 18 | frame: 2751 / 3546
[2024-06-12 13:15:19,776][func.train][INFO] - [TESTING] video: 18 | frame: 2815 / 3546
[2024-06-12 13:15:20,096][func.train][INFO] - [TESTING] video: 18 | frame: 2879 / 3546
[2024-06-12 13:15:20,409][func.train][INFO] - [TESTING] video: 18 | frame: 2943 / 3546
[2024-06-12 13:15:20,724][func.train][INFO] - [TESTING] video: 18 | frame: 3007 / 3546
[2024-06-12 13:15:21,035][func.train][INFO] - [TESTING] video: 18 | frame: 3071 / 3546
[2024-06-12 13:15:21,344][func.train][INFO] - [TESTING] video: 18 | frame: 3135 / 3546
[2024-06-12 13:15:21,649][func.train][INFO] - [TESTING] video: 18 | frame: 3199 / 3546
[2024-06-12 13:15:21,957][func.train][INFO] - [TESTING] video: 18 | frame: 3263 / 3546
[2024-06-12 13:15:22,257][func.train][INFO] - [TESTING] video: 18 | frame: 3327 / 3546
[2024-06-12 13:15:22,561][func.train][INFO] - [TESTING] video: 18 | frame: 3391 / 3546
[2024-06-12 13:15:22,864][func.train][INFO] - [TESTING] video: 18 | frame: 3455 / 3546
[2024-06-12 13:15:23,162][func.train][INFO] - [TESTING] video: 18 | frame: 3519 / 3546
[2024-06-12 13:15:24,731][func.train][INFO] - [TESTING] video: 18 | frame: 3545 / 3546
[2024-06-12 13:15:24,732][func.train][INFO] - [TESTING] video: 18 | video test time: 0.31 min | total test time: 1.31 min
[2024-06-12 13:15:24,775][func.train][INFO] - [TESTING] video: 18 | video_mean_curr_acc: 0.8311 | mean_acc_future_frames: 0.3269 | video_mean_cum_acc_future: 0.5118
[2024-06-12 13:15:25,116][func.train][INFO] - [TESTING] video: 19 | frame: 63 / 3413
[2024-06-12 13:15:25,426][func.train][INFO] - [TESTING] video: 19 | frame: 127 / 3413
[2024-06-12 13:15:25,734][func.train][INFO] - [TESTING] video: 19 | frame: 191 / 3413
[2024-06-12 13:15:26,043][func.train][INFO] - [TESTING] video: 19 | frame: 255 / 3413
[2024-06-12 13:15:26,355][func.train][INFO] - [TESTING] video: 19 | frame: 319 / 3413
[2024-06-12 13:15:26,664][func.train][INFO] - [TESTING] video: 19 | frame: 383 / 3413
[2024-06-12 13:15:26,968][func.train][INFO] - [TESTING] video: 19 | frame: 447 / 3413
[2024-06-12 13:15:27,276][func.train][INFO] - [TESTING] video: 19 | frame: 511 / 3413
[2024-06-12 13:15:27,585][func.train][INFO] - [TESTING] video: 19 | frame: 575 / 3413
[2024-06-12 13:15:27,898][func.train][INFO] - [TESTING] video: 19 | frame: 639 / 3413
[2024-06-12 13:15:28,205][func.train][INFO] - [TESTING] video: 19 | frame: 703 / 3413
[2024-06-12 13:15:28,514][func.train][INFO] - [TESTING] video: 19 | frame: 767 / 3413
[2024-06-12 13:15:28,825][func.train][INFO] - [TESTING] video: 19 | frame: 831 / 3413
[2024-06-12 13:15:29,133][func.train][INFO] - [TESTING] video: 19 | frame: 895 / 3413
[2024-06-12 13:15:29,440][func.train][INFO] - [TESTING] video: 19 | frame: 959 / 3413
[2024-06-12 13:15:29,756][func.train][INFO] - [TESTING] video: 19 | frame: 1023 / 3413
[2024-06-12 13:15:30,066][func.train][INFO] - [TESTING] video: 19 | frame: 1087 / 3413
[2024-06-12 13:15:30,376][func.train][INFO] - [TESTING] video: 19 | frame: 1151 / 3413
[2024-06-12 13:15:30,683][func.train][INFO] - [TESTING] video: 19 | frame: 1215 / 3413
[2024-06-12 13:15:30,989][func.train][INFO] - [TESTING] video: 19 | frame: 1279 / 3413
[2024-06-12 13:15:31,303][func.train][INFO] - [TESTING] video: 19 | frame: 1343 / 3413
[2024-06-12 13:15:31,611][func.train][INFO] - [TESTING] video: 19 | frame: 1407 / 3413
[2024-06-12 13:15:31,916][func.train][INFO] - [TESTING] video: 19 | frame: 1471 / 3413
[2024-06-12 13:15:32,217][func.train][INFO] - [TESTING] video: 19 | frame: 1535 / 3413
[2024-06-12 13:15:32,522][func.train][INFO] - [TESTING] video: 19 | frame: 1599 / 3413
[2024-06-12 13:15:32,827][func.train][INFO] - [TESTING] video: 19 | frame: 1663 / 3413
[2024-06-12 13:15:33,131][func.train][INFO] - [TESTING] video: 19 | frame: 1727 / 3413
[2024-06-12 13:15:33,435][func.train][INFO] - [TESTING] video: 19 | frame: 1791 / 3413
[2024-06-12 13:15:33,741][func.train][INFO] - [TESTING] video: 19 | frame: 1855 / 3413
[2024-06-12 13:15:34,045][func.train][INFO] - [TESTING] video: 19 | frame: 1919 / 3413
[2024-06-12 13:15:34,347][func.train][INFO] - [TESTING] video: 19 | frame: 1983 / 3413
[2024-06-12 13:15:34,651][func.train][INFO] - [TESTING] video: 19 | frame: 2047 / 3413
[2024-06-12 13:15:34,954][func.train][INFO] - [TESTING] video: 19 | frame: 2111 / 3413
[2024-06-12 13:15:35,257][func.train][INFO] - [TESTING] video: 19 | frame: 2175 / 3413
[2024-06-12 13:15:35,565][func.train][INFO] - [TESTING] video: 19 | frame: 2239 / 3413
[2024-06-12 13:15:35,868][func.train][INFO] - [TESTING] video: 19 | frame: 2303 / 3413
[2024-06-12 13:15:36,171][func.train][INFO] - [TESTING] video: 19 | frame: 2367 / 3413
[2024-06-12 13:15:36,479][func.train][INFO] - [TESTING] video: 19 | frame: 2431 / 3413
[2024-06-12 13:15:36,788][func.train][INFO] - [TESTING] video: 19 | frame: 2495 / 3413
[2024-06-12 13:15:37,096][func.train][INFO] - [TESTING] video: 19 | frame: 2559 / 3413
[2024-06-12 13:15:37,403][func.train][INFO] - [TESTING] video: 19 | frame: 2623 / 3413
[2024-06-12 13:15:37,707][func.train][INFO] - [TESTING] video: 19 | frame: 2687 / 3413
[2024-06-12 13:15:38,010][func.train][INFO] - [TESTING] video: 19 | frame: 2751 / 3413
[2024-06-12 13:15:38,316][func.train][INFO] - [TESTING] video: 19 | frame: 2815 / 3413
[2024-06-12 13:15:38,619][func.train][INFO] - [TESTING] video: 19 | frame: 2879 / 3413
[2024-06-12 13:15:38,921][func.train][INFO] - [TESTING] video: 19 | frame: 2943 / 3413
[2024-06-12 13:15:39,224][func.train][INFO] - [TESTING] video: 19 | frame: 3007 / 3413
[2024-06-12 13:15:39,528][func.train][INFO] - [TESTING] video: 19 | frame: 3071 / 3413
[2024-06-12 13:15:39,831][func.train][INFO] - [TESTING] video: 19 | frame: 3135 / 3413
[2024-06-12 13:15:40,134][func.train][INFO] - [TESTING] video: 19 | frame: 3199 / 3413
[2024-06-12 13:15:40,437][func.train][INFO] - [TESTING] video: 19 | frame: 3263 / 3413
[2024-06-12 13:15:40,743][func.train][INFO] - [TESTING] video: 19 | frame: 3327 / 3413
[2024-06-12 13:15:41,055][func.train][INFO] - [TESTING] video: 19 | frame: 3391 / 3413
[2024-06-12 13:15:42,229][func.train][INFO] - [TESTING] video: 19 | frame: 3412 / 3413
[2024-06-12 13:15:42,230][func.train][INFO] - [TESTING] video: 19 | video test time: 0.29 min | total test time: 1.61 min
[2024-06-12 13:15:42,270][func.train][INFO] - [TESTING] video: 19 | video_mean_curr_acc: 0.7132 | mean_acc_future_frames: 0.3399 | video_mean_cum_acc_future: 0.5056
[2024-06-12 13:15:42,608][func.train][INFO] - [TESTING] video: 20 | frame: 63 / 4832
[2024-06-12 13:15:42,924][func.train][INFO] - [TESTING] video: 20 | frame: 127 / 4832
[2024-06-12 13:15:43,238][func.train][INFO] - [TESTING] video: 20 | frame: 191 / 4832
[2024-06-12 13:15:43,550][func.train][INFO] - [TESTING] video: 20 | frame: 255 / 4832
[2024-06-12 13:15:43,859][func.train][INFO] - [TESTING] video: 20 | frame: 319 / 4832
[2024-06-12 13:15:44,165][func.train][INFO] - [TESTING] video: 20 | frame: 383 / 4832
[2024-06-12 13:15:44,478][func.train][INFO] - [TESTING] video: 20 | frame: 447 / 4832
[2024-06-12 13:15:44,783][func.train][INFO] - [TESTING] video: 20 | frame: 511 / 4832
[2024-06-12 13:15:45,090][func.train][INFO] - [TESTING] video: 20 | frame: 575 / 4832
[2024-06-12 13:15:45,400][func.train][INFO] - [TESTING] video: 20 | frame: 639 / 4832
[2024-06-12 13:15:45,734][func.train][INFO] - [TESTING] video: 20 | frame: 703 / 4832
[2024-06-12 13:15:46,040][func.train][INFO] - [TESTING] video: 20 | frame: 767 / 4832
[2024-06-12 13:15:46,349][func.train][INFO] - [TESTING] video: 20 | frame: 831 / 4832
[2024-06-12 13:15:46,687][func.train][INFO] - [TESTING] video: 20 | frame: 895 / 4832
[2024-06-12 13:15:46,995][func.train][INFO] - [TESTING] video: 20 | frame: 959 / 4832
[2024-06-12 13:15:47,307][func.train][INFO] - [TESTING] video: 20 | frame: 1023 / 4832
[2024-06-12 13:15:47,624][func.train][INFO] - [TESTING] video: 20 | frame: 1087 / 4832
[2024-06-12 13:15:47,961][func.train][INFO] - [TESTING] video: 20 | frame: 1151 / 4832
[2024-06-12 13:15:48,271][func.train][INFO] - [TESTING] video: 20 | frame: 1215 / 4832
[2024-06-12 13:15:48,580][func.train][INFO] - [TESTING] video: 20 | frame: 1279 / 4832
[2024-06-12 13:15:48,898][func.train][INFO] - [TESTING] video: 20 | frame: 1343 / 4832
[2024-06-12 13:15:49,212][func.train][INFO] - [TESTING] video: 20 | frame: 1407 / 4832
[2024-06-12 13:15:49,514][func.train][INFO] - [TESTING] video: 20 | frame: 1471 / 4832
[2024-06-12 13:15:49,815][func.train][INFO] - [TESTING] video: 20 | frame: 1535 / 4832
[2024-06-12 13:15:50,122][func.train][INFO] - [TESTING] video: 20 | frame: 1599 / 4832
[2024-06-12 13:15:50,425][func.train][INFO] - [TESTING] video: 20 | frame: 1663 / 4832
[2024-06-12 13:15:50,729][func.train][INFO] - [TESTING] video: 20 | frame: 1727 / 4832
[2024-06-12 13:15:51,030][func.train][INFO] - [TESTING] video: 20 | frame: 1791 / 4832
[2024-06-12 13:15:51,335][func.train][INFO] - [TESTING] video: 20 | frame: 1855 / 4832
[2024-06-12 13:15:51,639][func.train][INFO] - [TESTING] video: 20 | frame: 1919 / 4832
[2024-06-12 13:15:51,942][func.train][INFO] - [TESTING] video: 20 | frame: 1983 / 4832
[2024-06-12 13:15:52,249][func.train][INFO] - [TESTING] video: 20 | frame: 2047 / 4832
[2024-06-12 13:15:52,552][func.train][INFO] - [TESTING] video: 20 | frame: 2111 / 4832
[2024-06-12 13:15:52,854][func.train][INFO] - [TESTING] video: 20 | frame: 2175 / 4832
[2024-06-12 13:15:53,161][func.train][INFO] - [TESTING] video: 20 | frame: 2239 / 4832
[2024-06-12 13:15:53,472][func.train][INFO] - [TESTING] video: 20 | frame: 2303 / 4832
[2024-06-12 13:15:53,787][func.train][INFO] - [TESTING] video: 20 | frame: 2367 / 4832
[2024-06-12 13:15:54,094][func.train][INFO] - [TESTING] video: 20 | frame: 2431 / 4832
[2024-06-12 13:15:54,393][func.train][INFO] - [TESTING] video: 20 | frame: 2495 / 4832
[2024-06-12 13:15:54,693][func.train][INFO] - [TESTING] video: 20 | frame: 2559 / 4832
[2024-06-12 13:15:54,999][func.train][INFO] - [TESTING] video: 20 | frame: 2623 / 4832
[2024-06-12 13:15:55,302][func.train][INFO] - [TESTING] video: 20 | frame: 2687 / 4832
[2024-06-12 13:15:55,607][func.train][INFO] - [TESTING] video: 20 | frame: 2751 / 4832
[2024-06-12 13:15:55,911][func.train][INFO] - [TESTING] video: 20 | frame: 2815 / 4832
[2024-06-12 13:15:56,213][func.train][INFO] - [TESTING] video: 20 | frame: 2879 / 4832
[2024-06-12 13:15:56,520][func.train][INFO] - [TESTING] video: 20 | frame: 2943 / 4832
[2024-06-12 13:15:56,821][func.train][INFO] - [TESTING] video: 20 | frame: 3007 / 4832
[2024-06-12 13:15:57,123][func.train][INFO] - [TESTING] video: 20 | frame: 3071 / 4832
[2024-06-12 13:15:57,431][func.train][INFO] - [TESTING] video: 20 | frame: 3135 / 4832
[2024-06-12 13:15:57,732][func.train][INFO] - [TESTING] video: 20 | frame: 3199 / 4832
[2024-06-12 13:15:58,034][func.train][INFO] - [TESTING] video: 20 | frame: 3263 / 4832
[2024-06-12 13:15:58,337][func.train][INFO] - [TESTING] video: 20 | frame: 3327 / 4832
[2024-06-12 13:15:58,647][func.train][INFO] - [TESTING] video: 20 | frame: 3391 / 4832
[2024-06-12 13:15:58,950][func.train][INFO] - [TESTING] video: 20 | frame: 3455 / 4832
[2024-06-12 13:15:59,252][func.train][INFO] - [TESTING] video: 20 | frame: 3519 / 4832
[2024-06-12 13:15:59,559][func.train][INFO] - [TESTING] video: 20 | frame: 3583 / 4832
[2024-06-12 13:15:59,865][func.train][INFO] - [TESTING] video: 20 | frame: 3647 / 4832
[2024-06-12 13:16:00,173][func.train][INFO] - [TESTING] video: 20 | frame: 3711 / 4832
[2024-06-12 13:16:00,480][func.train][INFO] - [TESTING] video: 20 | frame: 3775 / 4832
[2024-06-12 13:16:00,792][func.train][INFO] - [TESTING] video: 20 | frame: 3839 / 4832
[2024-06-12 13:16:01,099][func.train][INFO] - [TESTING] video: 20 | frame: 3903 / 4832
[2024-06-12 13:16:01,411][func.train][INFO] - [TESTING] video: 20 | frame: 3967 / 4832
[2024-06-12 13:16:01,742][func.train][INFO] - [TESTING] video: 20 | frame: 4031 / 4832
[2024-06-12 13:16:02,052][func.train][INFO] - [TESTING] video: 20 | frame: 4095 / 4832
[2024-06-12 13:16:02,356][func.train][INFO] - [TESTING] video: 20 | frame: 4159 / 4832
[2024-06-12 13:16:02,662][func.train][INFO] - [TESTING] video: 20 | frame: 4223 / 4832
[2024-06-12 13:16:02,963][func.train][INFO] - [TESTING] video: 20 | frame: 4287 / 4832
[2024-06-12 13:16:03,266][func.train][INFO] - [TESTING] video: 20 | frame: 4351 / 4832
[2024-06-12 13:16:03,573][func.train][INFO] - [TESTING] video: 20 | frame: 4415 / 4832
[2024-06-12 13:16:03,877][func.train][INFO] - [TESTING] video: 20 | frame: 4479 / 4832
[2024-06-12 13:16:04,180][func.train][INFO] - [TESTING] video: 20 | frame: 4543 / 4832
[2024-06-12 13:16:04,481][func.train][INFO] - [TESTING] video: 20 | frame: 4607 / 4832
[2024-06-12 13:16:04,782][func.train][INFO] - [TESTING] video: 20 | frame: 4671 / 4832
[2024-06-12 13:16:05,086][func.train][INFO] - [TESTING] video: 20 | frame: 4735 / 4832
[2024-06-12 13:16:05,385][func.train][INFO] - [TESTING] video: 20 | frame: 4799 / 4832
[2024-06-12 13:16:07,003][func.train][INFO] - [TESTING] video: 20 | frame: 4831 / 4832
[2024-06-12 13:16:07,004][func.train][INFO] - [TESTING] video: 20 | video test time: 0.41 min | total test time: 2.02 min
[2024-06-12 13:16:07,057][func.train][INFO] - [TESTING] video: 20 | video_mean_curr_acc: 0.8218 | mean_acc_future_frames: 0.4177 | video_mean_cum_acc_future: 0.5786
[2024-06-12 13:16:07,384][func.train][INFO] - [TESTING] video: 21 | frame: 63 / 4326
[2024-06-12 13:16:07,693][func.train][INFO] - [TESTING] video: 21 | frame: 127 / 4326
[2024-06-12 13:16:07,998][func.train][INFO] - [TESTING] video: 21 | frame: 191 / 4326
[2024-06-12 13:16:08,304][func.train][INFO] - [TESTING] video: 21 | frame: 255 / 4326
[2024-06-12 13:16:08,607][func.train][INFO] - [TESTING] video: 21 | frame: 319 / 4326
[2024-06-12 13:16:08,914][func.train][INFO] - [TESTING] video: 21 | frame: 383 / 4326
[2024-06-12 13:16:09,227][func.train][INFO] - [TESTING] video: 21 | frame: 447 / 4326
[2024-06-12 13:16:09,547][func.train][INFO] - [TESTING] video: 21 | frame: 511 / 4326
[2024-06-12 13:16:09,851][func.train][INFO] - [TESTING] video: 21 | frame: 575 / 4326
[2024-06-12 13:16:10,157][func.train][INFO] - [TESTING] video: 21 | frame: 639 / 4326
[2024-06-12 13:16:10,468][func.train][INFO] - [TESTING] video: 21 | frame: 703 / 4326
[2024-06-12 13:16:10,800][func.train][INFO] - [TESTING] video: 21 | frame: 767 / 4326
[2024-06-12 13:16:11,110][func.train][INFO] - [TESTING] video: 21 | frame: 831 / 4326
[2024-06-12 13:16:11,419][func.train][INFO] - [TESTING] video: 21 | frame: 895 / 4326
[2024-06-12 13:16:11,723][func.train][INFO] - [TESTING] video: 21 | frame: 959 / 4326
[2024-06-12 13:16:12,027][func.train][INFO] - [TESTING] video: 21 | frame: 1023 / 4326
[2024-06-12 13:16:12,336][func.train][INFO] - [TESTING] video: 21 | frame: 1087 / 4326
[2024-06-12 13:16:12,647][func.train][INFO] - [TESTING] video: 21 | frame: 1151 / 4326
[2024-06-12 13:16:12,953][func.train][INFO] - [TESTING] video: 21 | frame: 1215 / 4326
[2024-06-12 13:16:13,261][func.train][INFO] - [TESTING] video: 21 | frame: 1279 / 4326
[2024-06-12 13:16:13,567][func.train][INFO] - [TESTING] video: 21 | frame: 1343 / 4326
[2024-06-12 13:16:13,871][func.train][INFO] - [TESTING] video: 21 | frame: 1407 / 4326
[2024-06-12 13:16:14,175][func.train][INFO] - [TESTING] video: 21 | frame: 1471 / 4326
[2024-06-12 13:16:14,477][func.train][INFO] - [TESTING] video: 21 | frame: 1535 / 4326
[2024-06-12 13:16:14,776][func.train][INFO] - [TESTING] video: 21 | frame: 1599 / 4326
[2024-06-12 13:16:15,075][func.train][INFO] - [TESTING] video: 21 | frame: 1663 / 4326
[2024-06-12 13:16:15,377][func.train][INFO] - [TESTING] video: 21 | frame: 1727 / 4326
[2024-06-12 13:16:15,678][func.train][INFO] - [TESTING] video: 21 | frame: 1791 / 4326
[2024-06-12 13:16:15,980][func.train][INFO] - [TESTING] video: 21 | frame: 1855 / 4326
[2024-06-12 13:16:16,283][func.train][INFO] - [TESTING] video: 21 | frame: 1919 / 4326
[2024-06-12 13:16:16,587][func.train][INFO] - [TESTING] video: 21 | frame: 1983 / 4326
[2024-06-12 13:16:16,885][func.train][INFO] - [TESTING] video: 21 | frame: 2047 / 4326
[2024-06-12 13:16:17,184][func.train][INFO] - [TESTING] video: 21 | frame: 2111 / 4326
[2024-06-12 13:16:17,487][func.train][INFO] - [TESTING] video: 21 | frame: 2175 / 4326
[2024-06-12 13:16:17,810][func.train][INFO] - [TESTING] video: 21 | frame: 2239 / 4326
[2024-06-12 13:16:18,136][func.train][INFO] - [TESTING] video: 21 | frame: 2303 / 4326
[2024-06-12 13:16:18,463][func.train][INFO] - [TESTING] video: 21 | frame: 2367 / 4326
[2024-06-12 13:16:18,771][func.train][INFO] - [TESTING] video: 21 | frame: 2431 / 4326
[2024-06-12 13:16:19,077][func.train][INFO] - [TESTING] video: 21 | frame: 2495 / 4326
[2024-06-12 13:16:19,378][func.train][INFO] - [TESTING] video: 21 | frame: 2559 / 4326
[2024-06-12 13:16:19,683][func.train][INFO] - [TESTING] video: 21 | frame: 2623 / 4326
[2024-06-12 13:16:19,994][func.train][INFO] - [TESTING] video: 21 | frame: 2687 / 4326
[2024-06-12 13:16:20,302][func.train][INFO] - [TESTING] video: 21 | frame: 2751 / 4326
[2024-06-12 13:16:20,608][func.train][INFO] - [TESTING] video: 21 | frame: 2815 / 4326
[2024-06-12 13:16:20,913][func.train][INFO] - [TESTING] video: 21 | frame: 2879 / 4326
[2024-06-12 13:16:21,222][func.train][INFO] - [TESTING] video: 21 | frame: 2943 / 4326
[2024-06-12 13:16:21,549][func.train][INFO] - [TESTING] video: 21 | frame: 3007 / 4326
[2024-06-12 13:16:21,856][func.train][INFO] - [TESTING] video: 21 | frame: 3071 / 4326
[2024-06-12 13:16:22,162][func.train][INFO] - [TESTING] video: 21 | frame: 3135 / 4326
[2024-06-12 13:16:22,465][func.train][INFO] - [TESTING] video: 21 | frame: 3199 / 4326
[2024-06-12 13:16:22,767][func.train][INFO] - [TESTING] video: 21 | frame: 3263 / 4326
[2024-06-12 13:16:23,083][func.train][INFO] - [TESTING] video: 21 | frame: 3327 / 4326
[2024-06-12 13:16:23,388][func.train][INFO] - [TESTING] video: 21 | frame: 3391 / 4326
[2024-06-12 13:16:23,694][func.train][INFO] - [TESTING] video: 21 | frame: 3455 / 4326
[2024-06-12 13:16:24,005][func.train][INFO] - [TESTING] video: 21 | frame: 3519 / 4326
[2024-06-12 13:16:24,323][func.train][INFO] - [TESTING] video: 21 | frame: 3583 / 4326
[2024-06-12 13:16:24,634][func.train][INFO] - [TESTING] video: 21 | frame: 3647 / 4326
[2024-06-12 13:16:24,938][func.train][INFO] - [TESTING] video: 21 | frame: 3711 / 4326
[2024-06-12 13:16:25,246][func.train][INFO] - [TESTING] video: 21 | frame: 3775 / 4326
[2024-06-12 13:16:25,551][func.train][INFO] - [TESTING] video: 21 | frame: 3839 / 4326
[2024-06-12 13:16:25,855][func.train][INFO] - [TESTING] video: 21 | frame: 3903 / 4326
[2024-06-12 13:16:26,160][func.train][INFO] - [TESTING] video: 21 | frame: 3967 / 4326
[2024-06-12 13:16:26,467][func.train][INFO] - [TESTING] video: 21 | frame: 4031 / 4326
[2024-06-12 13:16:26,767][func.train][INFO] - [TESTING] video: 21 | frame: 4095 / 4326
[2024-06-12 13:16:27,067][func.train][INFO] - [TESTING] video: 21 | frame: 4159 / 4326
[2024-06-12 13:16:27,382][func.train][INFO] - [TESTING] video: 21 | frame: 4223 / 4326
[2024-06-12 13:16:27,695][func.train][INFO] - [TESTING] video: 21 | frame: 4287 / 4326
[2024-06-12 13:16:29,475][func.train][INFO] - [TESTING] video: 21 | frame: 4325 / 4326
[2024-06-12 13:16:29,476][func.train][INFO] - [TESTING] video: 21 | video test time: 0.37 min | total test time: 2.39 min
[2024-06-12 13:16:29,525][func.train][INFO] - [TESTING] video: 21 | video_mean_curr_acc: 0.562 | mean_acc_future_frames: 0.3377 | video_mean_cum_acc_future: 0.4255
[2024-06-12 13:16:46,790][func.train][INFO] - [TESTING] Best epoch: 1 | Best cum_acc_future: 0.4
[2024-06-14 13:47:31,145][func.train][INFO] - Dist info:
[2024-06-14 13:47:31,146][func.train][INFO] - torch version: 2.2.2+cu121
[2024-06-14 13:47:31,148][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-06-14 13:47:31,148][func.train][INFO] - hydra version: 1.3.2
[2024-06-14 13:47:31,201][func.train][INFO] - Loading data
[2024-06-14 13:47:31,202][func.train][INFO] - Loading datasets
[2024-06-14 13:47:31,863][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe in 0m 1s
[2024-06-14 13:47:31,863][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe: (83243, 4)
[2024-06-14 13:47:31,873][func.train][INFO] - [SELECT DATASET] labels are already starting from 0
[2024-06-14 13:47:31,889][func.train][INFO] - [SELECT DATASET] ALL unique classes: [0 1 2 3 4 5 6]
[2024-06-14 13:47:31,902][func.train][INFO] - [SELECT DATASET] aLL dataframe (head):                                           image_path  video_idx frame_idx class
0  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         1     1
1  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         2     1
2  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         3     1
3  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         4     1
4  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         5     1
[2024-06-14 13:47:31,915][func.train][INFO] - [SELECT DATASET] ALL dataframe (tail):                                               image_path  ...  class
83238  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83239  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83240  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83241  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83242  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6

[5 rows x 4 columns]
[2024-06-14 13:47:31,916][func.train][INFO] - [DATASET] params: {'debug': False, 'dataset_name': 'autolaparo21', 'reduc_feats_folder': 'train_targets_x_mp/', 'num_classes': 7, 'num_next_labels': 6, 'last_seg_class': 7, 'predict_next_phase': True, 'get_target_feats': False, 'replace_current_with_next_class': False}
[2024-06-14 13:47:31,983][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:47:31,983][func.train][INFO] - [DATASET] split: train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 13:47:32,012][func.train][INFO] - [DATASET] train size: 55183
[2024-06-14 13:47:32,012][func.train][INFO] - [DATASET] train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 13:47:32,016][func.train][INFO] - [DATASET] Sampling video_idx: 1 at 1 fps to 6388 frames
[2024-06-14 13:47:32,023][func.train][INFO] - [DATASET] video 1 label_list: torch.Size([6388])
[2024-06-14 13:47:32,619][func.train][INFO] - [DATASET] Sampling video_idx: 2 at 1 fps to 3620 frames
[2024-06-14 13:47:32,623][func.train][INFO] - [DATASET] video 2 label_list: torch.Size([3620])
[2024-06-14 13:47:32,686][func.train][INFO] - [DATASET] Sampling video_idx: 3 at 1 fps to 3000 frames
[2024-06-14 13:47:32,689][func.train][INFO] - [DATASET] video 3 label_list: torch.Size([3000])
[2024-06-14 13:47:32,739][func.train][INFO] - [DATASET] Sampling video_idx: 4 at 1 fps to 2938 frames
[2024-06-14 13:47:32,741][func.train][INFO] - [DATASET] video 4 label_list: torch.Size([2938])
[2024-06-14 13:47:32,849][func.train][INFO] - [DATASET] Sampling video_idx: 5 at 1 fps to 3220 frames
[2024-06-14 13:47:32,851][func.train][INFO] - [DATASET] video 5 label_list: torch.Size([3220])
[2024-06-14 13:47:32,935][func.train][INFO] - [DATASET] Sampling video_idx: 6 at 1 fps to 3908 frames
[2024-06-14 13:47:32,937][func.train][INFO] - [DATASET] video 6 label_list: torch.Size([3908])
[2024-06-14 13:47:32,996][func.train][INFO] - [DATASET] Sampling video_idx: 7 at 1 fps to 1645 frames
[2024-06-14 13:47:32,997][func.train][INFO] - [DATASET] video 7 label_list: torch.Size([1645])
[2024-06-14 13:47:33,028][func.train][INFO] - [DATASET] Sampling video_idx: 8 at 1 fps to 4692 frames
[2024-06-14 13:47:33,030][func.train][INFO] - [DATASET] video 8 label_list: torch.Size([4692])
[2024-06-14 13:47:33,100][func.train][INFO] - [DATASET] Sampling video_idx: 9 at 1 fps to 5736 frames
[2024-06-14 13:47:33,103][func.train][INFO] - [DATASET] video 9 label_list: torch.Size([5736])
[2024-06-14 13:47:33,174][func.train][INFO] - [DATASET] Sampling video_idx: 10 at 1 fps to 5064 frames
[2024-06-14 13:47:33,176][func.train][INFO] - [DATASET] video 10 label_list: torch.Size([5064])
[2024-06-14 13:47:33,255][func.train][INFO] - [DATASET] Sampling video_idx: 11 at 1 fps to 4720 frames
[2024-06-14 13:47:33,257][func.train][INFO] - [DATASET] video 11 label_list: torch.Size([4720])
[2024-06-14 13:47:33,327][func.train][INFO] - [DATASET] Sampling video_idx: 12 at 1 fps to 2916 frames
[2024-06-14 13:47:33,329][func.train][INFO] - [DATASET] video 12 label_list: torch.Size([2916])
[2024-06-14 13:47:33,389][func.train][INFO] - [DATASET] Sampling video_idx: 13 at 1 fps to 2597 frames
[2024-06-14 13:47:33,391][func.train][INFO] - [DATASET] video 13 label_list: torch.Size([2597])
[2024-06-14 13:47:33,441][func.train][INFO] - [DATASET] Sampling video_idx: 14 at 1 fps to 4739 frames
[2024-06-14 13:47:33,445][func.train][INFO] - [DATASET] video 14 label_list: torch.Size([4739])
[2024-06-14 13:47:33,508][func.train][INFO] - [DATASET] number of train videos: 14
[2024-06-14 13:47:33,508][func.train][INFO] - [DATASET] avg video length: 65.69 minutes
[2024-06-14 13:47:33,576][func.train][INFO] - [DATASET] num classes at 1fps in train: (55183,)
[2024-06-14 13:47:33,578][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915}
[2024-06-14 13:47:33,583][func.train][INFO] - [DATASET] curr_class_weights: tensor([5.5989, 0.4087, 0.6284, 1.0496, 5.9139, 0.9633, 1.6039])
[2024-06-14 13:47:33,584][func.train][INFO] - [DATASET] eos_weight: count
[2024-06-14 13:47:33,584][func.train][INFO] - [DATASET] num_eos_vals: 840
[2024-06-14 13:47:33,584][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915, 7: 840}
[2024-06-14 13:47:33,586][func.train][INFO] - [DATASET] next_class_weights: tensor([4.9736, 0.3631, 0.5582, 0.9323, 5.2535, 0.8557, 1.4248, 8.3368])
[2024-06-14 13:47:33,740][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:47:33,740][func.train][INFO] - [DATASET] split: test video_indices: [15]
[2024-06-14 13:47:33,748][func.train][INFO] - [DATASET] test size: 3653
[2024-06-14 13:47:33,748][func.train][INFO] - [DATASET] test video_indices: [15]
[2024-06-14 13:47:33,753][func.train][INFO] - [DATASET] Sampling video_idx: 15 at 1 fps to 3653 frames
[2024-06-14 13:47:33,755][func.train][INFO] - [DATASET] video 15 label_list: torch.Size([3653])
[2024-06-14 13:47:33,810][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:47:33,811][func.train][INFO] - [DATASET] avg video length: 60.88 minutes
[2024-06-14 13:47:33,895][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:47:33,895][func.train][INFO] - [DATASET] split: test video_indices: [16]
[2024-06-14 13:47:33,901][func.train][INFO] - [DATASET] test size: 3612
[2024-06-14 13:47:33,901][func.train][INFO] - [DATASET] test video_indices: [16]
[2024-06-14 13:47:33,905][func.train][INFO] - [DATASET] Sampling video_idx: 16 at 1 fps to 3612 frames
[2024-06-14 13:47:33,907][func.train][INFO] - [DATASET] video 16 label_list: torch.Size([3612])
[2024-06-14 13:47:33,965][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:47:33,965][func.train][INFO] - [DATASET] avg video length: 60.20 minutes
[2024-06-14 13:47:34,040][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:47:34,041][func.train][INFO] - [DATASET] split: test video_indices: [17]
[2024-06-14 13:47:34,046][func.train][INFO] - [DATASET] test size: 4678
[2024-06-14 13:47:34,047][func.train][INFO] - [DATASET] test video_indices: [17]
[2024-06-14 13:47:34,051][func.train][INFO] - [DATASET] Sampling video_idx: 17 at 1 fps to 4678 frames
[2024-06-14 13:47:34,053][func.train][INFO] - [DATASET] video 17 label_list: torch.Size([4678])
[2024-06-14 13:47:34,115][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:47:34,116][func.train][INFO] - [DATASET] avg video length: 77.97 minutes
[2024-06-14 13:47:34,204][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:47:34,204][func.train][INFO] - [DATASET] split: test video_indices: [18]
[2024-06-14 13:47:34,211][func.train][INFO] - [DATASET] test size: 3546
[2024-06-14 13:47:34,211][func.train][INFO] - [DATASET] test video_indices: [18]
[2024-06-14 13:47:34,215][func.train][INFO] - [DATASET] Sampling video_idx: 18 at 1 fps to 3546 frames
[2024-06-14 13:47:34,217][func.train][INFO] - [DATASET] video 18 label_list: torch.Size([3546])
[2024-06-14 13:47:34,266][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:47:34,267][func.train][INFO] - [DATASET] avg video length: 59.10 minutes
[2024-06-14 13:47:34,359][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:47:34,360][func.train][INFO] - [DATASET] split: test video_indices: [19]
[2024-06-14 13:47:34,367][func.train][INFO] - [DATASET] test size: 3413
[2024-06-14 13:47:34,367][func.train][INFO] - [DATASET] test video_indices: [19]
[2024-06-14 13:47:34,371][func.train][INFO] - [DATASET] Sampling video_idx: 19 at 1 fps to 3413 frames
[2024-06-14 13:47:34,373][func.train][INFO] - [DATASET] video 19 label_list: torch.Size([3413])
[2024-06-14 13:47:34,432][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:47:34,432][func.train][INFO] - [DATASET] avg video length: 56.88 minutes
[2024-06-14 13:47:34,515][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:47:34,516][func.train][INFO] - [DATASET] split: test video_indices: [20]
[2024-06-14 13:47:34,522][func.train][INFO] - [DATASET] test size: 4832
[2024-06-14 13:47:34,522][func.train][INFO] - [DATASET] test video_indices: [20]
[2024-06-14 13:47:34,526][func.train][INFO] - [DATASET] Sampling video_idx: 20 at 1 fps to 4832 frames
[2024-06-14 13:47:34,528][func.train][INFO] - [DATASET] video 20 label_list: torch.Size([4832])
[2024-06-14 13:47:34,597][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:47:34,597][func.train][INFO] - [DATASET] avg video length: 80.53 minutes
[2024-06-14 13:47:34,678][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:47:34,679][func.train][INFO] - [DATASET] split: test video_indices: [21]
[2024-06-14 13:47:34,685][func.train][INFO] - [DATASET] test size: 4326
[2024-06-14 13:47:34,685][func.train][INFO] - [DATASET] test video_indices: [21]
[2024-06-14 13:47:34,690][func.train][INFO] - [DATASET] Sampling video_idx: 21 at 1 fps to 4326 frames
[2024-06-14 13:47:34,693][func.train][INFO] - [DATASET] video 21 label_list: torch.Size([4326])
[2024-06-14 13:47:34,756][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:47:34,756][func.train][INFO] - [DATASET] avg video length: 72.10 minutes
[2024-06-14 13:47:34,783][func.train][INFO] - Time to load datasets: 0.06 min
[2024-06-14 13:47:34,783][func.train][INFO] - Creating data loaders
[2024-06-14 13:47:34,787][func.train][INFO] - Creating model with {'one': 7} classes
[2024-06-14 13:47:57,201][func.train][INFO] - Dist info:
[2024-06-14 13:47:57,202][func.train][INFO] - torch version: 2.2.2+cu121
[2024-06-14 13:47:57,202][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-06-14 13:47:57,203][func.train][INFO] - hydra version: 1.3.2
[2024-06-14 13:47:57,217][func.train][INFO] - Loading data
[2024-06-14 13:47:57,217][func.train][INFO] - Loading datasets
[2024-06-14 13:47:57,759][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe in 0m 1s
[2024-06-14 13:47:57,760][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe: (83243, 4)
[2024-06-14 13:47:57,770][func.train][INFO] - [SELECT DATASET] labels are already starting from 0
[2024-06-14 13:47:57,786][func.train][INFO] - [SELECT DATASET] ALL unique classes: [0 1 2 3 4 5 6]
[2024-06-14 13:47:57,799][func.train][INFO] - [SELECT DATASET] aLL dataframe (head):                                           image_path  video_idx frame_idx class
0  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         1     1
1  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         2     1
2  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         3     1
3  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         4     1
4  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         5     1
[2024-06-14 13:47:57,813][func.train][INFO] - [SELECT DATASET] ALL dataframe (tail):                                               image_path  ...  class
83238  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83239  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83240  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83241  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83242  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6

[5 rows x 4 columns]
[2024-06-14 13:47:57,814][func.train][INFO] - [DATASET] params: {'debug': False, 'dataset_name': 'autolaparo21', 'reduc_feats_folder': 'train_targets_x_mp/', 'num_classes': 7, 'num_next_labels': 6, 'last_seg_class': 7, 'predict_next_phase': True, 'get_target_feats': False, 'replace_current_with_next_class': False}
[2024-06-14 13:47:57,883][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:47:57,884][func.train][INFO] - [DATASET] split: train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 13:47:57,917][func.train][INFO] - [DATASET] train size: 55183
[2024-06-14 13:47:57,918][func.train][INFO] - [DATASET] train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 13:47:57,922][func.train][INFO] - [DATASET] Sampling video_idx: 1 at 1 fps to 6388 frames
[2024-06-14 13:47:57,927][func.train][INFO] - [DATASET] video 1 label_list: torch.Size([6388])
[2024-06-14 13:47:58,307][func.train][INFO] - [DATASET] Sampling video_idx: 2 at 1 fps to 3620 frames
[2024-06-14 13:47:58,309][func.train][INFO] - [DATASET] video 2 label_list: torch.Size([3620])
[2024-06-14 13:47:58,336][func.train][INFO] - [DATASET] Sampling video_idx: 3 at 1 fps to 3000 frames
[2024-06-14 13:47:58,337][func.train][INFO] - [DATASET] video 3 label_list: torch.Size([3000])
[2024-06-14 13:47:58,355][func.train][INFO] - [DATASET] Sampling video_idx: 4 at 1 fps to 2938 frames
[2024-06-14 13:47:58,356][func.train][INFO] - [DATASET] video 4 label_list: torch.Size([2938])
[2024-06-14 13:47:58,370][func.train][INFO] - [DATASET] Sampling video_idx: 5 at 1 fps to 3220 frames
[2024-06-14 13:47:58,371][func.train][INFO] - [DATASET] video 5 label_list: torch.Size([3220])
[2024-06-14 13:47:58,388][func.train][INFO] - [DATASET] Sampling video_idx: 6 at 1 fps to 3908 frames
[2024-06-14 13:47:58,389][func.train][INFO] - [DATASET] video 6 label_list: torch.Size([3908])
[2024-06-14 13:47:58,405][func.train][INFO] - [DATASET] Sampling video_idx: 7 at 1 fps to 1645 frames
[2024-06-14 13:47:58,407][func.train][INFO] - [DATASET] video 7 label_list: torch.Size([1645])
[2024-06-14 13:47:58,417][func.train][INFO] - [DATASET] Sampling video_idx: 8 at 1 fps to 4692 frames
[2024-06-14 13:47:58,419][func.train][INFO] - [DATASET] video 8 label_list: torch.Size([4692])
[2024-06-14 13:47:58,444][func.train][INFO] - [DATASET] Sampling video_idx: 9 at 1 fps to 5736 frames
[2024-06-14 13:47:58,447][func.train][INFO] - [DATASET] video 9 label_list: torch.Size([5736])
[2024-06-14 13:47:58,476][func.train][INFO] - [DATASET] Sampling video_idx: 10 at 1 fps to 5064 frames
[2024-06-14 13:47:58,479][func.train][INFO] - [DATASET] video 10 label_list: torch.Size([5064])
[2024-06-14 13:47:58,506][func.train][INFO] - [DATASET] Sampling video_idx: 11 at 1 fps to 4720 frames
[2024-06-14 13:47:58,508][func.train][INFO] - [DATASET] video 11 label_list: torch.Size([4720])
[2024-06-14 13:47:58,527][func.train][INFO] - [DATASET] Sampling video_idx: 12 at 1 fps to 2916 frames
[2024-06-14 13:47:58,529][func.train][INFO] - [DATASET] video 12 label_list: torch.Size([2916])
[2024-06-14 13:47:58,545][func.train][INFO] - [DATASET] Sampling video_idx: 13 at 1 fps to 2597 frames
[2024-06-14 13:47:58,546][func.train][INFO] - [DATASET] video 13 label_list: torch.Size([2597])
[2024-06-14 13:47:58,556][func.train][INFO] - [DATASET] Sampling video_idx: 14 at 1 fps to 4739 frames
[2024-06-14 13:47:58,557][func.train][INFO] - [DATASET] video 14 label_list: torch.Size([4739])
[2024-06-14 13:47:58,572][func.train][INFO] - [DATASET] number of train videos: 14
[2024-06-14 13:47:58,572][func.train][INFO] - [DATASET] avg video length: 65.69 minutes
[2024-06-14 13:47:58,610][func.train][INFO] - [DATASET] num classes at 1fps in train: (55183,)
[2024-06-14 13:47:58,612][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915}
[2024-06-14 13:47:58,614][func.train][INFO] - [DATASET] curr_class_weights: tensor([5.5989, 0.4087, 0.6284, 1.0496, 5.9139, 0.9633, 1.6039])
[2024-06-14 13:47:58,615][func.train][INFO] - [DATASET] eos_weight: count
[2024-06-14 13:47:58,615][func.train][INFO] - [DATASET] num_eos_vals: 840
[2024-06-14 13:47:58,615][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915, 7: 840}
[2024-06-14 13:47:58,617][func.train][INFO] - [DATASET] next_class_weights: tensor([4.9736, 0.3631, 0.5582, 0.9323, 5.2535, 0.8557, 1.4248, 8.3368])
[2024-06-14 13:47:58,723][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:47:58,723][func.train][INFO] - [DATASET] split: test video_indices: [15]
[2024-06-14 13:47:58,726][func.train][INFO] - [DATASET] test size: 3653
[2024-06-14 13:47:58,726][func.train][INFO] - [DATASET] test video_indices: [15]
[2024-06-14 13:47:58,728][func.train][INFO] - [DATASET] Sampling video_idx: 15 at 1 fps to 3653 frames
[2024-06-14 13:47:58,729][func.train][INFO] - [DATASET] video 15 label_list: torch.Size([3653])
[2024-06-14 13:47:58,743][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:47:58,743][func.train][INFO] - [DATASET] avg video length: 60.88 minutes
[2024-06-14 13:47:58,816][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:47:58,817][func.train][INFO] - [DATASET] split: test video_indices: [16]
[2024-06-14 13:47:58,822][func.train][INFO] - [DATASET] test size: 3612
[2024-06-14 13:47:58,822][func.train][INFO] - [DATASET] test video_indices: [16]
[2024-06-14 13:47:58,826][func.train][INFO] - [DATASET] Sampling video_idx: 16 at 1 fps to 3612 frames
[2024-06-14 13:47:58,827][func.train][INFO] - [DATASET] video 16 label_list: torch.Size([3612])
[2024-06-14 13:47:58,847][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:47:58,847][func.train][INFO] - [DATASET] avg video length: 60.20 minutes
[2024-06-14 13:47:58,931][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:47:58,932][func.train][INFO] - [DATASET] split: test video_indices: [17]
[2024-06-14 13:47:58,937][func.train][INFO] - [DATASET] test size: 4678
[2024-06-14 13:47:58,937][func.train][INFO] - [DATASET] test video_indices: [17]
[2024-06-14 13:47:58,941][func.train][INFO] - [DATASET] Sampling video_idx: 17 at 1 fps to 4678 frames
[2024-06-14 13:47:58,943][func.train][INFO] - [DATASET] video 17 label_list: torch.Size([4678])
[2024-06-14 13:47:58,965][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:47:58,966][func.train][INFO] - [DATASET] avg video length: 77.97 minutes
[2024-06-14 13:47:59,051][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:47:59,051][func.train][INFO] - [DATASET] split: test video_indices: [18]
[2024-06-14 13:47:59,056][func.train][INFO] - [DATASET] test size: 3546
[2024-06-14 13:47:59,057][func.train][INFO] - [DATASET] test video_indices: [18]
[2024-06-14 13:47:59,061][func.train][INFO] - [DATASET] Sampling video_idx: 18 at 1 fps to 3546 frames
[2024-06-14 13:47:59,063][func.train][INFO] - [DATASET] video 18 label_list: torch.Size([3546])
[2024-06-14 13:47:59,077][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:47:59,078][func.train][INFO] - [DATASET] avg video length: 59.10 minutes
[2024-06-14 13:47:59,157][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:47:59,157][func.train][INFO] - [DATASET] split: test video_indices: [19]
[2024-06-14 13:47:59,162][func.train][INFO] - [DATASET] test size: 3413
[2024-06-14 13:47:59,163][func.train][INFO] - [DATASET] test video_indices: [19]
[2024-06-14 13:47:59,167][func.train][INFO] - [DATASET] Sampling video_idx: 19 at 1 fps to 3413 frames
[2024-06-14 13:47:59,169][func.train][INFO] - [DATASET] video 19 label_list: torch.Size([3413])
[2024-06-14 13:47:59,186][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:47:59,187][func.train][INFO] - [DATASET] avg video length: 56.88 minutes
[2024-06-14 13:47:59,265][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:47:59,266][func.train][INFO] - [DATASET] split: test video_indices: [20]
[2024-06-14 13:47:59,271][func.train][INFO] - [DATASET] test size: 4832
[2024-06-14 13:47:59,272][func.train][INFO] - [DATASET] test video_indices: [20]
[2024-06-14 13:47:59,277][func.train][INFO] - [DATASET] Sampling video_idx: 20 at 1 fps to 4832 frames
[2024-06-14 13:47:59,279][func.train][INFO] - [DATASET] video 20 label_list: torch.Size([4832])
[2024-06-14 13:47:59,303][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:47:59,304][func.train][INFO] - [DATASET] avg video length: 80.53 minutes
[2024-06-14 13:47:59,388][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:47:59,388][func.train][INFO] - [DATASET] split: test video_indices: [21]
[2024-06-14 13:47:59,393][func.train][INFO] - [DATASET] test size: 4326
[2024-06-14 13:47:59,393][func.train][INFO] - [DATASET] test video_indices: [21]
[2024-06-14 13:47:59,397][func.train][INFO] - [DATASET] Sampling video_idx: 21 at 1 fps to 4326 frames
[2024-06-14 13:47:59,399][func.train][INFO] - [DATASET] video 21 label_list: torch.Size([4326])
[2024-06-14 13:47:59,418][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:47:59,419][func.train][INFO] - [DATASET] avg video length: 72.10 minutes
[2024-06-14 13:47:59,437][func.train][INFO] - Time to load datasets: 0.04 min
[2024-06-14 13:47:59,438][func.train][INFO] - Creating data loaders
[2024-06-14 13:47:59,440][func.train][INFO] - Creating model with {'one': 7} classes
[2024-06-14 13:50:02,916][func.train][INFO] - Dist info:
[2024-06-14 13:50:02,917][func.train][INFO] - torch version: 2.2.2+cu121
[2024-06-14 13:50:02,918][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-06-14 13:50:02,918][func.train][INFO] - hydra version: 1.3.2
[2024-06-14 13:50:02,934][func.train][INFO] - Loading data
[2024-06-14 13:50:02,935][func.train][INFO] - Loading datasets
[2024-06-14 13:50:03,481][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe in 0m 1s
[2024-06-14 13:50:03,482][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe: (83243, 4)
[2024-06-14 13:50:03,492][func.train][INFO] - [SELECT DATASET] labels are already starting from 0
[2024-06-14 13:50:03,508][func.train][INFO] - [SELECT DATASET] ALL unique classes: [0 1 2 3 4 5 6]
[2024-06-14 13:50:03,520][func.train][INFO] - [SELECT DATASET] aLL dataframe (head):                                           image_path  video_idx frame_idx class
0  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         1     1
1  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         2     1
2  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         3     1
3  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         4     1
4  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         5     1
[2024-06-14 13:50:03,534][func.train][INFO] - [SELECT DATASET] ALL dataframe (tail):                                               image_path  ...  class
83238  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83239  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83240  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83241  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83242  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6

[5 rows x 4 columns]
[2024-06-14 13:50:03,535][func.train][INFO] - [DATASET] params: {'debug': False, 'dataset_name': 'autolaparo21', 'reduc_feats_folder': 'train_targets_x_mp/', 'num_classes': 7, 'num_next_labels': 6, 'last_seg_class': 7, 'predict_next_phase': True, 'get_target_feats': False, 'replace_current_with_next_class': False}
[2024-06-14 13:50:03,604][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:50:03,605][func.train][INFO] - [DATASET] split: train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 13:50:03,635][func.train][INFO] - [DATASET] train size: 55183
[2024-06-14 13:50:03,636][func.train][INFO] - [DATASET] train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 13:50:03,640][func.train][INFO] - [DATASET] Sampling video_idx: 1 at 1 fps to 6388 frames
[2024-06-14 13:50:03,646][func.train][INFO] - [DATASET] video 1 label_list: torch.Size([6388])
[2024-06-14 13:50:04,111][func.train][INFO] - [DATASET] Sampling video_idx: 2 at 1 fps to 3620 frames
[2024-06-14 13:50:04,113][func.train][INFO] - [DATASET] video 2 label_list: torch.Size([3620])
[2024-06-14 13:50:04,158][func.train][INFO] - [DATASET] Sampling video_idx: 3 at 1 fps to 3000 frames
[2024-06-14 13:50:04,162][func.train][INFO] - [DATASET] video 3 label_list: torch.Size([3000])
[2024-06-14 13:50:04,183][func.train][INFO] - [DATASET] Sampling video_idx: 4 at 1 fps to 2938 frames
[2024-06-14 13:50:04,185][func.train][INFO] - [DATASET] video 4 label_list: torch.Size([2938])
[2024-06-14 13:50:04,201][func.train][INFO] - [DATASET] Sampling video_idx: 5 at 1 fps to 3220 frames
[2024-06-14 13:50:04,203][func.train][INFO] - [DATASET] video 5 label_list: torch.Size([3220])
[2024-06-14 13:50:04,225][func.train][INFO] - [DATASET] Sampling video_idx: 6 at 1 fps to 3908 frames
[2024-06-14 13:50:04,227][func.train][INFO] - [DATASET] video 6 label_list: torch.Size([3908])
[2024-06-14 13:50:04,247][func.train][INFO] - [DATASET] Sampling video_idx: 7 at 1 fps to 1645 frames
[2024-06-14 13:50:04,249][func.train][INFO] - [DATASET] video 7 label_list: torch.Size([1645])
[2024-06-14 13:50:04,259][func.train][INFO] - [DATASET] Sampling video_idx: 8 at 1 fps to 4692 frames
[2024-06-14 13:50:04,261][func.train][INFO] - [DATASET] video 8 label_list: torch.Size([4692])
[2024-06-14 13:50:04,286][func.train][INFO] - [DATASET] Sampling video_idx: 9 at 1 fps to 5736 frames
[2024-06-14 13:50:04,289][func.train][INFO] - [DATASET] video 9 label_list: torch.Size([5736])
[2024-06-14 13:50:04,319][func.train][INFO] - [DATASET] Sampling video_idx: 10 at 1 fps to 5064 frames
[2024-06-14 13:50:04,321][func.train][INFO] - [DATASET] video 10 label_list: torch.Size([5064])
[2024-06-14 13:50:04,346][func.train][INFO] - [DATASET] Sampling video_idx: 11 at 1 fps to 4720 frames
[2024-06-14 13:50:04,348][func.train][INFO] - [DATASET] video 11 label_list: torch.Size([4720])
[2024-06-14 13:50:04,372][func.train][INFO] - [DATASET] Sampling video_idx: 12 at 1 fps to 2916 frames
[2024-06-14 13:50:04,373][func.train][INFO] - [DATASET] video 12 label_list: torch.Size([2916])
[2024-06-14 13:50:04,397][func.train][INFO] - [DATASET] Sampling video_idx: 13 at 1 fps to 2597 frames
[2024-06-14 13:50:04,399][func.train][INFO] - [DATASET] video 13 label_list: torch.Size([2597])
[2024-06-14 13:50:04,416][func.train][INFO] - [DATASET] Sampling video_idx: 14 at 1 fps to 4739 frames
[2024-06-14 13:50:04,418][func.train][INFO] - [DATASET] video 14 label_list: torch.Size([4739])
[2024-06-14 13:50:04,439][func.train][INFO] - [DATASET] number of train videos: 14
[2024-06-14 13:50:04,440][func.train][INFO] - [DATASET] avg video length: 65.69 minutes
[2024-06-14 13:50:04,511][func.train][INFO] - [DATASET] num classes at 1fps in train: (55183,)
[2024-06-14 13:50:04,514][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915}
[2024-06-14 13:50:04,521][func.train][INFO] - [DATASET] curr_class_weights: tensor([5.5989, 0.4087, 0.6284, 1.0496, 5.9139, 0.9633, 1.6039])
[2024-06-14 13:50:04,522][func.train][INFO] - [DATASET] eos_weight: count
[2024-06-14 13:50:04,522][func.train][INFO] - [DATASET] num_eos_vals: 840
[2024-06-14 13:50:04,523][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915, 7: 840}
[2024-06-14 13:50:04,524][func.train][INFO] - [DATASET] next_class_weights: tensor([4.9736, 0.3631, 0.5582, 0.9323, 5.2535, 0.8557, 1.4248, 8.3368])
[2024-06-14 13:50:04,653][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:50:04,654][func.train][INFO] - [DATASET] split: test video_indices: [15]
[2024-06-14 13:50:04,662][func.train][INFO] - [DATASET] test size: 3653
[2024-06-14 13:50:04,663][func.train][INFO] - [DATASET] test video_indices: [15]
[2024-06-14 13:50:04,667][func.train][INFO] - [DATASET] Sampling video_idx: 15 at 1 fps to 3653 frames
[2024-06-14 13:50:04,669][func.train][INFO] - [DATASET] video 15 label_list: torch.Size([3653])
[2024-06-14 13:50:04,696][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:50:04,697][func.train][INFO] - [DATASET] avg video length: 60.88 minutes
[2024-06-14 13:50:04,784][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:50:04,785][func.train][INFO] - [DATASET] split: test video_indices: [16]
[2024-06-14 13:50:04,790][func.train][INFO] - [DATASET] test size: 3612
[2024-06-14 13:50:04,791][func.train][INFO] - [DATASET] test video_indices: [16]
[2024-06-14 13:50:04,796][func.train][INFO] - [DATASET] Sampling video_idx: 16 at 1 fps to 3612 frames
[2024-06-14 13:50:04,797][func.train][INFO] - [DATASET] video 16 label_list: torch.Size([3612])
[2024-06-14 13:50:04,813][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:50:04,814][func.train][INFO] - [DATASET] avg video length: 60.20 minutes
[2024-06-14 13:50:04,909][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:50:04,910][func.train][INFO] - [DATASET] split: test video_indices: [17]
[2024-06-14 13:50:04,919][func.train][INFO] - [DATASET] test size: 4678
[2024-06-14 13:50:04,920][func.train][INFO] - [DATASET] test video_indices: [17]
[2024-06-14 13:50:04,924][func.train][INFO] - [DATASET] Sampling video_idx: 17 at 1 fps to 4678 frames
[2024-06-14 13:50:04,926][func.train][INFO] - [DATASET] video 17 label_list: torch.Size([4678])
[2024-06-14 13:50:04,959][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:50:04,960][func.train][INFO] - [DATASET] avg video length: 77.97 minutes
[2024-06-14 13:50:05,044][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:50:05,044][func.train][INFO] - [DATASET] split: test video_indices: [18]
[2024-06-14 13:50:05,050][func.train][INFO] - [DATASET] test size: 3546
[2024-06-14 13:50:05,050][func.train][INFO] - [DATASET] test video_indices: [18]
[2024-06-14 13:50:05,054][func.train][INFO] - [DATASET] Sampling video_idx: 18 at 1 fps to 3546 frames
[2024-06-14 13:50:05,056][func.train][INFO] - [DATASET] video 18 label_list: torch.Size([3546])
[2024-06-14 13:50:05,072][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:50:05,073][func.train][INFO] - [DATASET] avg video length: 59.10 minutes
[2024-06-14 13:50:05,149][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:50:05,149][func.train][INFO] - [DATASET] split: test video_indices: [19]
[2024-06-14 13:50:05,155][func.train][INFO] - [DATASET] test size: 3413
[2024-06-14 13:50:05,156][func.train][INFO] - [DATASET] test video_indices: [19]
[2024-06-14 13:50:05,160][func.train][INFO] - [DATASET] Sampling video_idx: 19 at 1 fps to 3413 frames
[2024-06-14 13:50:05,162][func.train][INFO] - [DATASET] video 19 label_list: torch.Size([3413])
[2024-06-14 13:50:05,181][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:50:05,181][func.train][INFO] - [DATASET] avg video length: 56.88 minutes
[2024-06-14 13:50:05,263][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:50:05,263][func.train][INFO] - [DATASET] split: test video_indices: [20]
[2024-06-14 13:50:05,270][func.train][INFO] - [DATASET] test size: 4832
[2024-06-14 13:50:05,270][func.train][INFO] - [DATASET] test video_indices: [20]
[2024-06-14 13:50:05,274][func.train][INFO] - [DATASET] Sampling video_idx: 20 at 1 fps to 4832 frames
[2024-06-14 13:50:05,276][func.train][INFO] - [DATASET] video 20 label_list: torch.Size([4832])
[2024-06-14 13:50:05,295][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:50:05,296][func.train][INFO] - [DATASET] avg video length: 80.53 minutes
[2024-06-14 13:50:05,372][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:50:05,372][func.train][INFO] - [DATASET] split: test video_indices: [21]
[2024-06-14 13:50:05,379][func.train][INFO] - [DATASET] test size: 4326
[2024-06-14 13:50:05,379][func.train][INFO] - [DATASET] test video_indices: [21]
[2024-06-14 13:50:05,383][func.train][INFO] - [DATASET] Sampling video_idx: 21 at 1 fps to 4326 frames
[2024-06-14 13:50:05,385][func.train][INFO] - [DATASET] video 21 label_list: torch.Size([4326])
[2024-06-14 13:50:05,406][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:50:05,407][func.train][INFO] - [DATASET] avg video length: 72.10 minutes
[2024-06-14 13:50:05,415][func.train][INFO] - Time to load datasets: 0.04 min
[2024-06-14 13:50:05,416][func.train][INFO] - Creating data loaders
[2024-06-14 13:50:05,419][func.train][INFO] - Creating model with {'one': 7} classes
[2024-06-14 13:54:38,478][func.train][INFO] - Dist info:
[2024-06-14 13:54:38,479][func.train][INFO] - torch version: 2.2.2+cu121
[2024-06-14 13:54:38,480][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-06-14 13:54:38,480][func.train][INFO] - hydra version: 1.3.2
[2024-06-14 13:54:38,484][func.train][INFO] - Loading data
[2024-06-14 13:54:38,485][func.train][INFO] - Loading datasets
[2024-06-14 13:54:39,006][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe in 0m 1s
[2024-06-14 13:54:39,006][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe: (83243, 4)
[2024-06-14 13:54:39,018][func.train][INFO] - [SELECT DATASET] labels are already starting from 0
[2024-06-14 13:54:39,030][func.train][INFO] - [SELECT DATASET] ALL unique classes: [0 1 2 3 4 5 6]
[2024-06-14 13:54:39,041][func.train][INFO] - [SELECT DATASET] aLL dataframe (head):                                           image_path  video_idx frame_idx class
0  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         1     1
1  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         2     1
2  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         3     1
3  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         4     1
4  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         5     1
[2024-06-14 13:54:39,053][func.train][INFO] - [SELECT DATASET] ALL dataframe (tail):                                               image_path  ...  class
83238  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83239  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83240  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83241  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83242  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6

[5 rows x 4 columns]
[2024-06-14 13:54:39,055][func.train][INFO] - [DATASET] params: {'debug': False, 'dataset_name': 'autolaparo21', 'reduc_feats_folder': 'train_targets_x_mp/', 'num_classes': 7, 'num_next_labels': 6, 'last_seg_class': 7, 'predict_next_phase': True, 'get_target_feats': False, 'replace_current_with_next_class': False}
[2024-06-14 13:54:39,127][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:54:39,127][func.train][INFO] - [DATASET] split: train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 13:54:39,159][func.train][INFO] - [DATASET] train size: 55183
[2024-06-14 13:54:39,160][func.train][INFO] - [DATASET] train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 13:54:39,163][func.train][INFO] - [DATASET] Sampling video_idx: 1 at 1 fps to 6388 frames
[2024-06-14 13:54:39,168][func.train][INFO] - [DATASET] video 1 label_list: torch.Size([6388])
[2024-06-14 13:54:39,616][func.train][INFO] - [DATASET] Sampling video_idx: 2 at 1 fps to 3620 frames
[2024-06-14 13:54:39,618][func.train][INFO] - [DATASET] video 2 label_list: torch.Size([3620])
[2024-06-14 13:54:39,642][func.train][INFO] - [DATASET] Sampling video_idx: 3 at 1 fps to 3000 frames
[2024-06-14 13:54:39,643][func.train][INFO] - [DATASET] video 3 label_list: torch.Size([3000])
[2024-06-14 13:54:39,658][func.train][INFO] - [DATASET] Sampling video_idx: 4 at 1 fps to 2938 frames
[2024-06-14 13:54:39,660][func.train][INFO] - [DATASET] video 4 label_list: torch.Size([2938])
[2024-06-14 13:54:39,675][func.train][INFO] - [DATASET] Sampling video_idx: 5 at 1 fps to 3220 frames
[2024-06-14 13:54:39,676][func.train][INFO] - [DATASET] video 5 label_list: torch.Size([3220])
[2024-06-14 13:54:39,693][func.train][INFO] - [DATASET] Sampling video_idx: 6 at 1 fps to 3908 frames
[2024-06-14 13:54:39,695][func.train][INFO] - [DATASET] video 6 label_list: torch.Size([3908])
[2024-06-14 13:54:39,715][func.train][INFO] - [DATASET] Sampling video_idx: 7 at 1 fps to 1645 frames
[2024-06-14 13:54:39,716][func.train][INFO] - [DATASET] video 7 label_list: torch.Size([1645])
[2024-06-14 13:54:39,727][func.train][INFO] - [DATASET] Sampling video_idx: 8 at 1 fps to 4692 frames
[2024-06-14 13:54:39,729][func.train][INFO] - [DATASET] video 8 label_list: torch.Size([4692])
[2024-06-14 13:54:39,751][func.train][INFO] - [DATASET] Sampling video_idx: 9 at 1 fps to 5736 frames
[2024-06-14 13:54:39,753][func.train][INFO] - [DATASET] video 9 label_list: torch.Size([5736])
[2024-06-14 13:54:39,779][func.train][INFO] - [DATASET] Sampling video_idx: 10 at 1 fps to 5064 frames
[2024-06-14 13:54:39,781][func.train][INFO] - [DATASET] video 10 label_list: torch.Size([5064])
[2024-06-14 13:54:39,806][func.train][INFO] - [DATASET] Sampling video_idx: 11 at 1 fps to 4720 frames
[2024-06-14 13:54:39,808][func.train][INFO] - [DATASET] video 11 label_list: torch.Size([4720])
[2024-06-14 13:54:39,828][func.train][INFO] - [DATASET] Sampling video_idx: 12 at 1 fps to 2916 frames
[2024-06-14 13:54:39,830][func.train][INFO] - [DATASET] video 12 label_list: torch.Size([2916])
[2024-06-14 13:54:39,848][func.train][INFO] - [DATASET] Sampling video_idx: 13 at 1 fps to 2597 frames
[2024-06-14 13:54:39,849][func.train][INFO] - [DATASET] video 13 label_list: torch.Size([2597])
[2024-06-14 13:54:39,863][func.train][INFO] - [DATASET] Sampling video_idx: 14 at 1 fps to 4739 frames
[2024-06-14 13:54:39,865][func.train][INFO] - [DATASET] video 14 label_list: torch.Size([4739])
[2024-06-14 13:54:39,883][func.train][INFO] - [DATASET] number of train videos: 14
[2024-06-14 13:54:39,883][func.train][INFO] - [DATASET] avg video length: 65.69 minutes
[2024-06-14 13:54:39,966][func.train][INFO] - [DATASET] num classes at 1fps in train: (55183,)
[2024-06-14 13:54:39,969][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915}
[2024-06-14 13:54:39,974][func.train][INFO] - [DATASET] curr_class_weights: tensor([5.5989, 0.4087, 0.6284, 1.0496, 5.9139, 0.9633, 1.6039])
[2024-06-14 13:54:39,975][func.train][INFO] - [DATASET] eos_weight: count
[2024-06-14 13:54:39,975][func.train][INFO] - [DATASET] num_eos_vals: 840
[2024-06-14 13:54:39,975][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915, 7: 840}
[2024-06-14 13:54:39,977][func.train][INFO] - [DATASET] next_class_weights: tensor([4.9736, 0.3631, 0.5582, 0.9323, 5.2535, 0.8557, 1.4248, 8.3368])
[2024-06-14 13:54:40,118][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:54:40,119][func.train][INFO] - [DATASET] split: test video_indices: [15]
[2024-06-14 13:54:40,124][func.train][INFO] - [DATASET] test size: 3653
[2024-06-14 13:54:40,125][func.train][INFO] - [DATASET] test video_indices: [15]
[2024-06-14 13:54:40,129][func.train][INFO] - [DATASET] Sampling video_idx: 15 at 1 fps to 3653 frames
[2024-06-14 13:54:40,131][func.train][INFO] - [DATASET] video 15 label_list: torch.Size([3653])
[2024-06-14 13:54:40,150][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:54:40,150][func.train][INFO] - [DATASET] avg video length: 60.88 minutes
[2024-06-14 13:54:40,247][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:54:40,247][func.train][INFO] - [DATASET] split: test video_indices: [16]
[2024-06-14 13:54:40,252][func.train][INFO] - [DATASET] test size: 3612
[2024-06-14 13:54:40,253][func.train][INFO] - [DATASET] test video_indices: [16]
[2024-06-14 13:54:40,256][func.train][INFO] - [DATASET] Sampling video_idx: 16 at 1 fps to 3612 frames
[2024-06-14 13:54:40,258][func.train][INFO] - [DATASET] video 16 label_list: torch.Size([3612])
[2024-06-14 13:54:40,272][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:54:40,273][func.train][INFO] - [DATASET] avg video length: 60.20 minutes
[2024-06-14 13:54:40,354][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:54:40,354][func.train][INFO] - [DATASET] split: test video_indices: [17]
[2024-06-14 13:54:40,359][func.train][INFO] - [DATASET] test size: 4678
[2024-06-14 13:54:40,359][func.train][INFO] - [DATASET] test video_indices: [17]
[2024-06-14 13:54:40,363][func.train][INFO] - [DATASET] Sampling video_idx: 17 at 1 fps to 4678 frames
[2024-06-14 13:54:40,365][func.train][INFO] - [DATASET] video 17 label_list: torch.Size([4678])
[2024-06-14 13:54:40,386][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:54:40,387][func.train][INFO] - [DATASET] avg video length: 77.97 minutes
[2024-06-14 13:54:40,470][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:54:40,470][func.train][INFO] - [DATASET] split: test video_indices: [18]
[2024-06-14 13:54:40,475][func.train][INFO] - [DATASET] test size: 3546
[2024-06-14 13:54:40,476][func.train][INFO] - [DATASET] test video_indices: [18]
[2024-06-14 13:54:40,483][func.train][INFO] - [DATASET] Sampling video_idx: 18 at 1 fps to 3546 frames
[2024-06-14 13:54:40,485][func.train][INFO] - [DATASET] video 18 label_list: torch.Size([3546])
[2024-06-14 13:54:40,500][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:54:40,501][func.train][INFO] - [DATASET] avg video length: 59.10 minutes
[2024-06-14 13:54:40,582][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:54:40,582][func.train][INFO] - [DATASET] split: test video_indices: [19]
[2024-06-14 13:54:40,587][func.train][INFO] - [DATASET] test size: 3413
[2024-06-14 13:54:40,588][func.train][INFO] - [DATASET] test video_indices: [19]
[2024-06-14 13:54:40,592][func.train][INFO] - [DATASET] Sampling video_idx: 19 at 1 fps to 3413 frames
[2024-06-14 13:54:40,593][func.train][INFO] - [DATASET] video 19 label_list: torch.Size([3413])
[2024-06-14 13:54:40,609][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:54:40,610][func.train][INFO] - [DATASET] avg video length: 56.88 minutes
[2024-06-14 13:54:40,695][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:54:40,696][func.train][INFO] - [DATASET] split: test video_indices: [20]
[2024-06-14 13:54:40,701][func.train][INFO] - [DATASET] test size: 4832
[2024-06-14 13:54:40,702][func.train][INFO] - [DATASET] test video_indices: [20]
[2024-06-14 13:54:40,706][func.train][INFO] - [DATASET] Sampling video_idx: 20 at 1 fps to 4832 frames
[2024-06-14 13:54:40,709][func.train][INFO] - [DATASET] video 20 label_list: torch.Size([4832])
[2024-06-14 13:54:40,731][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:54:40,732][func.train][INFO] - [DATASET] avg video length: 80.53 minutes
[2024-06-14 13:54:40,819][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:54:40,820][func.train][INFO] - [DATASET] split: test video_indices: [21]
[2024-06-14 13:54:40,826][func.train][INFO] - [DATASET] test size: 4326
[2024-06-14 13:54:40,826][func.train][INFO] - [DATASET] test video_indices: [21]
[2024-06-14 13:54:40,830][func.train][INFO] - [DATASET] Sampling video_idx: 21 at 1 fps to 4326 frames
[2024-06-14 13:54:40,833][func.train][INFO] - [DATASET] video 21 label_list: torch.Size([4326])
[2024-06-14 13:54:40,853][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:54:40,854][func.train][INFO] - [DATASET] avg video length: 72.10 minutes
[2024-06-14 13:54:40,879][func.train][INFO] - Time to load datasets: 0.04 min
[2024-06-14 13:54:40,879][func.train][INFO] - Creating data loaders
[2024-06-14 13:54:40,882][func.train][INFO] - Creating model with {'one': 7} classes
[2024-06-14 13:57:02,815][func.train][INFO] - Dist info:
[2024-06-14 13:57:02,816][func.train][INFO] - torch version: 2.2.2+cu121
[2024-06-14 13:57:02,817][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-06-14 13:57:02,817][func.train][INFO] - hydra version: 1.3.2
[2024-06-14 13:57:02,822][func.train][INFO] - Loading data
[2024-06-14 13:57:02,823][func.train][INFO] - Loading datasets
[2024-06-14 13:57:03,412][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe in 0m 1s
[2024-06-14 13:57:03,413][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe: (83243, 4)
[2024-06-14 13:57:03,423][func.train][INFO] - [SELECT DATASET] labels are already starting from 0
[2024-06-14 13:57:03,439][func.train][INFO] - [SELECT DATASET] ALL unique classes: [0 1 2 3 4 5 6]
[2024-06-14 13:57:03,451][func.train][INFO] - [SELECT DATASET] aLL dataframe (head):                                           image_path  video_idx frame_idx class
0  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         1     1
1  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         2     1
2  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         3     1
3  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         4     1
4  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         5     1
[2024-06-14 13:57:03,464][func.train][INFO] - [SELECT DATASET] ALL dataframe (tail):                                               image_path  ...  class
83238  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83239  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83240  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83241  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83242  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6

[5 rows x 4 columns]
[2024-06-14 13:57:03,466][func.train][INFO] - [DATASET] params: {'debug': False, 'dataset_name': 'autolaparo21', 'reduc_feats_folder': 'train_targets_x_mp/', 'num_classes': 7, 'num_next_labels': 6, 'last_seg_class': 7, 'predict_next_phase': True, 'get_target_feats': False, 'replace_current_with_next_class': False}
[2024-06-14 13:57:03,539][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:57:03,540][func.train][INFO] - [DATASET] split: train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 13:57:03,571][func.train][INFO] - [DATASET] train size: 55183
[2024-06-14 13:57:03,571][func.train][INFO] - [DATASET] train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 13:57:03,577][func.train][INFO] - [DATASET] Sampling video_idx: 1 at 1 fps to 6388 frames
[2024-06-14 13:57:03,584][func.train][INFO] - [DATASET] video 1 label_list: torch.Size([6388])
[2024-06-14 13:57:04,096][func.train][INFO] - [DATASET] Sampling video_idx: 2 at 1 fps to 3620 frames
[2024-06-14 13:57:04,099][func.train][INFO] - [DATASET] video 2 label_list: torch.Size([3620])
[2024-06-14 13:57:04,125][func.train][INFO] - [DATASET] Sampling video_idx: 3 at 1 fps to 3000 frames
[2024-06-14 13:57:04,127][func.train][INFO] - [DATASET] video 3 label_list: torch.Size([3000])
[2024-06-14 13:57:04,144][func.train][INFO] - [DATASET] Sampling video_idx: 4 at 1 fps to 2938 frames
[2024-06-14 13:57:04,145][func.train][INFO] - [DATASET] video 4 label_list: torch.Size([2938])
[2024-06-14 13:57:04,161][func.train][INFO] - [DATASET] Sampling video_idx: 5 at 1 fps to 3220 frames
[2024-06-14 13:57:04,163][func.train][INFO] - [DATASET] video 5 label_list: torch.Size([3220])
[2024-06-14 13:57:04,182][func.train][INFO] - [DATASET] Sampling video_idx: 6 at 1 fps to 3908 frames
[2024-06-14 13:57:04,184][func.train][INFO] - [DATASET] video 6 label_list: torch.Size([3908])
[2024-06-14 13:57:04,206][func.train][INFO] - [DATASET] Sampling video_idx: 7 at 1 fps to 1645 frames
[2024-06-14 13:57:04,208][func.train][INFO] - [DATASET] video 7 label_list: torch.Size([1645])
[2024-06-14 13:57:04,220][func.train][INFO] - [DATASET] Sampling video_idx: 8 at 1 fps to 4692 frames
[2024-06-14 13:57:04,222][func.train][INFO] - [DATASET] video 8 label_list: torch.Size([4692])
[2024-06-14 13:57:04,248][func.train][INFO] - [DATASET] Sampling video_idx: 9 at 1 fps to 5736 frames
[2024-06-14 13:57:04,250][func.train][INFO] - [DATASET] video 9 label_list: torch.Size([5736])
[2024-06-14 13:57:04,282][func.train][INFO] - [DATASET] Sampling video_idx: 10 at 1 fps to 5064 frames
[2024-06-14 13:57:04,284][func.train][INFO] - [DATASET] video 10 label_list: torch.Size([5064])
[2024-06-14 13:57:04,314][func.train][INFO] - [DATASET] Sampling video_idx: 11 at 1 fps to 4720 frames
[2024-06-14 13:57:04,316][func.train][INFO] - [DATASET] video 11 label_list: torch.Size([4720])
[2024-06-14 13:57:04,341][func.train][INFO] - [DATASET] Sampling video_idx: 12 at 1 fps to 2916 frames
[2024-06-14 13:57:04,343][func.train][INFO] - [DATASET] video 12 label_list: torch.Size([2916])
[2024-06-14 13:57:04,375][func.train][INFO] - [DATASET] Sampling video_idx: 13 at 1 fps to 2597 frames
[2024-06-14 13:57:04,377][func.train][INFO] - [DATASET] video 13 label_list: torch.Size([2597])
[2024-06-14 13:57:04,396][func.train][INFO] - [DATASET] Sampling video_idx: 14 at 1 fps to 4739 frames
[2024-06-14 13:57:04,399][func.train][INFO] - [DATASET] video 14 label_list: torch.Size([4739])
[2024-06-14 13:57:04,421][func.train][INFO] - [DATASET] number of train videos: 14
[2024-06-14 13:57:04,422][func.train][INFO] - [DATASET] avg video length: 65.69 minutes
[2024-06-14 13:57:04,482][func.train][INFO] - [DATASET] num classes at 1fps in train: (55183,)
[2024-06-14 13:57:04,484][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915}
[2024-06-14 13:57:04,488][func.train][INFO] - [DATASET] curr_class_weights: tensor([5.5989, 0.4087, 0.6284, 1.0496, 5.9139, 0.9633, 1.6039])
[2024-06-14 13:57:04,489][func.train][INFO] - [DATASET] eos_weight: count
[2024-06-14 13:57:04,489][func.train][INFO] - [DATASET] num_eos_vals: 840
[2024-06-14 13:57:04,489][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915, 7: 840}
[2024-06-14 13:57:04,491][func.train][INFO] - [DATASET] next_class_weights: tensor([4.9736, 0.3631, 0.5582, 0.9323, 5.2535, 0.8557, 1.4248, 8.3368])
[2024-06-14 13:57:04,634][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:57:04,635][func.train][INFO] - [DATASET] split: test video_indices: [15]
[2024-06-14 13:57:04,641][func.train][INFO] - [DATASET] test size: 3653
[2024-06-14 13:57:04,641][func.train][INFO] - [DATASET] test video_indices: [15]
[2024-06-14 13:57:04,645][func.train][INFO] - [DATASET] Sampling video_idx: 15 at 1 fps to 3653 frames
[2024-06-14 13:57:04,647][func.train][INFO] - [DATASET] video 15 label_list: torch.Size([3653])
[2024-06-14 13:57:04,664][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:57:04,665][func.train][INFO] - [DATASET] avg video length: 60.88 minutes
[2024-06-14 13:57:04,775][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:57:04,776][func.train][INFO] - [DATASET] split: test video_indices: [16]
[2024-06-14 13:57:04,782][func.train][INFO] - [DATASET] test size: 3612
[2024-06-14 13:57:04,783][func.train][INFO] - [DATASET] test video_indices: [16]
[2024-06-14 13:57:04,786][func.train][INFO] - [DATASET] Sampling video_idx: 16 at 1 fps to 3612 frames
[2024-06-14 13:57:04,788][func.train][INFO] - [DATASET] video 16 label_list: torch.Size([3612])
[2024-06-14 13:57:04,805][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:57:04,806][func.train][INFO] - [DATASET] avg video length: 60.20 minutes
[2024-06-14 13:57:04,938][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:57:04,939][func.train][INFO] - [DATASET] split: test video_indices: [17]
[2024-06-14 13:57:04,945][func.train][INFO] - [DATASET] test size: 4678
[2024-06-14 13:57:04,945][func.train][INFO] - [DATASET] test video_indices: [17]
[2024-06-14 13:57:04,949][func.train][INFO] - [DATASET] Sampling video_idx: 17 at 1 fps to 4678 frames
[2024-06-14 13:57:04,951][func.train][INFO] - [DATASET] video 17 label_list: torch.Size([4678])
[2024-06-14 13:57:04,972][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:57:04,973][func.train][INFO] - [DATASET] avg video length: 77.97 minutes
[2024-06-14 13:57:05,071][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:57:05,072][func.train][INFO] - [DATASET] split: test video_indices: [18]
[2024-06-14 13:57:05,078][func.train][INFO] - [DATASET] test size: 3546
[2024-06-14 13:57:05,079][func.train][INFO] - [DATASET] test video_indices: [18]
[2024-06-14 13:57:05,083][func.train][INFO] - [DATASET] Sampling video_idx: 18 at 1 fps to 3546 frames
[2024-06-14 13:57:05,085][func.train][INFO] - [DATASET] video 18 label_list: torch.Size([3546])
[2024-06-14 13:57:05,104][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:57:05,105][func.train][INFO] - [DATASET] avg video length: 59.10 minutes
[2024-06-14 13:57:05,196][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:57:05,197][func.train][INFO] - [DATASET] split: test video_indices: [19]
[2024-06-14 13:57:05,203][func.train][INFO] - [DATASET] test size: 3413
[2024-06-14 13:57:05,203][func.train][INFO] - [DATASET] test video_indices: [19]
[2024-06-14 13:57:05,208][func.train][INFO] - [DATASET] Sampling video_idx: 19 at 1 fps to 3413 frames
[2024-06-14 13:57:05,209][func.train][INFO] - [DATASET] video 19 label_list: torch.Size([3413])
[2024-06-14 13:57:05,226][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:57:05,227][func.train][INFO] - [DATASET] avg video length: 56.88 minutes
[2024-06-14 13:57:05,345][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:57:05,345][func.train][INFO] - [DATASET] split: test video_indices: [20]
[2024-06-14 13:57:05,351][func.train][INFO] - [DATASET] test size: 4832
[2024-06-14 13:57:05,351][func.train][INFO] - [DATASET] test video_indices: [20]
[2024-06-14 13:57:05,355][func.train][INFO] - [DATASET] Sampling video_idx: 20 at 1 fps to 4832 frames
[2024-06-14 13:57:05,357][func.train][INFO] - [DATASET] video 20 label_list: torch.Size([4832])
[2024-06-14 13:57:05,390][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:57:05,391][func.train][INFO] - [DATASET] avg video length: 80.53 minutes
[2024-06-14 13:57:05,482][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:57:05,483][func.train][INFO] - [DATASET] split: test video_indices: [21]
[2024-06-14 13:57:05,490][func.train][INFO] - [DATASET] test size: 4326
[2024-06-14 13:57:05,491][func.train][INFO] - [DATASET] test video_indices: [21]
[2024-06-14 13:57:05,498][func.train][INFO] - [DATASET] Sampling video_idx: 21 at 1 fps to 4326 frames
[2024-06-14 13:57:05,500][func.train][INFO] - [DATASET] video 21 label_list: torch.Size([4326])
[2024-06-14 13:57:05,523][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:57:05,523][func.train][INFO] - [DATASET] avg video length: 72.10 minutes
[2024-06-14 13:57:05,544][func.train][INFO] - Time to load datasets: 0.05 min
[2024-06-14 13:57:05,544][func.train][INFO] - Creating data loaders
[2024-06-14 13:57:05,547][func.train][INFO] - Creating model with {'one': 7} classes
[2024-06-14 13:57:07,644][func.train][INFO] - [MAIN] Number of tokens: 55183
[2024-06-14 13:57:07,644][func.train][INFO] - [MAIN] Number of parameters: 17171926
[2024-06-14 13:57:07,645][func.train][INFO] - [MAIN] Token-to-Parameter Ratio is ideally between [1:1 to 10:1]: 0.003214
[2024-06-14 13:57:07,645][func.train][WARNING] - [MAIN] Data-to-Parameter-Ratio is outside the interval [1:1 to 10:1]
[2024-06-14 13:57:07,648][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-06-14 13:57:07,648][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-06-14 13:57:08,351][func.train][WARNING] - Loaded model from checkpoint_best.pth (ep 0.000000)
[2024-06-14 13:57:08,353][func.train][INFO] - Wrapping model into DP
[2024-06-14 13:57:08,622][func.train][INFO] - Starting test_only
[2024-06-14 13:57:08,629][func.train][INFO] - [EVAL] Epoch: 1 | Anticipation time (s): 60 | Max anticipation time (m): 18 | Step size (m): 1 | Max auto-reg. steps: 18
[2024-06-14 13:57:08,629][func.train][INFO] - [EVAL] X-axis values: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
[2024-06-14 13:58:28,113][func.train][INFO] - Dist info:
[2024-06-14 13:58:28,114][func.train][INFO] - torch version: 2.2.2+cu121
[2024-06-14 13:58:28,115][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-06-14 13:58:28,115][func.train][INFO] - hydra version: 1.3.2
[2024-06-14 13:58:28,120][func.train][INFO] - Loading data
[2024-06-14 13:58:28,121][func.train][INFO] - Loading datasets
[2024-06-14 13:58:28,651][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe in 0m 1s
[2024-06-14 13:58:28,652][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe: (83243, 4)
[2024-06-14 13:58:28,662][func.train][INFO] - [SELECT DATASET] labels are already starting from 0
[2024-06-14 13:58:28,677][func.train][INFO] - [SELECT DATASET] ALL unique classes: [0 1 2 3 4 5 6]
[2024-06-14 13:58:28,689][func.train][INFO] - [SELECT DATASET] aLL dataframe (head):                                           image_path  video_idx frame_idx class
0  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         1     1
1  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         2     1
2  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         3     1
3  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         4     1
4  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         5     1
[2024-06-14 13:58:28,699][func.train][INFO] - [SELECT DATASET] ALL dataframe (tail):                                               image_path  ...  class
83238  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83239  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83240  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83241  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83242  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6

[5 rows x 4 columns]
[2024-06-14 13:58:28,700][func.train][INFO] - [DATASET] params: {'debug': False, 'dataset_name': 'autolaparo21', 'reduc_feats_folder': 'train_targets_x_mp/', 'num_classes': 7, 'num_next_labels': 6, 'last_seg_class': 7, 'predict_next_phase': True, 'get_target_feats': False, 'replace_current_with_next_class': False}
[2024-06-14 13:58:28,769][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:58:28,769][func.train][INFO] - [DATASET] split: train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 13:58:28,798][func.train][INFO] - [DATASET] train size: 55183
[2024-06-14 13:58:28,798][func.train][INFO] - [DATASET] train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 13:58:28,802][func.train][INFO] - [DATASET] Sampling video_idx: 1 at 1 fps to 6388 frames
[2024-06-14 13:58:28,807][func.train][INFO] - [DATASET] video 1 label_list: torch.Size([6388])
[2024-06-14 13:58:29,246][func.train][INFO] - [DATASET] Sampling video_idx: 2 at 1 fps to 3620 frames
[2024-06-14 13:58:29,248][func.train][INFO] - [DATASET] video 2 label_list: torch.Size([3620])
[2024-06-14 13:58:29,273][func.train][INFO] - [DATASET] Sampling video_idx: 3 at 1 fps to 3000 frames
[2024-06-14 13:58:29,274][func.train][INFO] - [DATASET] video 3 label_list: torch.Size([3000])
[2024-06-14 13:58:29,290][func.train][INFO] - [DATASET] Sampling video_idx: 4 at 1 fps to 2938 frames
[2024-06-14 13:58:29,292][func.train][INFO] - [DATASET] video 4 label_list: torch.Size([2938])
[2024-06-14 13:58:29,307][func.train][INFO] - [DATASET] Sampling video_idx: 5 at 1 fps to 3220 frames
[2024-06-14 13:58:29,309][func.train][INFO] - [DATASET] video 5 label_list: torch.Size([3220])
[2024-06-14 13:58:29,326][func.train][INFO] - [DATASET] Sampling video_idx: 6 at 1 fps to 3908 frames
[2024-06-14 13:58:29,328][func.train][INFO] - [DATASET] video 6 label_list: torch.Size([3908])
[2024-06-14 13:58:29,347][func.train][INFO] - [DATASET] Sampling video_idx: 7 at 1 fps to 1645 frames
[2024-06-14 13:58:29,348][func.train][INFO] - [DATASET] video 7 label_list: torch.Size([1645])
[2024-06-14 13:58:29,360][func.train][INFO] - [DATASET] Sampling video_idx: 8 at 1 fps to 4692 frames
[2024-06-14 13:58:29,362][func.train][INFO] - [DATASET] video 8 label_list: torch.Size([4692])
[2024-06-14 13:58:29,384][func.train][INFO] - [DATASET] Sampling video_idx: 9 at 1 fps to 5736 frames
[2024-06-14 13:58:29,386][func.train][INFO] - [DATASET] video 9 label_list: torch.Size([5736])
[2024-06-14 13:58:29,414][func.train][INFO] - [DATASET] Sampling video_idx: 10 at 1 fps to 5064 frames
[2024-06-14 13:58:29,416][func.train][INFO] - [DATASET] video 10 label_list: torch.Size([5064])
[2024-06-14 13:58:29,440][func.train][INFO] - [DATASET] Sampling video_idx: 11 at 1 fps to 4720 frames
[2024-06-14 13:58:29,442][func.train][INFO] - [DATASET] video 11 label_list: torch.Size([4720])
[2024-06-14 13:58:29,466][func.train][INFO] - [DATASET] Sampling video_idx: 12 at 1 fps to 2916 frames
[2024-06-14 13:58:29,468][func.train][INFO] - [DATASET] video 12 label_list: torch.Size([2916])
[2024-06-14 13:58:29,494][func.train][INFO] - [DATASET] Sampling video_idx: 13 at 1 fps to 2597 frames
[2024-06-14 13:58:29,496][func.train][INFO] - [DATASET] video 13 label_list: torch.Size([2597])
[2024-06-14 13:58:29,511][func.train][INFO] - [DATASET] Sampling video_idx: 14 at 1 fps to 4739 frames
[2024-06-14 13:58:29,513][func.train][INFO] - [DATASET] video 14 label_list: torch.Size([4739])
[2024-06-14 13:58:29,534][func.train][INFO] - [DATASET] number of train videos: 14
[2024-06-14 13:58:29,534][func.train][INFO] - [DATASET] avg video length: 65.69 minutes
[2024-06-14 13:58:29,611][func.train][INFO] - [DATASET] num classes at 1fps in train: (55183,)
[2024-06-14 13:58:29,613][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915}
[2024-06-14 13:58:29,616][func.train][INFO] - [DATASET] curr_class_weights: tensor([5.5989, 0.4087, 0.6284, 1.0496, 5.9139, 0.9633, 1.6039])
[2024-06-14 13:58:29,616][func.train][INFO] - [DATASET] eos_weight: count
[2024-06-14 13:58:29,616][func.train][INFO] - [DATASET] num_eos_vals: 840
[2024-06-14 13:58:29,617][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915, 7: 840}
[2024-06-14 13:58:29,618][func.train][INFO] - [DATASET] next_class_weights: tensor([4.9736, 0.3631, 0.5582, 0.9323, 5.2535, 0.8557, 1.4248, 8.3368])
[2024-06-14 13:58:29,759][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:58:29,759][func.train][INFO] - [DATASET] split: test video_indices: [15]
[2024-06-14 13:58:29,765][func.train][INFO] - [DATASET] test size: 3653
[2024-06-14 13:58:29,766][func.train][INFO] - [DATASET] test video_indices: [15]
[2024-06-14 13:58:29,770][func.train][INFO] - [DATASET] Sampling video_idx: 15 at 1 fps to 3653 frames
[2024-06-14 13:58:29,772][func.train][INFO] - [DATASET] video 15 label_list: torch.Size([3653])
[2024-06-14 13:58:29,791][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:58:29,791][func.train][INFO] - [DATASET] avg video length: 60.88 minutes
[2024-06-14 13:58:29,882][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:58:29,883][func.train][INFO] - [DATASET] split: test video_indices: [16]
[2024-06-14 13:58:29,889][func.train][INFO] - [DATASET] test size: 3612
[2024-06-14 13:58:29,889][func.train][INFO] - [DATASET] test video_indices: [16]
[2024-06-14 13:58:29,894][func.train][INFO] - [DATASET] Sampling video_idx: 16 at 1 fps to 3612 frames
[2024-06-14 13:58:29,896][func.train][INFO] - [DATASET] video 16 label_list: torch.Size([3612])
[2024-06-14 13:58:29,915][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:58:29,916][func.train][INFO] - [DATASET] avg video length: 60.20 minutes
[2024-06-14 13:58:30,030][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:58:30,031][func.train][INFO] - [DATASET] split: test video_indices: [17]
[2024-06-14 13:58:30,039][func.train][INFO] - [DATASET] test size: 4678
[2024-06-14 13:58:30,040][func.train][INFO] - [DATASET] test video_indices: [17]
[2024-06-14 13:58:30,047][func.train][INFO] - [DATASET] Sampling video_idx: 17 at 1 fps to 4678 frames
[2024-06-14 13:58:30,050][func.train][INFO] - [DATASET] video 17 label_list: torch.Size([4678])
[2024-06-14 13:58:30,084][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:58:30,085][func.train][INFO] - [DATASET] avg video length: 77.97 minutes
[2024-06-14 13:58:30,164][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:58:30,165][func.train][INFO] - [DATASET] split: test video_indices: [18]
[2024-06-14 13:58:30,169][func.train][INFO] - [DATASET] test size: 3546
[2024-06-14 13:58:30,170][func.train][INFO] - [DATASET] test video_indices: [18]
[2024-06-14 13:58:30,173][func.train][INFO] - [DATASET] Sampling video_idx: 18 at 1 fps to 3546 frames
[2024-06-14 13:58:30,174][func.train][INFO] - [DATASET] video 18 label_list: torch.Size([3546])
[2024-06-14 13:58:30,189][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:58:30,190][func.train][INFO] - [DATASET] avg video length: 59.10 minutes
[2024-06-14 13:58:30,271][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:58:30,272][func.train][INFO] - [DATASET] split: test video_indices: [19]
[2024-06-14 13:58:30,277][func.train][INFO] - [DATASET] test size: 3413
[2024-06-14 13:58:30,277][func.train][INFO] - [DATASET] test video_indices: [19]
[2024-06-14 13:58:30,281][func.train][INFO] - [DATASET] Sampling video_idx: 19 at 1 fps to 3413 frames
[2024-06-14 13:58:30,283][func.train][INFO] - [DATASET] video 19 label_list: torch.Size([3413])
[2024-06-14 13:58:30,301][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:58:30,302][func.train][INFO] - [DATASET] avg video length: 56.88 minutes
[2024-06-14 13:58:30,385][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:58:30,386][func.train][INFO] - [DATASET] split: test video_indices: [20]
[2024-06-14 13:58:30,391][func.train][INFO] - [DATASET] test size: 4832
[2024-06-14 13:58:30,392][func.train][INFO] - [DATASET] test video_indices: [20]
[2024-06-14 13:58:30,396][func.train][INFO] - [DATASET] Sampling video_idx: 20 at 1 fps to 4832 frames
[2024-06-14 13:58:30,399][func.train][INFO] - [DATASET] video 20 label_list: torch.Size([4832])
[2024-06-14 13:58:30,423][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:58:30,424][func.train][INFO] - [DATASET] avg video length: 80.53 minutes
[2024-06-14 13:58:30,516][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 13:58:30,517][func.train][INFO] - [DATASET] split: test video_indices: [21]
[2024-06-14 13:58:30,522][func.train][INFO] - [DATASET] test size: 4326
[2024-06-14 13:58:30,522][func.train][INFO] - [DATASET] test video_indices: [21]
[2024-06-14 13:58:30,526][func.train][INFO] - [DATASET] Sampling video_idx: 21 at 1 fps to 4326 frames
[2024-06-14 13:58:30,528][func.train][INFO] - [DATASET] video 21 label_list: torch.Size([4326])
[2024-06-14 13:58:30,546][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 13:58:30,547][func.train][INFO] - [DATASET] avg video length: 72.10 minutes
[2024-06-14 13:58:30,563][func.train][INFO] - Time to load datasets: 0.04 min
[2024-06-14 13:58:30,564][func.train][INFO] - Creating data loaders
[2024-06-14 13:58:30,566][func.train][INFO] - Creating model with {'one': 7} classes
[2024-06-14 13:58:32,371][func.train][INFO] - [MAIN] Number of tokens: 55183
[2024-06-14 13:58:32,372][func.train][INFO] - [MAIN] Number of parameters: 17171926
[2024-06-14 13:58:32,372][func.train][INFO] - [MAIN] Token-to-Parameter Ratio is ideally between [1:1 to 10:1]: 0.003214
[2024-06-14 13:58:32,373][func.train][WARNING] - [MAIN] Data-to-Parameter-Ratio is outside the interval [1:1 to 10:1]
[2024-06-14 13:58:32,375][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-06-14 13:58:32,376][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-06-14 13:58:32,604][func.train][WARNING] - Loaded model from checkpoint_best.pth (ep 0.000000)
[2024-06-14 13:58:32,604][func.train][INFO] - Wrapping model into DP
[2024-06-14 13:58:32,826][func.train][INFO] - Starting test_only
[2024-06-14 13:58:32,831][func.train][INFO] - [EVAL] Epoch: 1 | Anticipation time (s): 60 | Max anticipation time (m): 18 | Step size (m): 1 | Max auto-reg. steps: 18
[2024-06-14 13:58:32,832][func.train][INFO] - [EVAL] X-axis values: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
[2024-06-14 14:10:50,211][func.train][INFO] - Dist info:
[2024-06-14 14:10:50,212][func.train][INFO] - torch version: 2.2.2+cu121
[2024-06-14 14:10:50,213][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-06-14 14:10:50,213][func.train][INFO] - hydra version: 1.3.2
[2024-06-14 14:10:50,222][func.train][INFO] - Loading data
[2024-06-14 14:10:50,223][func.train][INFO] - Loading datasets
[2024-06-14 14:10:50,798][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe in 0m 1s
[2024-06-14 14:10:50,798][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe: (83243, 4)
[2024-06-14 14:10:50,808][func.train][INFO] - [SELECT DATASET] labels are already starting from 0
[2024-06-14 14:10:50,822][func.train][INFO] - [SELECT DATASET] ALL unique classes: [0 1 2 3 4 5 6]
[2024-06-14 14:10:50,834][func.train][INFO] - [SELECT DATASET] aLL dataframe (head):                                           image_path  video_idx frame_idx class
0  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         1     1
1  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         2     1
2  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         3     1
3  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         4     1
4  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         5     1
[2024-06-14 14:10:50,847][func.train][INFO] - [SELECT DATASET] ALL dataframe (tail):                                               image_path  ...  class
83238  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83239  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83240  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83241  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83242  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6

[5 rows x 4 columns]
[2024-06-14 14:10:50,849][func.train][INFO] - [DATASET] params: {'debug': False, 'dataset_name': 'autolaparo21', 'reduc_feats_folder': 'train_targets_x_mp/', 'num_classes': 7, 'num_next_labels': 6, 'last_seg_class': 7, 'predict_next_phase': True, 'get_target_feats': False, 'replace_current_with_next_class': False}
[2024-06-14 14:10:50,918][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 14:10:50,919][func.train][INFO] - [DATASET] split: train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 14:10:50,953][func.train][INFO] - [DATASET] train size: 55183
[2024-06-14 14:10:50,953][func.train][INFO] - [DATASET] train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 14:10:50,957][func.train][INFO] - [DATASET] Sampling video_idx: 1 at 1 fps to 6388 frames
[2024-06-14 14:10:50,963][func.train][INFO] - [DATASET] video 1 label_list: torch.Size([6388])
[2024-06-14 14:10:51,521][func.train][INFO] - [DATASET] Sampling video_idx: 2 at 1 fps to 3620 frames
[2024-06-14 14:10:51,523][func.train][INFO] - [DATASET] video 2 label_list: torch.Size([3620])
[2024-06-14 14:10:51,576][func.train][INFO] - [DATASET] Sampling video_idx: 3 at 1 fps to 3000 frames
[2024-06-14 14:10:51,578][func.train][INFO] - [DATASET] video 3 label_list: torch.Size([3000])
[2024-06-14 14:10:51,597][func.train][INFO] - [DATASET] Sampling video_idx: 4 at 1 fps to 2938 frames
[2024-06-14 14:10:51,599][func.train][INFO] - [DATASET] video 4 label_list: torch.Size([2938])
[2024-06-14 14:10:51,614][func.train][INFO] - [DATASET] Sampling video_idx: 5 at 1 fps to 3220 frames
[2024-06-14 14:10:51,616][func.train][INFO] - [DATASET] video 5 label_list: torch.Size([3220])
[2024-06-14 14:10:51,687][func.train][INFO] - [DATASET] Sampling video_idx: 6 at 1 fps to 3908 frames
[2024-06-14 14:10:51,689][func.train][INFO] - [DATASET] video 6 label_list: torch.Size([3908])
[2024-06-14 14:10:51,761][func.train][INFO] - [DATASET] Sampling video_idx: 7 at 1 fps to 1645 frames
[2024-06-14 14:10:51,763][func.train][INFO] - [DATASET] video 7 label_list: torch.Size([1645])
[2024-06-14 14:10:51,797][func.train][INFO] - [DATASET] Sampling video_idx: 8 at 1 fps to 4692 frames
[2024-06-14 14:10:51,799][func.train][INFO] - [DATASET] video 8 label_list: torch.Size([4692])
[2024-06-14 14:10:51,867][func.train][INFO] - [DATASET] Sampling video_idx: 9 at 1 fps to 5736 frames
[2024-06-14 14:10:51,870][func.train][INFO] - [DATASET] video 9 label_list: torch.Size([5736])
[2024-06-14 14:10:51,967][func.train][INFO] - [DATASET] Sampling video_idx: 10 at 1 fps to 5064 frames
[2024-06-14 14:10:51,969][func.train][INFO] - [DATASET] video 10 label_list: torch.Size([5064])
[2024-06-14 14:10:52,062][func.train][INFO] - [DATASET] Sampling video_idx: 11 at 1 fps to 4720 frames
[2024-06-14 14:10:52,064][func.train][INFO] - [DATASET] video 11 label_list: torch.Size([4720])
[2024-06-14 14:10:52,086][func.train][INFO] - [DATASET] Sampling video_idx: 12 at 1 fps to 2916 frames
[2024-06-14 14:10:52,089][func.train][INFO] - [DATASET] video 12 label_list: torch.Size([2916])
[2024-06-14 14:10:52,113][func.train][INFO] - [DATASET] Sampling video_idx: 13 at 1 fps to 2597 frames
[2024-06-14 14:10:52,115][func.train][INFO] - [DATASET] video 13 label_list: torch.Size([2597])
[2024-06-14 14:10:52,136][func.train][INFO] - [DATASET] Sampling video_idx: 14 at 1 fps to 4739 frames
[2024-06-14 14:10:52,138][func.train][INFO] - [DATASET] video 14 label_list: torch.Size([4739])
[2024-06-14 14:10:52,158][func.train][INFO] - [DATASET] number of train videos: 14
[2024-06-14 14:10:52,159][func.train][INFO] - [DATASET] avg video length: 65.69 minutes
[2024-06-14 14:10:52,253][func.train][INFO] - [DATASET] num classes at 1fps in train: (55183,)
[2024-06-14 14:10:52,255][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915}
[2024-06-14 14:10:52,258][func.train][INFO] - [DATASET] curr_class_weights: tensor([5.5989, 0.4087, 0.6284, 1.0496, 5.9139, 0.9633, 1.6039])
[2024-06-14 14:10:52,259][func.train][INFO] - [DATASET] eos_weight: count
[2024-06-14 14:10:52,259][func.train][INFO] - [DATASET] num_eos_vals: 840
[2024-06-14 14:10:52,259][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915, 7: 840}
[2024-06-14 14:10:52,263][func.train][INFO] - [DATASET] next_class_weights: tensor([4.9736, 0.3631, 0.5582, 0.9323, 5.2535, 0.8557, 1.4248, 8.3368])
[2024-06-14 14:10:52,400][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 14:10:52,400][func.train][INFO] - [DATASET] split: test video_indices: [15]
[2024-06-14 14:10:52,406][func.train][INFO] - [DATASET] test size: 3653
[2024-06-14 14:10:52,406][func.train][INFO] - [DATASET] test video_indices: [15]
[2024-06-14 14:10:52,409][func.train][INFO] - [DATASET] Sampling video_idx: 15 at 1 fps to 3653 frames
[2024-06-14 14:10:52,411][func.train][INFO] - [DATASET] video 15 label_list: torch.Size([3653])
[2024-06-14 14:10:52,429][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 14:10:52,429][func.train][INFO] - [DATASET] avg video length: 60.88 minutes
[2024-06-14 14:10:52,514][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 14:10:52,514][func.train][INFO] - [DATASET] split: test video_indices: [16]
[2024-06-14 14:10:52,518][func.train][INFO] - [DATASET] test size: 3612
[2024-06-14 14:10:52,518][func.train][INFO] - [DATASET] test video_indices: [16]
[2024-06-14 14:10:52,522][func.train][INFO] - [DATASET] Sampling video_idx: 16 at 1 fps to 3612 frames
[2024-06-14 14:10:52,524][func.train][INFO] - [DATASET] video 16 label_list: torch.Size([3612])
[2024-06-14 14:10:52,537][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 14:10:52,538][func.train][INFO] - [DATASET] avg video length: 60.20 minutes
[2024-06-14 14:10:52,629][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 14:10:52,629][func.train][INFO] - [DATASET] split: test video_indices: [17]
[2024-06-14 14:10:52,635][func.train][INFO] - [DATASET] test size: 4678
[2024-06-14 14:10:52,636][func.train][INFO] - [DATASET] test video_indices: [17]
[2024-06-14 14:10:52,642][func.train][INFO] - [DATASET] Sampling video_idx: 17 at 1 fps to 4678 frames
[2024-06-14 14:10:52,644][func.train][INFO] - [DATASET] video 17 label_list: torch.Size([4678])
[2024-06-14 14:10:52,668][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 14:10:52,669][func.train][INFO] - [DATASET] avg video length: 77.97 minutes
[2024-06-14 14:10:52,779][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 14:10:52,780][func.train][INFO] - [DATASET] split: test video_indices: [18]
[2024-06-14 14:10:52,789][func.train][INFO] - [DATASET] test size: 3546
[2024-06-14 14:10:52,790][func.train][INFO] - [DATASET] test video_indices: [18]
[2024-06-14 14:10:52,797][func.train][INFO] - [DATASET] Sampling video_idx: 18 at 1 fps to 3546 frames
[2024-06-14 14:10:52,799][func.train][INFO] - [DATASET] video 18 label_list: torch.Size([3546])
[2024-06-14 14:10:52,824][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 14:10:52,825][func.train][INFO] - [DATASET] avg video length: 59.10 minutes
[2024-06-14 14:10:52,895][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 14:10:52,895][func.train][INFO] - [DATASET] split: test video_indices: [19]
[2024-06-14 14:10:52,898][func.train][INFO] - [DATASET] test size: 3413
[2024-06-14 14:10:52,899][func.train][INFO] - [DATASET] test video_indices: [19]
[2024-06-14 14:10:52,902][func.train][INFO] - [DATASET] Sampling video_idx: 19 at 1 fps to 3413 frames
[2024-06-14 14:10:52,903][func.train][INFO] - [DATASET] video 19 label_list: torch.Size([3413])
[2024-06-14 14:10:52,917][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 14:10:52,917][func.train][INFO] - [DATASET] avg video length: 56.88 minutes
[2024-06-14 14:10:52,991][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 14:10:52,991][func.train][INFO] - [DATASET] split: test video_indices: [20]
[2024-06-14 14:10:52,997][func.train][INFO] - [DATASET] test size: 4832
[2024-06-14 14:10:52,997][func.train][INFO] - [DATASET] test video_indices: [20]
[2024-06-14 14:10:53,001][func.train][INFO] - [DATASET] Sampling video_idx: 20 at 1 fps to 4832 frames
[2024-06-14 14:10:53,003][func.train][INFO] - [DATASET] video 20 label_list: torch.Size([4832])
[2024-06-14 14:10:53,028][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 14:10:53,028][func.train][INFO] - [DATASET] avg video length: 80.53 minutes
[2024-06-14 14:10:53,123][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 14:10:53,124][func.train][INFO] - [DATASET] split: test video_indices: [21]
[2024-06-14 14:10:53,129][func.train][INFO] - [DATASET] test size: 4326
[2024-06-14 14:10:53,130][func.train][INFO] - [DATASET] test video_indices: [21]
[2024-06-14 14:10:53,134][func.train][INFO] - [DATASET] Sampling video_idx: 21 at 1 fps to 4326 frames
[2024-06-14 14:10:53,136][func.train][INFO] - [DATASET] video 21 label_list: torch.Size([4326])
[2024-06-14 14:10:53,154][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 14:10:53,155][func.train][INFO] - [DATASET] avg video length: 72.10 minutes
[2024-06-14 14:10:53,176][func.train][INFO] - Time to load datasets: 0.05 min
[2024-06-14 14:10:53,176][func.train][INFO] - Creating data loaders
[2024-06-14 14:10:53,179][func.train][INFO] - Creating model with {'one': 7} classes
[2024-06-14 14:10:55,072][func.train][INFO] - [MAIN] Number of tokens: 55183
[2024-06-14 14:10:55,073][func.train][INFO] - [MAIN] Number of parameters: 17171926
[2024-06-14 14:10:55,073][func.train][INFO] - [MAIN] Token-to-Parameter Ratio is ideally between [1:1 to 10:1]: 0.003214
[2024-06-14 14:10:55,074][func.train][WARNING] - [MAIN] Data-to-Parameter-Ratio is outside the interval [1:1 to 10:1]
[2024-06-14 14:10:55,077][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-06-14 14:10:55,077][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-06-14 14:10:55,546][func.train][WARNING] - Loaded model from checkpoint_best.pth (ep 0.000000)
[2024-06-14 14:10:55,547][func.train][INFO] - Wrapping model into DP
[2024-06-14 14:10:55,761][func.train][INFO] - Starting test_only
[2024-06-14 14:10:55,767][func.train][INFO] - [EVAL] Epoch: 1 | Anticipation time (s): 60 | Max anticipation time (m): 18 | Step size (m): 1 | Max auto-reg. steps: 18
[2024-06-14 14:10:55,767][func.train][INFO] - [EVAL] X-axis values: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
[2024-06-14 15:19:45,759][func.train][INFO] - Dist info:
[2024-06-14 15:19:45,760][func.train][INFO] - torch version: 2.2.2+cu121
[2024-06-14 15:19:45,761][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-06-14 15:19:45,761][func.train][INFO] - hydra version: 1.3.2
[2024-06-14 15:19:45,765][func.train][INFO] - Loading data
[2024-06-14 15:19:45,766][func.train][INFO] - Loading datasets
[2024-06-14 15:19:46,138][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe in 0m 0s
[2024-06-14 15:19:46,138][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe: (83243, 4)
[2024-06-14 15:19:46,145][func.train][INFO] - [SELECT DATASET] labels are already starting from 0
[2024-06-14 15:19:46,152][func.train][INFO] - [SELECT DATASET] ALL unique classes: [0 1 2 3 4 5 6]
[2024-06-14 15:19:46,158][func.train][INFO] - [SELECT DATASET] aLL dataframe (head):                                           image_path  video_idx frame_idx class
0  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         1     1
1  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         2     1
2  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         3     1
3  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         4     1
4  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         5     1
[2024-06-14 15:19:46,163][func.train][INFO] - [SELECT DATASET] ALL dataframe (tail):                                               image_path  ...  class
83238  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83239  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83240  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83241  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83242  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6

[5 rows x 4 columns]
[2024-06-14 15:19:46,164][func.train][INFO] - [DATASET] params: {'debug': False, 'dataset_name': 'autolaparo21', 'reduc_feats_folder': 'train_targets_x_mp/', 'num_classes': 7, 'num_next_labels': 6, 'last_seg_class': 7, 'predict_next_phase': True, 'get_target_feats': False, 'replace_current_with_next_class': False}
[2024-06-14 15:19:46,204][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:19:46,204][func.train][INFO] - [DATASET] split: train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 15:19:46,222][func.train][INFO] - [DATASET] train size: 55183
[2024-06-14 15:19:46,223][func.train][INFO] - [DATASET] train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 15:19:46,225][func.train][INFO] - [DATASET] Sampling video_idx: 1 at 1 fps to 6388 frames
[2024-06-14 15:19:46,229][func.train][INFO] - [DATASET] video 1 label_list: torch.Size([6388])
[2024-06-14 15:19:46,511][func.train][INFO] - [DATASET] Sampling video_idx: 2 at 1 fps to 3620 frames
[2024-06-14 15:19:46,512][func.train][INFO] - [DATASET] video 2 label_list: torch.Size([3620])
[2024-06-14 15:19:46,530][func.train][INFO] - [DATASET] Sampling video_idx: 3 at 1 fps to 3000 frames
[2024-06-14 15:19:46,531][func.train][INFO] - [DATASET] video 3 label_list: torch.Size([3000])
[2024-06-14 15:19:46,544][func.train][INFO] - [DATASET] Sampling video_idx: 4 at 1 fps to 2938 frames
[2024-06-14 15:19:46,545][func.train][INFO] - [DATASET] video 4 label_list: torch.Size([2938])
[2024-06-14 15:19:46,557][func.train][INFO] - [DATASET] Sampling video_idx: 5 at 1 fps to 3220 frames
[2024-06-14 15:19:46,558][func.train][INFO] - [DATASET] video 5 label_list: torch.Size([3220])
[2024-06-14 15:19:46,569][func.train][INFO] - [DATASET] Sampling video_idx: 6 at 1 fps to 3908 frames
[2024-06-14 15:19:46,570][func.train][INFO] - [DATASET] video 6 label_list: torch.Size([3908])
[2024-06-14 15:19:46,586][func.train][INFO] - [DATASET] Sampling video_idx: 7 at 1 fps to 1645 frames
[2024-06-14 15:19:46,587][func.train][INFO] - [DATASET] video 7 label_list: torch.Size([1645])
[2024-06-14 15:19:46,595][func.train][INFO] - [DATASET] Sampling video_idx: 8 at 1 fps to 4692 frames
[2024-06-14 15:19:46,596][func.train][INFO] - [DATASET] video 8 label_list: torch.Size([4692])
[2024-06-14 15:19:46,618][func.train][INFO] - [DATASET] Sampling video_idx: 9 at 1 fps to 5736 frames
[2024-06-14 15:19:46,620][func.train][INFO] - [DATASET] video 9 label_list: torch.Size([5736])
[2024-06-14 15:19:46,643][func.train][INFO] - [DATASET] Sampling video_idx: 10 at 1 fps to 5064 frames
[2024-06-14 15:19:46,644][func.train][INFO] - [DATASET] video 10 label_list: torch.Size([5064])
[2024-06-14 15:19:46,663][func.train][INFO] - [DATASET] Sampling video_idx: 11 at 1 fps to 4720 frames
[2024-06-14 15:19:46,665][func.train][INFO] - [DATASET] video 11 label_list: torch.Size([4720])
[2024-06-14 15:19:46,682][func.train][INFO] - [DATASET] Sampling video_idx: 12 at 1 fps to 2916 frames
[2024-06-14 15:19:46,683][func.train][INFO] - [DATASET] video 12 label_list: torch.Size([2916])
[2024-06-14 15:19:46,698][func.train][INFO] - [DATASET] Sampling video_idx: 13 at 1 fps to 2597 frames
[2024-06-14 15:19:46,699][func.train][INFO] - [DATASET] video 13 label_list: torch.Size([2597])
[2024-06-14 15:19:46,709][func.train][INFO] - [DATASET] Sampling video_idx: 14 at 1 fps to 4739 frames
[2024-06-14 15:19:46,710][func.train][INFO] - [DATASET] video 14 label_list: torch.Size([4739])
[2024-06-14 15:19:46,724][func.train][INFO] - [DATASET] number of train videos: 14
[2024-06-14 15:19:46,724][func.train][INFO] - [DATASET] avg video length: 65.69 minutes
[2024-06-14 15:19:46,786][func.train][INFO] - [DATASET] num classes at 1fps in train: (55183,)
[2024-06-14 15:19:46,788][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915}
[2024-06-14 15:19:46,790][func.train][INFO] - [DATASET] curr_class_weights: tensor([5.5989, 0.4087, 0.6284, 1.0496, 5.9139, 0.9633, 1.6039])
[2024-06-14 15:19:46,790][func.train][INFO] - [DATASET] eos_weight: count
[2024-06-14 15:19:46,791][func.train][INFO] - [DATASET] num_eos_vals: 840
[2024-06-14 15:19:46,791][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915, 7: 840}
[2024-06-14 15:19:46,792][func.train][INFO] - [DATASET] next_class_weights: tensor([4.9736, 0.3631, 0.5582, 0.9323, 5.2535, 0.8557, 1.4248, 8.3368])
[2024-06-14 15:19:46,865][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:19:46,866][func.train][INFO] - [DATASET] split: test video_indices: [15]
[2024-06-14 15:19:46,868][func.train][INFO] - [DATASET] test size: 3653
[2024-06-14 15:19:46,868][func.train][INFO] - [DATASET] test video_indices: [15]
[2024-06-14 15:19:46,870][func.train][INFO] - [DATASET] Sampling video_idx: 15 at 1 fps to 3653 frames
[2024-06-14 15:19:46,871][func.train][INFO] - [DATASET] video 15 label_list: torch.Size([3653])
[2024-06-14 15:19:46,890][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:19:46,890][func.train][INFO] - [DATASET] avg video length: 60.88 minutes
[2024-06-14 15:19:46,955][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:19:46,955][func.train][INFO] - [DATASET] split: test video_indices: [16]
[2024-06-14 15:19:46,957][func.train][INFO] - [DATASET] test size: 3612
[2024-06-14 15:19:46,957][func.train][INFO] - [DATASET] test video_indices: [16]
[2024-06-14 15:19:46,959][func.train][INFO] - [DATASET] Sampling video_idx: 16 at 1 fps to 3612 frames
[2024-06-14 15:19:46,960][func.train][INFO] - [DATASET] video 16 label_list: torch.Size([3612])
[2024-06-14 15:19:46,969][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:19:46,969][func.train][INFO] - [DATASET] avg video length: 60.20 minutes
[2024-06-14 15:19:47,040][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:19:47,040][func.train][INFO] - [DATASET] split: test video_indices: [17]
[2024-06-14 15:19:47,043][func.train][INFO] - [DATASET] test size: 4678
[2024-06-14 15:19:47,043][func.train][INFO] - [DATASET] test video_indices: [17]
[2024-06-14 15:19:47,045][func.train][INFO] - [DATASET] Sampling video_idx: 17 at 1 fps to 4678 frames
[2024-06-14 15:19:47,046][func.train][INFO] - [DATASET] video 17 label_list: torch.Size([4678])
[2024-06-14 15:19:47,061][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:19:47,062][func.train][INFO] - [DATASET] avg video length: 77.97 minutes
[2024-06-14 15:19:47,163][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:19:47,164][func.train][INFO] - [DATASET] split: test video_indices: [18]
[2024-06-14 15:19:47,169][func.train][INFO] - [DATASET] test size: 3546
[2024-06-14 15:19:47,169][func.train][INFO] - [DATASET] test video_indices: [18]
[2024-06-14 15:19:47,172][func.train][INFO] - [DATASET] Sampling video_idx: 18 at 1 fps to 3546 frames
[2024-06-14 15:19:47,173][func.train][INFO] - [DATASET] video 18 label_list: torch.Size([3546])
[2024-06-14 15:19:47,187][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:19:47,188][func.train][INFO] - [DATASET] avg video length: 59.10 minutes
[2024-06-14 15:19:47,250][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:19:47,250][func.train][INFO] - [DATASET] split: test video_indices: [19]
[2024-06-14 15:19:47,253][func.train][INFO] - [DATASET] test size: 3413
[2024-06-14 15:19:47,253][func.train][INFO] - [DATASET] test video_indices: [19]
[2024-06-14 15:19:47,254][func.train][INFO] - [DATASET] Sampling video_idx: 19 at 1 fps to 3413 frames
[2024-06-14 15:19:47,255][func.train][INFO] - [DATASET] video 19 label_list: torch.Size([3413])
[2024-06-14 15:19:47,266][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:19:47,266][func.train][INFO] - [DATASET] avg video length: 56.88 minutes
[2024-06-14 15:19:47,335][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:19:47,335][func.train][INFO] - [DATASET] split: test video_indices: [20]
[2024-06-14 15:19:47,338][func.train][INFO] - [DATASET] test size: 4832
[2024-06-14 15:19:47,338][func.train][INFO] - [DATASET] test video_indices: [20]
[2024-06-14 15:19:47,340][func.train][INFO] - [DATASET] Sampling video_idx: 20 at 1 fps to 4832 frames
[2024-06-14 15:19:47,341][func.train][INFO] - [DATASET] video 20 label_list: torch.Size([4832])
[2024-06-14 15:19:47,357][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:19:47,358][func.train][INFO] - [DATASET] avg video length: 80.53 minutes
[2024-06-14 15:19:47,430][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:19:47,430][func.train][INFO] - [DATASET] split: test video_indices: [21]
[2024-06-14 15:19:47,433][func.train][INFO] - [DATASET] test size: 4326
[2024-06-14 15:19:47,433][func.train][INFO] - [DATASET] test video_indices: [21]
[2024-06-14 15:19:47,435][func.train][INFO] - [DATASET] Sampling video_idx: 21 at 1 fps to 4326 frames
[2024-06-14 15:19:47,435][func.train][INFO] - [DATASET] video 21 label_list: torch.Size([4326])
[2024-06-14 15:19:47,449][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:19:47,449][func.train][INFO] - [DATASET] avg video length: 72.10 minutes
[2024-06-14 15:19:47,452][func.train][INFO] - Time to load datasets: 0.03 min
[2024-06-14 15:19:47,452][func.train][INFO] - Creating data loaders
[2024-06-14 15:19:47,454][func.train][INFO] - Creating model with {'one': 7} classes
[2024-06-14 15:19:48,831][func.train][INFO] - [MAIN] Number of tokens: 55183
[2024-06-14 15:19:48,832][func.train][INFO] - [MAIN] Number of parameters: 17171926
[2024-06-14 15:19:48,832][func.train][INFO] - [MAIN] Token-to-Parameter Ratio is ideally between [1:1 to 10:1]: 0.003214
[2024-06-14 15:19:48,832][func.train][WARNING] - [MAIN] Data-to-Parameter-Ratio is outside the interval [1:1 to 10:1]
[2024-06-14 15:19:48,834][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-06-14 15:19:48,834][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-06-14 15:19:49,323][func.train][WARNING] - Loaded model from checkpoint_best.pth (ep 0.000000)
[2024-06-14 15:19:49,324][func.train][INFO] - Wrapping model into DP
[2024-06-14 15:19:49,466][func.train][INFO] - Starting test_only
[2024-06-14 15:19:49,469][func.train][INFO] - [EVAL] Epoch: 1 | Anticipation time (s): 60 | Max anticipation time (m): 18 | Step size (m): 1 | Max auto-reg. steps: 18
[2024-06-14 15:19:49,470][func.train][INFO] - [EVAL] X-axis values: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
[2024-06-14 15:21:42,177][func.train][INFO] - Dist info:
[2024-06-14 15:21:42,178][func.train][INFO] - torch version: 2.2.2+cu121
[2024-06-14 15:21:42,179][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-06-14 15:21:42,179][func.train][INFO] - hydra version: 1.3.2
[2024-06-14 15:21:42,185][func.train][INFO] - Loading data
[2024-06-14 15:21:42,185][func.train][INFO] - Loading datasets
[2024-06-14 15:21:42,506][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe in 0m 0s
[2024-06-14 15:21:42,506][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe: (83243, 4)
[2024-06-14 15:21:42,511][func.train][INFO] - [SELECT DATASET] labels are already starting from 0
[2024-06-14 15:21:42,517][func.train][INFO] - [SELECT DATASET] ALL unique classes: [0 1 2 3 4 5 6]
[2024-06-14 15:21:42,523][func.train][INFO] - [SELECT DATASET] aLL dataframe (head):                                           image_path  video_idx frame_idx class
0  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         1     1
1  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         2     1
2  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         3     1
3  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         4     1
4  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         5     1
[2024-06-14 15:21:42,529][func.train][INFO] - [SELECT DATASET] ALL dataframe (tail):                                               image_path  ...  class
83238  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83239  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83240  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83241  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83242  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6

[5 rows x 4 columns]
[2024-06-14 15:21:42,529][func.train][INFO] - [DATASET] params: {'debug': False, 'dataset_name': 'autolaparo21', 'reduc_feats_folder': 'train_targets_x_mp/', 'num_classes': 7, 'num_next_labels': 6, 'last_seg_class': 7, 'predict_next_phase': True, 'get_target_feats': False, 'replace_current_with_next_class': False}
[2024-06-14 15:21:42,561][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:21:42,562][func.train][INFO] - [DATASET] split: train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 15:21:42,579][func.train][INFO] - [DATASET] train size: 55183
[2024-06-14 15:21:42,580][func.train][INFO] - [DATASET] train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 15:21:42,582][func.train][INFO] - [DATASET] Sampling video_idx: 1 at 1 fps to 6388 frames
[2024-06-14 15:21:42,587][func.train][INFO] - [DATASET] video 1 label_list: torch.Size([6388])
[2024-06-14 15:21:42,806][func.train][INFO] - [DATASET] Sampling video_idx: 2 at 1 fps to 3620 frames
[2024-06-14 15:21:42,808][func.train][INFO] - [DATASET] video 2 label_list: torch.Size([3620])
[2024-06-14 15:21:42,827][func.train][INFO] - [DATASET] Sampling video_idx: 3 at 1 fps to 3000 frames
[2024-06-14 15:21:42,828][func.train][INFO] - [DATASET] video 3 label_list: torch.Size([3000])
[2024-06-14 15:21:42,840][func.train][INFO] - [DATASET] Sampling video_idx: 4 at 1 fps to 2938 frames
[2024-06-14 15:21:42,841][func.train][INFO] - [DATASET] video 4 label_list: torch.Size([2938])
[2024-06-14 15:21:42,853][func.train][INFO] - [DATASET] Sampling video_idx: 5 at 1 fps to 3220 frames
[2024-06-14 15:21:42,854][func.train][INFO] - [DATASET] video 5 label_list: torch.Size([3220])
[2024-06-14 15:21:42,875][func.train][INFO] - [DATASET] Sampling video_idx: 6 at 1 fps to 3908 frames
[2024-06-14 15:21:42,877][func.train][INFO] - [DATASET] video 6 label_list: torch.Size([3908])
[2024-06-14 15:21:42,899][func.train][INFO] - [DATASET] Sampling video_idx: 7 at 1 fps to 1645 frames
[2024-06-14 15:21:42,901][func.train][INFO] - [DATASET] video 7 label_list: torch.Size([1645])
[2024-06-14 15:21:42,912][func.train][INFO] - [DATASET] Sampling video_idx: 8 at 1 fps to 4692 frames
[2024-06-14 15:21:42,914][func.train][INFO] - [DATASET] video 8 label_list: torch.Size([4692])
[2024-06-14 15:21:42,939][func.train][INFO] - [DATASET] Sampling video_idx: 9 at 1 fps to 5736 frames
[2024-06-14 15:21:42,941][func.train][INFO] - [DATASET] video 9 label_list: torch.Size([5736])
[2024-06-14 15:21:42,962][func.train][INFO] - [DATASET] Sampling video_idx: 10 at 1 fps to 5064 frames
[2024-06-14 15:21:42,963][func.train][INFO] - [DATASET] video 10 label_list: torch.Size([5064])
[2024-06-14 15:21:42,980][func.train][INFO] - [DATASET] Sampling video_idx: 11 at 1 fps to 4720 frames
[2024-06-14 15:21:42,982][func.train][INFO] - [DATASET] video 11 label_list: torch.Size([4720])
[2024-06-14 15:21:43,005][func.train][INFO] - [DATASET] Sampling video_idx: 12 at 1 fps to 2916 frames
[2024-06-14 15:21:43,007][func.train][INFO] - [DATASET] video 12 label_list: torch.Size([2916])
[2024-06-14 15:21:43,029][func.train][INFO] - [DATASET] Sampling video_idx: 13 at 1 fps to 2597 frames
[2024-06-14 15:21:43,030][func.train][INFO] - [DATASET] video 13 label_list: torch.Size([2597])
[2024-06-14 15:21:43,044][func.train][INFO] - [DATASET] Sampling video_idx: 14 at 1 fps to 4739 frames
[2024-06-14 15:21:43,045][func.train][INFO] - [DATASET] video 14 label_list: torch.Size([4739])
[2024-06-14 15:21:43,058][func.train][INFO] - [DATASET] number of train videos: 14
[2024-06-14 15:21:43,058][func.train][INFO] - [DATASET] avg video length: 65.69 minutes
[2024-06-14 15:21:43,129][func.train][INFO] - [DATASET] num classes at 1fps in train: (55183,)
[2024-06-14 15:21:43,131][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915}
[2024-06-14 15:21:43,133][func.train][INFO] - [DATASET] curr_class_weights: tensor([5.5989, 0.4087, 0.6284, 1.0496, 5.9139, 0.9633, 1.6039])
[2024-06-14 15:21:43,133][func.train][INFO] - [DATASET] eos_weight: count
[2024-06-14 15:21:43,134][func.train][INFO] - [DATASET] num_eos_vals: 840
[2024-06-14 15:21:43,134][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915, 7: 840}
[2024-06-14 15:21:43,135][func.train][INFO] - [DATASET] next_class_weights: tensor([4.9736, 0.3631, 0.5582, 0.9323, 5.2535, 0.8557, 1.4248, 8.3368])
[2024-06-14 15:21:43,220][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:21:43,220][func.train][INFO] - [DATASET] split: test video_indices: [15]
[2024-06-14 15:21:43,224][func.train][INFO] - [DATASET] test size: 3653
[2024-06-14 15:21:43,224][func.train][INFO] - [DATASET] test video_indices: [15]
[2024-06-14 15:21:43,226][func.train][INFO] - [DATASET] Sampling video_idx: 15 at 1 fps to 3653 frames
[2024-06-14 15:21:43,227][func.train][INFO] - [DATASET] video 15 label_list: torch.Size([3653])
[2024-06-14 15:21:43,250][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:21:43,250][func.train][INFO] - [DATASET] avg video length: 60.88 minutes
[2024-06-14 15:21:43,343][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:21:43,343][func.train][INFO] - [DATASET] split: test video_indices: [16]
[2024-06-14 15:21:43,348][func.train][INFO] - [DATASET] test size: 3612
[2024-06-14 15:21:43,348][func.train][INFO] - [DATASET] test video_indices: [16]
[2024-06-14 15:21:43,352][func.train][INFO] - [DATASET] Sampling video_idx: 16 at 1 fps to 3612 frames
[2024-06-14 15:21:43,353][func.train][INFO] - [DATASET] video 16 label_list: torch.Size([3612])
[2024-06-14 15:21:43,364][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:21:43,365][func.train][INFO] - [DATASET] avg video length: 60.20 minutes
[2024-06-14 15:21:43,428][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:21:43,428][func.train][INFO] - [DATASET] split: test video_indices: [17]
[2024-06-14 15:21:43,431][func.train][INFO] - [DATASET] test size: 4678
[2024-06-14 15:21:43,431][func.train][INFO] - [DATASET] test video_indices: [17]
[2024-06-14 15:21:43,433][func.train][INFO] - [DATASET] Sampling video_idx: 17 at 1 fps to 4678 frames
[2024-06-14 15:21:43,434][func.train][INFO] - [DATASET] video 17 label_list: torch.Size([4678])
[2024-06-14 15:21:43,449][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:21:43,449][func.train][INFO] - [DATASET] avg video length: 77.97 minutes
[2024-06-14 15:21:43,493][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:21:43,493][func.train][INFO] - [DATASET] split: test video_indices: [18]
[2024-06-14 15:21:43,501][func.train][INFO] - [DATASET] test size: 3546
[2024-06-14 15:21:43,502][func.train][INFO] - [DATASET] test video_indices: [18]
[2024-06-14 15:21:43,504][func.train][INFO] - [DATASET] Sampling video_idx: 18 at 1 fps to 3546 frames
[2024-06-14 15:21:43,508][func.train][INFO] - [DATASET] video 18 label_list: torch.Size([3546])
[2024-06-14 15:21:43,520][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:21:43,520][func.train][INFO] - [DATASET] avg video length: 59.10 minutes
[2024-06-14 15:21:43,606][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:21:43,607][func.train][INFO] - [DATASET] split: test video_indices: [19]
[2024-06-14 15:21:43,611][func.train][INFO] - [DATASET] test size: 3413
[2024-06-14 15:21:43,611][func.train][INFO] - [DATASET] test video_indices: [19]
[2024-06-14 15:21:43,614][func.train][INFO] - [DATASET] Sampling video_idx: 19 at 1 fps to 3413 frames
[2024-06-14 15:21:43,616][func.train][INFO] - [DATASET] video 19 label_list: torch.Size([3413])
[2024-06-14 15:21:43,632][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:21:43,633][func.train][INFO] - [DATASET] avg video length: 56.88 minutes
[2024-06-14 15:21:43,679][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:21:43,679][func.train][INFO] - [DATASET] split: test video_indices: [20]
[2024-06-14 15:21:43,682][func.train][INFO] - [DATASET] test size: 4832
[2024-06-14 15:21:43,682][func.train][INFO] - [DATASET] test video_indices: [20]
[2024-06-14 15:21:43,684][func.train][INFO] - [DATASET] Sampling video_idx: 20 at 1 fps to 4832 frames
[2024-06-14 15:21:43,685][func.train][INFO] - [DATASET] video 20 label_list: torch.Size([4832])
[2024-06-14 15:21:43,702][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:21:43,703][func.train][INFO] - [DATASET] avg video length: 80.53 minutes
[2024-06-14 15:21:43,765][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:21:43,766][func.train][INFO] - [DATASET] split: test video_indices: [21]
[2024-06-14 15:21:43,768][func.train][INFO] - [DATASET] test size: 4326
[2024-06-14 15:21:43,768][func.train][INFO] - [DATASET] test video_indices: [21]
[2024-06-14 15:21:43,770][func.train][INFO] - [DATASET] Sampling video_idx: 21 at 1 fps to 4326 frames
[2024-06-14 15:21:43,772][func.train][INFO] - [DATASET] video 21 label_list: torch.Size([4326])
[2024-06-14 15:21:43,792][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:21:43,792][func.train][INFO] - [DATASET] avg video length: 72.10 minutes
[2024-06-14 15:21:43,827][func.train][INFO] - Time to load datasets: 0.03 min
[2024-06-14 15:21:43,827][func.train][INFO] - Creating data loaders
[2024-06-14 15:21:43,830][func.train][INFO] - Creating model with {'one': 7} classes
[2024-06-14 15:21:44,912][func.train][INFO] - [MAIN] Number of tokens: 55183
[2024-06-14 15:21:44,913][func.train][INFO] - [MAIN] Number of parameters: 17171926
[2024-06-14 15:21:44,913][func.train][INFO] - [MAIN] Token-to-Parameter Ratio is ideally between [1:1 to 10:1]: 0.003214
[2024-06-14 15:21:44,913][func.train][WARNING] - [MAIN] Data-to-Parameter-Ratio is outside the interval [1:1 to 10:1]
[2024-06-14 15:21:44,915][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-06-14 15:21:44,916][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-06-14 15:21:45,102][func.train][WARNING] - Loaded model from checkpoint_best.pth (ep 0.000000)
[2024-06-14 15:21:45,103][func.train][INFO] - Wrapping model into DP
[2024-06-14 15:21:45,347][func.train][INFO] - Starting test_only
[2024-06-14 15:21:45,350][func.train][INFO] - [EVAL] Epoch: 1 | Anticipation time (s): 60 | Max anticipation time (m): 18 | Step size (m): 1 | Max auto-reg. steps: 18
[2024-06-14 15:21:45,350][func.train][INFO] - [EVAL] X-axis values: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
[2024-06-14 15:23:41,669][func.train][INFO] - Dist info:
[2024-06-14 15:23:41,670][func.train][INFO] - torch version: 2.2.2+cu121
[2024-06-14 15:23:41,671][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-06-14 15:23:41,671][func.train][INFO] - hydra version: 1.3.2
[2024-06-14 15:23:41,675][func.train][INFO] - Loading data
[2024-06-14 15:23:41,675][func.train][INFO] - Loading datasets
[2024-06-14 15:23:41,946][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe in 0m 0s
[2024-06-14 15:23:41,947][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe: (83243, 4)
[2024-06-14 15:23:41,952][func.train][INFO] - [SELECT DATASET] labels are already starting from 0
[2024-06-14 15:23:41,958][func.train][INFO] - [SELECT DATASET] ALL unique classes: [0 1 2 3 4 5 6]
[2024-06-14 15:23:41,965][func.train][INFO] - [SELECT DATASET] aLL dataframe (head):                                           image_path  video_idx frame_idx class
0  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         1     1
1  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         2     1
2  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         3     1
3  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         4     1
4  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         5     1
[2024-06-14 15:23:41,971][func.train][INFO] - [SELECT DATASET] ALL dataframe (tail):                                               image_path  ...  class
83238  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83239  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83240  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83241  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83242  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6

[5 rows x 4 columns]
[2024-06-14 15:23:41,971][func.train][INFO] - [DATASET] params: {'debug': False, 'dataset_name': 'autolaparo21', 'reduc_feats_folder': 'train_targets_x_mp/', 'num_classes': 7, 'num_next_labels': 6, 'last_seg_class': 7, 'predict_next_phase': True, 'get_target_feats': False, 'replace_current_with_next_class': False}
[2024-06-14 15:23:42,005][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:23:42,006][func.train][INFO] - [DATASET] split: train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 15:23:42,021][func.train][INFO] - [DATASET] train size: 55183
[2024-06-14 15:23:42,022][func.train][INFO] - [DATASET] train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 15:23:42,024][func.train][INFO] - [DATASET] Sampling video_idx: 1 at 1 fps to 6388 frames
[2024-06-14 15:23:42,030][func.train][INFO] - [DATASET] video 1 label_list: torch.Size([6388])
[2024-06-14 15:23:42,227][func.train][INFO] - [DATASET] Sampling video_idx: 2 at 1 fps to 3620 frames
[2024-06-14 15:23:42,228][func.train][INFO] - [DATASET] video 2 label_list: torch.Size([3620])
[2024-06-14 15:23:42,246][func.train][INFO] - [DATASET] Sampling video_idx: 3 at 1 fps to 3000 frames
[2024-06-14 15:23:42,247][func.train][INFO] - [DATASET] video 3 label_list: torch.Size([3000])
[2024-06-14 15:23:42,257][func.train][INFO] - [DATASET] Sampling video_idx: 4 at 1 fps to 2938 frames
[2024-06-14 15:23:42,258][func.train][INFO] - [DATASET] video 4 label_list: torch.Size([2938])
[2024-06-14 15:23:42,268][func.train][INFO] - [DATASET] Sampling video_idx: 5 at 1 fps to 3220 frames
[2024-06-14 15:23:42,268][func.train][INFO] - [DATASET] video 5 label_list: torch.Size([3220])
[2024-06-14 15:23:42,278][func.train][INFO] - [DATASET] Sampling video_idx: 6 at 1 fps to 3908 frames
[2024-06-14 15:23:42,279][func.train][INFO] - [DATASET] video 6 label_list: torch.Size([3908])
[2024-06-14 15:23:42,291][func.train][INFO] - [DATASET] Sampling video_idx: 7 at 1 fps to 1645 frames
[2024-06-14 15:23:42,291][func.train][INFO] - [DATASET] video 7 label_list: torch.Size([1645])
[2024-06-14 15:23:42,297][func.train][INFO] - [DATASET] Sampling video_idx: 8 at 1 fps to 4692 frames
[2024-06-14 15:23:42,298][func.train][INFO] - [DATASET] video 8 label_list: torch.Size([4692])
[2024-06-14 15:23:42,315][func.train][INFO] - [DATASET] Sampling video_idx: 9 at 1 fps to 5736 frames
[2024-06-14 15:23:42,316][func.train][INFO] - [DATASET] video 9 label_list: torch.Size([5736])
[2024-06-14 15:23:42,335][func.train][INFO] - [DATASET] Sampling video_idx: 10 at 1 fps to 5064 frames
[2024-06-14 15:23:42,336][func.train][INFO] - [DATASET] video 10 label_list: torch.Size([5064])
[2024-06-14 15:23:42,354][func.train][INFO] - [DATASET] Sampling video_idx: 11 at 1 fps to 4720 frames
[2024-06-14 15:23:42,355][func.train][INFO] - [DATASET] video 11 label_list: torch.Size([4720])
[2024-06-14 15:23:42,371][func.train][INFO] - [DATASET] Sampling video_idx: 12 at 1 fps to 2916 frames
[2024-06-14 15:23:42,373][func.train][INFO] - [DATASET] video 12 label_list: torch.Size([2916])
[2024-06-14 15:23:42,387][func.train][INFO] - [DATASET] Sampling video_idx: 13 at 1 fps to 2597 frames
[2024-06-14 15:23:42,387][func.train][INFO] - [DATASET] video 13 label_list: torch.Size([2597])
[2024-06-14 15:23:42,397][func.train][INFO] - [DATASET] Sampling video_idx: 14 at 1 fps to 4739 frames
[2024-06-14 15:23:42,398][func.train][INFO] - [DATASET] video 14 label_list: torch.Size([4739])
[2024-06-14 15:23:42,411][func.train][INFO] - [DATASET] number of train videos: 14
[2024-06-14 15:23:42,411][func.train][INFO] - [DATASET] avg video length: 65.69 minutes
[2024-06-14 15:23:42,507][func.train][INFO] - [DATASET] num classes at 1fps in train: (55183,)
[2024-06-14 15:23:42,508][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915}
[2024-06-14 15:23:42,510][func.train][INFO] - [DATASET] curr_class_weights: tensor([5.5989, 0.4087, 0.6284, 1.0496, 5.9139, 0.9633, 1.6039])
[2024-06-14 15:23:42,511][func.train][INFO] - [DATASET] eos_weight: count
[2024-06-14 15:23:42,511][func.train][INFO] - [DATASET] num_eos_vals: 840
[2024-06-14 15:23:42,511][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915, 7: 840}
[2024-06-14 15:23:42,512][func.train][INFO] - [DATASET] next_class_weights: tensor([4.9736, 0.3631, 0.5582, 0.9323, 5.2535, 0.8557, 1.4248, 8.3368])
[2024-06-14 15:23:42,576][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:23:42,577][func.train][INFO] - [DATASET] split: test video_indices: [15]
[2024-06-14 15:23:42,580][func.train][INFO] - [DATASET] test size: 3653
[2024-06-14 15:23:42,580][func.train][INFO] - [DATASET] test video_indices: [15]
[2024-06-14 15:23:42,582][func.train][INFO] - [DATASET] Sampling video_idx: 15 at 1 fps to 3653 frames
[2024-06-14 15:23:42,583][func.train][INFO] - [DATASET] video 15 label_list: torch.Size([3653])
[2024-06-14 15:23:42,601][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:23:42,601][func.train][INFO] - [DATASET] avg video length: 60.88 minutes
[2024-06-14 15:23:42,667][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:23:42,668][func.train][INFO] - [DATASET] split: test video_indices: [16]
[2024-06-14 15:23:42,670][func.train][INFO] - [DATASET] test size: 3612
[2024-06-14 15:23:42,670][func.train][INFO] - [DATASET] test video_indices: [16]
[2024-06-14 15:23:42,672][func.train][INFO] - [DATASET] Sampling video_idx: 16 at 1 fps to 3612 frames
[2024-06-14 15:23:42,673][func.train][INFO] - [DATASET] video 16 label_list: torch.Size([3612])
[2024-06-14 15:23:42,683][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:23:42,683][func.train][INFO] - [DATASET] avg video length: 60.20 minutes
[2024-06-14 15:23:42,719][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:23:42,719][func.train][INFO] - [DATASET] split: test video_indices: [17]
[2024-06-14 15:23:42,722][func.train][INFO] - [DATASET] test size: 4678
[2024-06-14 15:23:42,722][func.train][INFO] - [DATASET] test video_indices: [17]
[2024-06-14 15:23:42,724][func.train][INFO] - [DATASET] Sampling video_idx: 17 at 1 fps to 4678 frames
[2024-06-14 15:23:42,724][func.train][INFO] - [DATASET] video 17 label_list: torch.Size([4678])
[2024-06-14 15:23:42,740][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:23:42,741][func.train][INFO] - [DATASET] avg video length: 77.97 minutes
[2024-06-14 15:23:42,776][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:23:42,777][func.train][INFO] - [DATASET] split: test video_indices: [18]
[2024-06-14 15:23:42,779][func.train][INFO] - [DATASET] test size: 3546
[2024-06-14 15:23:42,779][func.train][INFO] - [DATASET] test video_indices: [18]
[2024-06-14 15:23:42,781][func.train][INFO] - [DATASET] Sampling video_idx: 18 at 1 fps to 3546 frames
[2024-06-14 15:23:42,782][func.train][INFO] - [DATASET] video 18 label_list: torch.Size([3546])
[2024-06-14 15:23:42,791][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:23:42,791][func.train][INFO] - [DATASET] avg video length: 59.10 minutes
[2024-06-14 15:23:42,829][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:23:42,829][func.train][INFO] - [DATASET] split: test video_indices: [19]
[2024-06-14 15:23:42,832][func.train][INFO] - [DATASET] test size: 3413
[2024-06-14 15:23:42,832][func.train][INFO] - [DATASET] test video_indices: [19]
[2024-06-14 15:23:42,834][func.train][INFO] - [DATASET] Sampling video_idx: 19 at 1 fps to 3413 frames
[2024-06-14 15:23:42,835][func.train][INFO] - [DATASET] video 19 label_list: torch.Size([3413])
[2024-06-14 15:23:42,847][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:23:42,847][func.train][INFO] - [DATASET] avg video length: 56.88 minutes
[2024-06-14 15:23:42,897][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:23:42,897][func.train][INFO] - [DATASET] split: test video_indices: [20]
[2024-06-14 15:23:42,900][func.train][INFO] - [DATASET] test size: 4832
[2024-06-14 15:23:42,900][func.train][INFO] - [DATASET] test video_indices: [20]
[2024-06-14 15:23:42,902][func.train][INFO] - [DATASET] Sampling video_idx: 20 at 1 fps to 4832 frames
[2024-06-14 15:23:42,903][func.train][INFO] - [DATASET] video 20 label_list: torch.Size([4832])
[2024-06-14 15:23:42,920][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:23:42,921][func.train][INFO] - [DATASET] avg video length: 80.53 minutes
[2024-06-14 15:23:42,971][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:23:42,971][func.train][INFO] - [DATASET] split: test video_indices: [21]
[2024-06-14 15:23:42,974][func.train][INFO] - [DATASET] test size: 4326
[2024-06-14 15:23:42,974][func.train][INFO] - [DATASET] test video_indices: [21]
[2024-06-14 15:23:42,976][func.train][INFO] - [DATASET] Sampling video_idx: 21 at 1 fps to 4326 frames
[2024-06-14 15:23:42,977][func.train][INFO] - [DATASET] video 21 label_list: torch.Size([4326])
[2024-06-14 15:23:42,990][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:23:42,990][func.train][INFO] - [DATASET] avg video length: 72.10 minutes
[2024-06-14 15:23:43,019][func.train][INFO] - Time to load datasets: 0.02 min
[2024-06-14 15:23:43,020][func.train][INFO] - Creating data loaders
[2024-06-14 15:23:43,021][func.train][INFO] - Creating model with {'one': 7} classes
[2024-06-14 15:23:44,139][func.train][INFO] - [MAIN] Number of tokens: 55183
[2024-06-14 15:23:44,139][func.train][INFO] - [MAIN] Number of parameters: 17171926
[2024-06-14 15:23:44,139][func.train][INFO] - [MAIN] Token-to-Parameter Ratio is ideally between [1:1 to 10:1]: 0.003214
[2024-06-14 15:23:44,140][func.train][WARNING] - [MAIN] Data-to-Parameter-Ratio is outside the interval [1:1 to 10:1]
[2024-06-14 15:23:44,141][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-06-14 15:23:44,141][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-06-14 15:23:44,297][func.train][WARNING] - Loaded model from checkpoint_best.pth (ep 0.000000)
[2024-06-14 15:23:44,297][func.train][INFO] - Wrapping model into DP
[2024-06-14 15:23:44,424][func.train][INFO] - Starting test_only
[2024-06-14 15:23:44,427][func.train][INFO] - [EVAL] Epoch: 1 | Anticipation time (s): 60 | Max anticipation time (m): 18 | Step size (m): 1 | Max auto-reg. steps: 18
[2024-06-14 15:23:44,427][func.train][INFO] - [EVAL] X-axis values: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
[2024-06-14 15:25:44,961][func.train][INFO] - Dist info:
[2024-06-14 15:25:44,962][func.train][INFO] - torch version: 2.2.2+cu121
[2024-06-14 15:25:44,963][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-06-14 15:25:44,963][func.train][INFO] - hydra version: 1.3.2
[2024-06-14 15:25:44,968][func.train][INFO] - Loading data
[2024-06-14 15:25:44,968][func.train][INFO] - Loading datasets
[2024-06-14 15:25:45,265][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe in 0m 0s
[2024-06-14 15:25:45,265][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe: (83243, 4)
[2024-06-14 15:25:45,271][func.train][INFO] - [SELECT DATASET] labels are already starting from 0
[2024-06-14 15:25:45,280][func.train][INFO] - [SELECT DATASET] ALL unique classes: [0 1 2 3 4 5 6]
[2024-06-14 15:25:45,288][func.train][INFO] - [SELECT DATASET] aLL dataframe (head):                                           image_path  video_idx frame_idx class
0  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         1     1
1  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         2     1
2  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         3     1
3  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         4     1
4  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         5     1
[2024-06-14 15:25:45,297][func.train][INFO] - [SELECT DATASET] ALL dataframe (tail):                                               image_path  ...  class
83238  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83239  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83240  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83241  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83242  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6

[5 rows x 4 columns]
[2024-06-14 15:25:45,298][func.train][INFO] - [DATASET] params: {'debug': False, 'dataset_name': 'autolaparo21', 'reduc_feats_folder': 'train_targets_x_mp/', 'num_classes': 7, 'num_next_labels': 6, 'last_seg_class': 7, 'predict_next_phase': True, 'get_target_feats': False, 'replace_current_with_next_class': False}
[2024-06-14 15:25:45,358][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:25:45,358][func.train][INFO] - [DATASET] split: train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 15:25:45,381][func.train][INFO] - [DATASET] train size: 55183
[2024-06-14 15:25:45,381][func.train][INFO] - [DATASET] train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 15:25:45,385][func.train][INFO] - [DATASET] Sampling video_idx: 1 at 1 fps to 6388 frames
[2024-06-14 15:25:45,390][func.train][INFO] - [DATASET] video 1 label_list: torch.Size([6388])
[2024-06-14 15:25:45,645][func.train][INFO] - [DATASET] Sampling video_idx: 2 at 1 fps to 3620 frames
[2024-06-14 15:25:45,645][func.train][INFO] - [DATASET] video 2 label_list: torch.Size([3620])
[2024-06-14 15:25:45,661][func.train][INFO] - [DATASET] Sampling video_idx: 3 at 1 fps to 3000 frames
[2024-06-14 15:25:45,662][func.train][INFO] - [DATASET] video 3 label_list: torch.Size([3000])
[2024-06-14 15:25:45,670][func.train][INFO] - [DATASET] Sampling video_idx: 4 at 1 fps to 2938 frames
[2024-06-14 15:25:45,672][func.train][INFO] - [DATASET] video 4 label_list: torch.Size([2938])
[2024-06-14 15:25:45,690][func.train][INFO] - [DATASET] Sampling video_idx: 5 at 1 fps to 3220 frames
[2024-06-14 15:25:45,691][func.train][INFO] - [DATASET] video 5 label_list: torch.Size([3220])
[2024-06-14 15:25:45,708][func.train][INFO] - [DATASET] Sampling video_idx: 6 at 1 fps to 3908 frames
[2024-06-14 15:25:45,709][func.train][INFO] - [DATASET] video 6 label_list: torch.Size([3908])
[2024-06-14 15:25:45,722][func.train][INFO] - [DATASET] Sampling video_idx: 7 at 1 fps to 1645 frames
[2024-06-14 15:25:45,723][func.train][INFO] - [DATASET] video 7 label_list: torch.Size([1645])
[2024-06-14 15:25:45,729][func.train][INFO] - [DATASET] Sampling video_idx: 8 at 1 fps to 4692 frames
[2024-06-14 15:25:45,730][func.train][INFO] - [DATASET] video 8 label_list: torch.Size([4692])
[2024-06-14 15:25:45,747][func.train][INFO] - [DATASET] Sampling video_idx: 9 at 1 fps to 5736 frames
[2024-06-14 15:25:45,748][func.train][INFO] - [DATASET] video 9 label_list: torch.Size([5736])
[2024-06-14 15:25:45,766][func.train][INFO] - [DATASET] Sampling video_idx: 10 at 1 fps to 5064 frames
[2024-06-14 15:25:45,767][func.train][INFO] - [DATASET] video 10 label_list: torch.Size([5064])
[2024-06-14 15:25:45,786][func.train][INFO] - [DATASET] Sampling video_idx: 11 at 1 fps to 4720 frames
[2024-06-14 15:25:45,787][func.train][INFO] - [DATASET] video 11 label_list: torch.Size([4720])
[2024-06-14 15:25:45,806][func.train][INFO] - [DATASET] Sampling video_idx: 12 at 1 fps to 2916 frames
[2024-06-14 15:25:45,808][func.train][INFO] - [DATASET] video 12 label_list: torch.Size([2916])
[2024-06-14 15:25:45,820][func.train][INFO] - [DATASET] Sampling video_idx: 13 at 1 fps to 2597 frames
[2024-06-14 15:25:45,821][func.train][INFO] - [DATASET] video 13 label_list: torch.Size([2597])
[2024-06-14 15:25:45,832][func.train][INFO] - [DATASET] Sampling video_idx: 14 at 1 fps to 4739 frames
[2024-06-14 15:25:45,834][func.train][INFO] - [DATASET] video 14 label_list: torch.Size([4739])
[2024-06-14 15:25:45,851][func.train][INFO] - [DATASET] number of train videos: 14
[2024-06-14 15:25:45,852][func.train][INFO] - [DATASET] avg video length: 65.69 minutes
[2024-06-14 15:25:45,888][func.train][INFO] - [DATASET] num classes at 1fps in train: (55183,)
[2024-06-14 15:25:45,890][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915}
[2024-06-14 15:25:45,892][func.train][INFO] - [DATASET] curr_class_weights: tensor([5.5989, 0.4087, 0.6284, 1.0496, 5.9139, 0.9633, 1.6039])
[2024-06-14 15:25:45,898][func.train][INFO] - [DATASET] eos_weight: count
[2024-06-14 15:25:45,898][func.train][INFO] - [DATASET] num_eos_vals: 840
[2024-06-14 15:25:45,898][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915, 7: 840}
[2024-06-14 15:25:45,899][func.train][INFO] - [DATASET] next_class_weights: tensor([4.9736, 0.3631, 0.5582, 0.9323, 5.2535, 0.8557, 1.4248, 8.3368])
[2024-06-14 15:25:45,963][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:25:45,963][func.train][INFO] - [DATASET] split: test video_indices: [15]
[2024-06-14 15:25:45,966][func.train][INFO] - [DATASET] test size: 3653
[2024-06-14 15:25:45,966][func.train][INFO] - [DATASET] test video_indices: [15]
[2024-06-14 15:25:45,968][func.train][INFO] - [DATASET] Sampling video_idx: 15 at 1 fps to 3653 frames
[2024-06-14 15:25:45,969][func.train][INFO] - [DATASET] video 15 label_list: torch.Size([3653])
[2024-06-14 15:25:45,983][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:25:45,983][func.train][INFO] - [DATASET] avg video length: 60.88 minutes
[2024-06-14 15:25:46,044][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:25:46,044][func.train][INFO] - [DATASET] split: test video_indices: [16]
[2024-06-14 15:25:46,046][func.train][INFO] - [DATASET] test size: 3612
[2024-06-14 15:25:46,047][func.train][INFO] - [DATASET] test video_indices: [16]
[2024-06-14 15:25:46,048][func.train][INFO] - [DATASET] Sampling video_idx: 16 at 1 fps to 3612 frames
[2024-06-14 15:25:46,049][func.train][INFO] - [DATASET] video 16 label_list: torch.Size([3612])
[2024-06-14 15:25:46,061][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:25:46,061][func.train][INFO] - [DATASET] avg video length: 60.20 minutes
[2024-06-14 15:25:46,138][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:25:46,138][func.train][INFO] - [DATASET] split: test video_indices: [17]
[2024-06-14 15:25:46,141][func.train][INFO] - [DATASET] test size: 4678
[2024-06-14 15:25:46,141][func.train][INFO] - [DATASET] test video_indices: [17]
[2024-06-14 15:25:46,143][func.train][INFO] - [DATASET] Sampling video_idx: 17 at 1 fps to 4678 frames
[2024-06-14 15:25:46,144][func.train][INFO] - [DATASET] video 17 label_list: torch.Size([4678])
[2024-06-14 15:25:46,163][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:25:46,164][func.train][INFO] - [DATASET] avg video length: 77.97 minutes
[2024-06-14 15:25:46,258][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:25:46,259][func.train][INFO] - [DATASET] split: test video_indices: [18]
[2024-06-14 15:25:46,261][func.train][INFO] - [DATASET] test size: 3546
[2024-06-14 15:25:46,261][func.train][INFO] - [DATASET] test video_indices: [18]
[2024-06-14 15:25:46,263][func.train][INFO] - [DATASET] Sampling video_idx: 18 at 1 fps to 3546 frames
[2024-06-14 15:25:46,264][func.train][INFO] - [DATASET] video 18 label_list: torch.Size([3546])
[2024-06-14 15:25:46,273][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:25:46,273][func.train][INFO] - [DATASET] avg video length: 59.10 minutes
[2024-06-14 15:25:46,347][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:25:46,347][func.train][INFO] - [DATASET] split: test video_indices: [19]
[2024-06-14 15:25:46,352][func.train][INFO] - [DATASET] test size: 3413
[2024-06-14 15:25:46,352][func.train][INFO] - [DATASET] test video_indices: [19]
[2024-06-14 15:25:46,354][func.train][INFO] - [DATASET] Sampling video_idx: 19 at 1 fps to 3413 frames
[2024-06-14 15:25:46,356][func.train][INFO] - [DATASET] video 19 label_list: torch.Size([3413])
[2024-06-14 15:25:46,379][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:25:46,379][func.train][INFO] - [DATASET] avg video length: 56.88 minutes
[2024-06-14 15:25:46,468][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:25:46,468][func.train][INFO] - [DATASET] split: test video_indices: [20]
[2024-06-14 15:25:46,471][func.train][INFO] - [DATASET] test size: 4832
[2024-06-14 15:25:46,471][func.train][INFO] - [DATASET] test video_indices: [20]
[2024-06-14 15:25:46,480][func.train][INFO] - [DATASET] Sampling video_idx: 20 at 1 fps to 4832 frames
[2024-06-14 15:25:46,481][func.train][INFO] - [DATASET] video 20 label_list: torch.Size([4832])
[2024-06-14 15:25:46,500][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:25:46,500][func.train][INFO] - [DATASET] avg video length: 80.53 minutes
[2024-06-14 15:25:46,550][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:25:46,551][func.train][INFO] - [DATASET] split: test video_indices: [21]
[2024-06-14 15:25:46,553][func.train][INFO] - [DATASET] test size: 4326
[2024-06-14 15:25:46,553][func.train][INFO] - [DATASET] test video_indices: [21]
[2024-06-14 15:25:46,555][func.train][INFO] - [DATASET] Sampling video_idx: 21 at 1 fps to 4326 frames
[2024-06-14 15:25:46,556][func.train][INFO] - [DATASET] video 21 label_list: torch.Size([4326])
[2024-06-14 15:25:46,567][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:25:46,567][func.train][INFO] - [DATASET] avg video length: 72.10 minutes
[2024-06-14 15:25:46,588][func.train][INFO] - Time to load datasets: 0.03 min
[2024-06-14 15:25:46,598][func.train][INFO] - Creating data loaders
[2024-06-14 15:25:46,600][func.train][INFO] - Creating model with {'one': 7} classes
[2024-06-14 15:25:47,717][func.train][INFO] - [MAIN] Number of tokens: 55183
[2024-06-14 15:25:47,717][func.train][INFO] - [MAIN] Number of parameters: 17171926
[2024-06-14 15:25:47,718][func.train][INFO] - [MAIN] Token-to-Parameter Ratio is ideally between [1:1 to 10:1]: 0.003214
[2024-06-14 15:25:47,718][func.train][WARNING] - [MAIN] Data-to-Parameter-Ratio is outside the interval [1:1 to 10:1]
[2024-06-14 15:25:47,720][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-06-14 15:25:47,721][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-06-14 15:25:47,931][func.train][WARNING] - Loaded model from checkpoint_best.pth (ep 0.000000)
[2024-06-14 15:25:47,931][func.train][INFO] - Wrapping model into DP
[2024-06-14 15:25:48,093][func.train][INFO] - Starting test_only
[2024-06-14 15:25:48,096][func.train][INFO] - [EVAL] Epoch: 1 | Anticipation time (s): 60 | Max anticipation time (m): 18 | Step size (m): 1 | Max auto-reg. steps: 18
[2024-06-14 15:25:48,096][func.train][INFO] - [EVAL] X-axis values: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
[2024-06-14 15:25:50,147][func.train][INFO] - [TESTING] padding preds: (64, 1, 8) | targets: (64, 18)
[2024-06-14 15:30:59,480][func.train][INFO] - Dist info:
[2024-06-14 15:30:59,481][func.train][INFO] - torch version: 2.2.2+cu121
[2024-06-14 15:30:59,481][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-06-14 15:30:59,482][func.train][INFO] - hydra version: 1.3.2
[2024-06-14 15:30:59,491][func.train][INFO] - Loading data
[2024-06-14 15:30:59,491][func.train][INFO] - Loading datasets
[2024-06-14 15:30:59,809][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe in 0m 0s
[2024-06-14 15:30:59,809][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe: (83243, 4)
[2024-06-14 15:30:59,815][func.train][INFO] - [SELECT DATASET] labels are already starting from 0
[2024-06-14 15:30:59,821][func.train][INFO] - [SELECT DATASET] ALL unique classes: [0 1 2 3 4 5 6]
[2024-06-14 15:30:59,827][func.train][INFO] - [SELECT DATASET] aLL dataframe (head):                                           image_path  video_idx frame_idx class
0  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         1     1
1  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         2     1
2  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         3     1
3  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         4     1
4  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         5     1
[2024-06-14 15:30:59,832][func.train][INFO] - [SELECT DATASET] ALL dataframe (tail):                                               image_path  ...  class
83238  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83239  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83240  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83241  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83242  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6

[5 rows x 4 columns]
[2024-06-14 15:30:59,833][func.train][INFO] - [DATASET] params: {'debug': False, 'dataset_name': 'autolaparo21', 'reduc_feats_folder': 'train_targets_x_mp/', 'num_classes': 7, 'num_next_labels': 6, 'last_seg_class': 7, 'predict_next_phase': True, 'get_target_feats': False, 'replace_current_with_next_class': False}
[2024-06-14 15:30:59,866][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:30:59,866][func.train][INFO] - [DATASET] split: train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 15:30:59,892][func.train][INFO] - [DATASET] train size: 55183
[2024-06-14 15:30:59,893][func.train][INFO] - [DATASET] train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 15:30:59,896][func.train][INFO] - [DATASET] Sampling video_idx: 1 at 1 fps to 6388 frames
[2024-06-14 15:30:59,900][func.train][INFO] - [DATASET] video 1 label_list: torch.Size([6388])
[2024-06-14 15:31:00,129][func.train][INFO] - [DATASET] Sampling video_idx: 2 at 1 fps to 3620 frames
[2024-06-14 15:31:00,130][func.train][INFO] - [DATASET] video 2 label_list: torch.Size([3620])
[2024-06-14 15:31:00,146][func.train][INFO] - [DATASET] Sampling video_idx: 3 at 1 fps to 3000 frames
[2024-06-14 15:31:00,147][func.train][INFO] - [DATASET] video 3 label_list: torch.Size([3000])
[2024-06-14 15:31:00,167][func.train][INFO] - [DATASET] Sampling video_idx: 4 at 1 fps to 2938 frames
[2024-06-14 15:31:00,168][func.train][INFO] - [DATASET] video 4 label_list: torch.Size([2938])
[2024-06-14 15:31:00,179][func.train][INFO] - [DATASET] Sampling video_idx: 5 at 1 fps to 3220 frames
[2024-06-14 15:31:00,180][func.train][INFO] - [DATASET] video 5 label_list: torch.Size([3220])
[2024-06-14 15:31:00,192][func.train][INFO] - [DATASET] Sampling video_idx: 6 at 1 fps to 3908 frames
[2024-06-14 15:31:00,193][func.train][INFO] - [DATASET] video 6 label_list: torch.Size([3908])
[2024-06-14 15:31:00,210][func.train][INFO] - [DATASET] Sampling video_idx: 7 at 1 fps to 1645 frames
[2024-06-14 15:31:00,211][func.train][INFO] - [DATASET] video 7 label_list: torch.Size([1645])
[2024-06-14 15:31:00,218][func.train][INFO] - [DATASET] Sampling video_idx: 8 at 1 fps to 4692 frames
[2024-06-14 15:31:00,219][func.train][INFO] - [DATASET] video 8 label_list: torch.Size([4692])
[2024-06-14 15:31:00,235][func.train][INFO] - [DATASET] Sampling video_idx: 9 at 1 fps to 5736 frames
[2024-06-14 15:31:00,236][func.train][INFO] - [DATASET] video 9 label_list: torch.Size([5736])
[2024-06-14 15:31:00,255][func.train][INFO] - [DATASET] Sampling video_idx: 10 at 1 fps to 5064 frames
[2024-06-14 15:31:00,256][func.train][INFO] - [DATASET] video 10 label_list: torch.Size([5064])
[2024-06-14 15:31:00,270][func.train][INFO] - [DATASET] Sampling video_idx: 11 at 1 fps to 4720 frames
[2024-06-14 15:31:00,272][func.train][INFO] - [DATASET] video 11 label_list: torch.Size([4720])
[2024-06-14 15:31:00,286][func.train][INFO] - [DATASET] Sampling video_idx: 12 at 1 fps to 2916 frames
[2024-06-14 15:31:00,287][func.train][INFO] - [DATASET] video 12 label_list: torch.Size([2916])
[2024-06-14 15:31:00,300][func.train][INFO] - [DATASET] Sampling video_idx: 13 at 1 fps to 2597 frames
[2024-06-14 15:31:00,300][func.train][INFO] - [DATASET] video 13 label_list: torch.Size([2597])
[2024-06-14 15:31:00,311][func.train][INFO] - [DATASET] Sampling video_idx: 14 at 1 fps to 4739 frames
[2024-06-14 15:31:00,312][func.train][INFO] - [DATASET] video 14 label_list: torch.Size([4739])
[2024-06-14 15:31:00,332][func.train][INFO] - [DATASET] number of train videos: 14
[2024-06-14 15:31:00,333][func.train][INFO] - [DATASET] avg video length: 65.69 minutes
[2024-06-14 15:31:00,427][func.train][INFO] - [DATASET] num classes at 1fps in train: (55183,)
[2024-06-14 15:31:00,428][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915}
[2024-06-14 15:31:00,430][func.train][INFO] - [DATASET] curr_class_weights: tensor([5.5989, 0.4087, 0.6284, 1.0496, 5.9139, 0.9633, 1.6039])
[2024-06-14 15:31:00,430][func.train][INFO] - [DATASET] eos_weight: count
[2024-06-14 15:31:00,430][func.train][INFO] - [DATASET] num_eos_vals: 840
[2024-06-14 15:31:00,430][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915, 7: 840}
[2024-06-14 15:31:00,431][func.train][INFO] - [DATASET] next_class_weights: tensor([4.9736, 0.3631, 0.5582, 0.9323, 5.2535, 0.8557, 1.4248, 8.3368])
[2024-06-14 15:31:00,488][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:31:00,488][func.train][INFO] - [DATASET] split: test video_indices: [15]
[2024-06-14 15:31:00,491][func.train][INFO] - [DATASET] test size: 3653
[2024-06-14 15:31:00,492][func.train][INFO] - [DATASET] test video_indices: [15]
[2024-06-14 15:31:00,495][func.train][INFO] - [DATASET] Sampling video_idx: 15 at 1 fps to 3653 frames
[2024-06-14 15:31:00,495][func.train][INFO] - [DATASET] video 15 label_list: torch.Size([3653])
[2024-06-14 15:31:00,510][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:31:00,510][func.train][INFO] - [DATASET] avg video length: 60.88 minutes
[2024-06-14 15:31:00,564][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:31:00,564][func.train][INFO] - [DATASET] split: test video_indices: [16]
[2024-06-14 15:31:00,567][func.train][INFO] - [DATASET] test size: 3612
[2024-06-14 15:31:00,567][func.train][INFO] - [DATASET] test video_indices: [16]
[2024-06-14 15:31:00,569][func.train][INFO] - [DATASET] Sampling video_idx: 16 at 1 fps to 3612 frames
[2024-06-14 15:31:00,570][func.train][INFO] - [DATASET] video 16 label_list: torch.Size([3612])
[2024-06-14 15:31:00,580][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:31:00,581][func.train][INFO] - [DATASET] avg video length: 60.20 minutes
[2024-06-14 15:31:00,639][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:31:00,640][func.train][INFO] - [DATASET] split: test video_indices: [17]
[2024-06-14 15:31:00,643][func.train][INFO] - [DATASET] test size: 4678
[2024-06-14 15:31:00,643][func.train][INFO] - [DATASET] test video_indices: [17]
[2024-06-14 15:31:00,645][func.train][INFO] - [DATASET] Sampling video_idx: 17 at 1 fps to 4678 frames
[2024-06-14 15:31:00,646][func.train][INFO] - [DATASET] video 17 label_list: torch.Size([4678])
[2024-06-14 15:31:00,661][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:31:00,661][func.train][INFO] - [DATASET] avg video length: 77.97 minutes
[2024-06-14 15:31:00,701][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:31:00,701][func.train][INFO] - [DATASET] split: test video_indices: [18]
[2024-06-14 15:31:00,705][func.train][INFO] - [DATASET] test size: 3546
[2024-06-14 15:31:00,705][func.train][INFO] - [DATASET] test video_indices: [18]
[2024-06-14 15:31:00,708][func.train][INFO] - [DATASET] Sampling video_idx: 18 at 1 fps to 3546 frames
[2024-06-14 15:31:00,709][func.train][INFO] - [DATASET] video 18 label_list: torch.Size([3546])
[2024-06-14 15:31:00,721][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:31:00,722][func.train][INFO] - [DATASET] avg video length: 59.10 minutes
[2024-06-14 15:31:00,772][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:31:00,772][func.train][INFO] - [DATASET] split: test video_indices: [19]
[2024-06-14 15:31:00,777][func.train][INFO] - [DATASET] test size: 3413
[2024-06-14 15:31:00,777][func.train][INFO] - [DATASET] test video_indices: [19]
[2024-06-14 15:31:00,787][func.train][INFO] - [DATASET] Sampling video_idx: 19 at 1 fps to 3413 frames
[2024-06-14 15:31:00,789][func.train][INFO] - [DATASET] video 19 label_list: torch.Size([3413])
[2024-06-14 15:31:00,812][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:31:00,812][func.train][INFO] - [DATASET] avg video length: 56.88 minutes
[2024-06-14 15:31:00,860][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:31:00,861][func.train][INFO] - [DATASET] split: test video_indices: [20]
[2024-06-14 15:31:00,863][func.train][INFO] - [DATASET] test size: 4832
[2024-06-14 15:31:00,864][func.train][INFO] - [DATASET] test video_indices: [20]
[2024-06-14 15:31:00,865][func.train][INFO] - [DATASET] Sampling video_idx: 20 at 1 fps to 4832 frames
[2024-06-14 15:31:00,866][func.train][INFO] - [DATASET] video 20 label_list: torch.Size([4832])
[2024-06-14 15:31:00,884][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:31:00,884][func.train][INFO] - [DATASET] avg video length: 80.53 minutes
[2024-06-14 15:31:00,951][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:31:00,951][func.train][INFO] - [DATASET] split: test video_indices: [21]
[2024-06-14 15:31:00,953][func.train][INFO] - [DATASET] test size: 4326
[2024-06-14 15:31:00,954][func.train][INFO] - [DATASET] test video_indices: [21]
[2024-06-14 15:31:00,956][func.train][INFO] - [DATASET] Sampling video_idx: 21 at 1 fps to 4326 frames
[2024-06-14 15:31:00,957][func.train][INFO] - [DATASET] video 21 label_list: torch.Size([4326])
[2024-06-14 15:31:00,977][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:31:00,977][func.train][INFO] - [DATASET] avg video length: 72.10 minutes
[2024-06-14 15:31:01,013][func.train][INFO] - Time to load datasets: 0.03 min
[2024-06-14 15:31:01,013][func.train][INFO] - Creating data loaders
[2024-06-14 15:31:01,014][func.train][INFO] - Creating model with {'one': 7} classes
[2024-06-14 15:31:01,869][func.train][INFO] - [MAIN] Number of tokens: 55183
[2024-06-14 15:31:01,870][func.train][INFO] - [MAIN] Number of parameters: 17171926
[2024-06-14 15:31:01,870][func.train][INFO] - [MAIN] Token-to-Parameter Ratio is ideally between [1:1 to 10:1]: 0.003214
[2024-06-14 15:31:01,871][func.train][WARNING] - [MAIN] Data-to-Parameter-Ratio is outside the interval [1:1 to 10:1]
[2024-06-14 15:31:01,873][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-06-14 15:31:01,873][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-06-14 15:31:02,026][func.train][WARNING] - Loaded model from checkpoint_best.pth (ep 0.000000)
[2024-06-14 15:31:02,027][func.train][INFO] - Wrapping model into DP
[2024-06-14 15:31:02,179][func.train][INFO] - Starting test_only
[2024-06-14 15:31:02,183][func.train][INFO] - [EVAL] Epoch: 1 | Anticipation time (s): 60 | Max anticipation time (m): 18 | Step size (m): 1 | Max auto-reg. steps: 18
[2024-06-14 15:31:02,183][func.train][INFO] - [EVAL] X-axis values: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
[2024-06-14 15:31:03,693][func.train][INFO] - [TESTING] padding preds: (64, 1, 8) | targets: (64, 18)
[2024-06-14 15:33:27,707][func.train][INFO] - Dist info:
[2024-06-14 15:33:27,709][func.train][INFO] - torch version: 2.2.2+cu121
[2024-06-14 15:33:27,710][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-06-14 15:33:27,710][func.train][INFO] - hydra version: 1.3.2
[2024-06-14 15:33:27,716][func.train][INFO] - Loading data
[2024-06-14 15:33:27,716][func.train][INFO] - Loading datasets
[2024-06-14 15:33:28,023][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe in 0m 0s
[2024-06-14 15:33:28,023][func.train][INFO] - [SELECT DATASET] ALL loaded dataframe: (83243, 4)
[2024-06-14 15:33:28,030][func.train][INFO] - [SELECT DATASET] labels are already starting from 0
[2024-06-14 15:33:28,038][func.train][INFO] - [SELECT DATASET] ALL unique classes: [0 1 2 3 4 5 6]
[2024-06-14 15:33:28,044][func.train][INFO] - [SELECT DATASET] aLL dataframe (head):                                           image_path  video_idx frame_idx class
0  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         1     1
1  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         2     1
2  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         3     1
3  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         4     1
4  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...          1         5     1
[2024-06-14 15:33:28,050][func.train][INFO] - [SELECT DATASET] ALL dataframe (tail):                                               image_path  ...  class
83238  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83239  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83240  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83241  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6
83242  /nfs/home/yangliu/dataset/AutoLaparo_Task1/Aut...  ...      6

[5 rows x 4 columns]
[2024-06-14 15:33:28,050][func.train][INFO] - [DATASET] params: {'debug': False, 'dataset_name': 'autolaparo21', 'reduc_feats_folder': 'train_targets_x_mp/', 'num_classes': 7, 'num_next_labels': 6, 'last_seg_class': 7, 'predict_next_phase': True, 'get_target_feats': False, 'replace_current_with_next_class': False}
[2024-06-14 15:33:28,087][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:33:28,088][func.train][INFO] - [DATASET] split: train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 15:33:28,108][func.train][INFO] - [DATASET] train size: 55183
[2024-06-14 15:33:28,108][func.train][INFO] - [DATASET] train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
[2024-06-14 15:33:28,110][func.train][INFO] - [DATASET] Sampling video_idx: 1 at 1 fps to 6388 frames
[2024-06-14 15:33:28,116][func.train][INFO] - [DATASET] video 1 label_list: torch.Size([6388])
[2024-06-14 15:33:28,324][func.train][INFO] - [DATASET] Sampling video_idx: 2 at 1 fps to 3620 frames
[2024-06-14 15:33:28,324][func.train][INFO] - [DATASET] video 2 label_list: torch.Size([3620])
[2024-06-14 15:33:28,342][func.train][INFO] - [DATASET] Sampling video_idx: 3 at 1 fps to 3000 frames
[2024-06-14 15:33:28,343][func.train][INFO] - [DATASET] video 3 label_list: torch.Size([3000])
[2024-06-14 15:33:28,353][func.train][INFO] - [DATASET] Sampling video_idx: 4 at 1 fps to 2938 frames
[2024-06-14 15:33:28,354][func.train][INFO] - [DATASET] video 4 label_list: torch.Size([2938])
[2024-06-14 15:33:28,364][func.train][INFO] - [DATASET] Sampling video_idx: 5 at 1 fps to 3220 frames
[2024-06-14 15:33:28,365][func.train][INFO] - [DATASET] video 5 label_list: torch.Size([3220])
[2024-06-14 15:33:28,377][func.train][INFO] - [DATASET] Sampling video_idx: 6 at 1 fps to 3908 frames
[2024-06-14 15:33:28,378][func.train][INFO] - [DATASET] video 6 label_list: torch.Size([3908])
[2024-06-14 15:33:28,397][func.train][INFO] - [DATASET] Sampling video_idx: 7 at 1 fps to 1645 frames
[2024-06-14 15:33:28,397][func.train][INFO] - [DATASET] video 7 label_list: torch.Size([1645])
[2024-06-14 15:33:28,406][func.train][INFO] - [DATASET] Sampling video_idx: 8 at 1 fps to 4692 frames
[2024-06-14 15:33:28,407][func.train][INFO] - [DATASET] video 8 label_list: torch.Size([4692])
[2024-06-14 15:33:28,447][func.train][INFO] - [DATASET] Sampling video_idx: 9 at 1 fps to 5736 frames
[2024-06-14 15:33:28,448][func.train][INFO] - [DATASET] video 9 label_list: torch.Size([5736])
[2024-06-14 15:33:28,470][func.train][INFO] - [DATASET] Sampling video_idx: 10 at 1 fps to 5064 frames
[2024-06-14 15:33:28,471][func.train][INFO] - [DATASET] video 10 label_list: torch.Size([5064])
[2024-06-14 15:33:28,491][func.train][INFO] - [DATASET] Sampling video_idx: 11 at 1 fps to 4720 frames
[2024-06-14 15:33:28,492][func.train][INFO] - [DATASET] video 11 label_list: torch.Size([4720])
[2024-06-14 15:33:28,508][func.train][INFO] - [DATASET] Sampling video_idx: 12 at 1 fps to 2916 frames
[2024-06-14 15:33:28,509][func.train][INFO] - [DATASET] video 12 label_list: torch.Size([2916])
[2024-06-14 15:33:28,520][func.train][INFO] - [DATASET] Sampling video_idx: 13 at 1 fps to 2597 frames
[2024-06-14 15:33:28,521][func.train][INFO] - [DATASET] video 13 label_list: torch.Size([2597])
[2024-06-14 15:33:28,531][func.train][INFO] - [DATASET] Sampling video_idx: 14 at 1 fps to 4739 frames
[2024-06-14 15:33:28,532][func.train][INFO] - [DATASET] video 14 label_list: torch.Size([4739])
[2024-06-14 15:33:28,550][func.train][INFO] - [DATASET] number of train videos: 14
[2024-06-14 15:33:28,551][func.train][INFO] - [DATASET] avg video length: 65.69 minutes
[2024-06-14 15:33:28,585][func.train][INFO] - [DATASET] num classes at 1fps in train: (55183,)
[2024-06-14 15:33:28,586][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915}
[2024-06-14 15:33:28,589][func.train][INFO] - [DATASET] curr_class_weights: tensor([5.5989, 0.4087, 0.6284, 1.0496, 5.9139, 0.9633, 1.6039])
[2024-06-14 15:33:28,589][func.train][INFO] - [DATASET] eos_weight: count
[2024-06-14 15:33:28,589][func.train][INFO] - [DATASET] num_eos_vals: 840
[2024-06-14 15:33:28,590][func.train][INFO] - [DATASET] classes_counts_dict: {0: 1408, 1: 19287, 2: 12545, 3: 7511, 4: 1333, 5: 8184, 6: 4915, 7: 840}
[2024-06-14 15:33:28,591][func.train][INFO] - [DATASET] next_class_weights: tensor([4.9736, 0.3631, 0.5582, 0.9323, 5.2535, 0.8557, 1.4248, 8.3368])
[2024-06-14 15:33:28,656][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:33:28,656][func.train][INFO] - [DATASET] split: test video_indices: [15]
[2024-06-14 15:33:28,659][func.train][INFO] - [DATASET] test size: 3653
[2024-06-14 15:33:28,659][func.train][INFO] - [DATASET] test video_indices: [15]
[2024-06-14 15:33:28,661][func.train][INFO] - [DATASET] Sampling video_idx: 15 at 1 fps to 3653 frames
[2024-06-14 15:33:28,662][func.train][INFO] - [DATASET] video 15 label_list: torch.Size([3653])
[2024-06-14 15:33:28,679][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:33:28,680][func.train][INFO] - [DATASET] avg video length: 60.88 minutes
[2024-06-14 15:33:28,737][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:33:28,738][func.train][INFO] - [DATASET] split: test video_indices: [16]
[2024-06-14 15:33:28,741][func.train][INFO] - [DATASET] test size: 3612
[2024-06-14 15:33:28,741][func.train][INFO] - [DATASET] test video_indices: [16]
[2024-06-14 15:33:28,743][func.train][INFO] - [DATASET] Sampling video_idx: 16 at 1 fps to 3612 frames
[2024-06-14 15:33:28,744][func.train][INFO] - [DATASET] video 16 label_list: torch.Size([3612])
[2024-06-14 15:33:28,757][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:33:28,757][func.train][INFO] - [DATASET] avg video length: 60.20 minutes
[2024-06-14 15:33:28,829][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:33:28,829][func.train][INFO] - [DATASET] split: test video_indices: [17]
[2024-06-14 15:33:28,832][func.train][INFO] - [DATASET] test size: 4678
[2024-06-14 15:33:28,832][func.train][INFO] - [DATASET] test video_indices: [17]
[2024-06-14 15:33:28,834][func.train][INFO] - [DATASET] Sampling video_idx: 17 at 1 fps to 4678 frames
[2024-06-14 15:33:28,835][func.train][INFO] - [DATASET] video 17 label_list: torch.Size([4678])
[2024-06-14 15:33:28,852][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:33:28,852][func.train][INFO] - [DATASET] avg video length: 77.97 minutes
[2024-06-14 15:33:28,912][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:33:28,913][func.train][INFO] - [DATASET] split: test video_indices: [18]
[2024-06-14 15:33:28,920][func.train][INFO] - [DATASET] test size: 3546
[2024-06-14 15:33:28,920][func.train][INFO] - [DATASET] test video_indices: [18]
[2024-06-14 15:33:28,922][func.train][INFO] - [DATASET] Sampling video_idx: 18 at 1 fps to 3546 frames
[2024-06-14 15:33:28,923][func.train][INFO] - [DATASET] video 18 label_list: torch.Size([3546])
[2024-06-14 15:33:28,935][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:33:28,936][func.train][INFO] - [DATASET] avg video length: 59.10 minutes
[2024-06-14 15:33:29,013][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:33:29,013][func.train][INFO] - [DATASET] split: test video_indices: [19]
[2024-06-14 15:33:29,016][func.train][INFO] - [DATASET] test size: 3413
[2024-06-14 15:33:29,017][func.train][INFO] - [DATASET] test video_indices: [19]
[2024-06-14 15:33:29,019][func.train][INFO] - [DATASET] Sampling video_idx: 19 at 1 fps to 3413 frames
[2024-06-14 15:33:29,020][func.train][INFO] - [DATASET] video 19 label_list: torch.Size([3413])
[2024-06-14 15:33:29,033][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:33:29,033][func.train][INFO] - [DATASET] avg video length: 56.88 minutes
[2024-06-14 15:33:29,093][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:33:29,093][func.train][INFO] - [DATASET] split: test video_indices: [20]
[2024-06-14 15:33:29,103][func.train][INFO] - [DATASET] test size: 4832
[2024-06-14 15:33:29,103][func.train][INFO] - [DATASET] test video_indices: [20]
[2024-06-14 15:33:29,112][func.train][INFO] - [DATASET] Sampling video_idx: 20 at 1 fps to 4832 frames
[2024-06-14 15:33:29,113][func.train][INFO] - [DATASET] video 20 label_list: torch.Size([4832])
[2024-06-14 15:33:29,130][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:33:29,131][func.train][INFO] - [DATASET] avg video length: 80.53 minutes
[2024-06-14 15:33:29,208][func.train][INFO] - [DATASET] df unique videos: [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
[2024-06-14 15:33:29,209][func.train][INFO] - [DATASET] split: test video_indices: [21]
[2024-06-14 15:33:29,211][func.train][INFO] - [DATASET] test size: 4326
[2024-06-14 15:33:29,211][func.train][INFO] - [DATASET] test video_indices: [21]
[2024-06-14 15:33:29,213][func.train][INFO] - [DATASET] Sampling video_idx: 21 at 1 fps to 4326 frames
[2024-06-14 15:33:29,214][func.train][INFO] - [DATASET] video 21 label_list: torch.Size([4326])
[2024-06-14 15:33:29,259][func.train][INFO] - [DATASET] number of test videos: 1
[2024-06-14 15:33:29,259][func.train][INFO] - [DATASET] avg video length: 72.10 minutes
[2024-06-14 15:33:29,272][func.train][INFO] - Time to load datasets: 0.03 min
[2024-06-14 15:33:29,278][func.train][INFO] - Creating data loaders
[2024-06-14 15:33:29,280][func.train][INFO] - Creating model with {'one': 7} classes
[2024-06-14 15:33:30,570][func.train][INFO] - [MAIN] Number of tokens: 55183
[2024-06-14 15:33:30,570][func.train][INFO] - [MAIN] Number of parameters: 17171926
[2024-06-14 15:33:30,571][func.train][INFO] - [MAIN] Token-to-Parameter Ratio is ideally between [1:1 to 10:1]: 0.003214
[2024-06-14 15:33:30,571][func.train][WARNING] - [MAIN] Data-to-Parameter-Ratio is outside the interval [1:1 to 10:1]
[2024-06-14 15:33:30,573][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-06-14 15:33:30,574][func.train][INFO] - Using LR 0.000300 WD 0.000010 for parameters
[2024-06-14 15:33:30,741][func.train][WARNING] - Loaded model from checkpoint_best.pth (ep 0.000000)
[2024-06-14 15:33:30,741][func.train][INFO] - Wrapping model into DP
[2024-06-14 15:33:30,890][func.train][INFO] - Starting test_only
[2024-06-14 15:33:30,894][func.train][INFO] - [EVAL] Epoch: 1 | Anticipation time (s): 60 | Max anticipation time (m): 18 | Step size (m): 1 | Max auto-reg. steps: 18
[2024-06-14 15:33:30,895][func.train][INFO] - [EVAL] X-axis values: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
[2024-06-14 15:33:32,424][func.train][INFO] - [TESTING] video: 15 | frame: 63 / 3653
[2024-06-14 15:33:32,748][func.train][INFO] - [TESTING] video: 15 | frame: 127 / 3653
[2024-06-14 15:33:33,066][func.train][INFO] - [TESTING] video: 15 | frame: 191 / 3653
[2024-06-14 15:33:33,398][func.train][INFO] - [TESTING] video: 15 | frame: 255 / 3653
[2024-06-14 15:33:33,729][func.train][INFO] - [TESTING] video: 15 | frame: 319 / 3653
[2024-06-14 15:33:34,045][func.train][INFO] - [TESTING] video: 15 | frame: 383 / 3653
[2024-06-14 15:33:34,364][func.train][INFO] - [TESTING] video: 15 | frame: 447 / 3653
[2024-06-14 15:33:34,707][func.train][INFO] - [TESTING] video: 15 | frame: 511 / 3653
[2024-06-14 15:33:35,028][func.train][INFO] - [TESTING] video: 15 | frame: 575 / 3653
[2024-06-14 15:33:35,341][func.train][INFO] - [TESTING] video: 15 | frame: 639 / 3653
[2024-06-14 15:33:35,667][func.train][INFO] - [TESTING] video: 15 | frame: 703 / 3653
[2024-06-14 15:33:36,012][func.train][INFO] - [TESTING] video: 15 | frame: 767 / 3653
[2024-06-14 15:33:36,335][func.train][INFO] - [TESTING] video: 15 | frame: 831 / 3653
[2024-06-14 15:33:36,694][func.train][INFO] - [TESTING] video: 15 | frame: 895 / 3653
[2024-06-14 15:33:37,045][func.train][INFO] - [TESTING] video: 15 | frame: 959 / 3653
[2024-06-14 15:33:37,369][func.train][INFO] - [TESTING] video: 15 | frame: 1023 / 3653
[2024-06-14 15:33:37,709][func.train][INFO] - [TESTING] video: 15 | frame: 1087 / 3653
[2024-06-14 15:33:38,033][func.train][INFO] - [TESTING] video: 15 | frame: 1151 / 3653
[2024-06-14 15:33:38,350][func.train][INFO] - [TESTING] video: 15 | frame: 1215 / 3653
[2024-06-14 15:33:38,672][func.train][INFO] - [TESTING] video: 15 | frame: 1279 / 3653
[2024-06-14 15:33:38,999][func.train][INFO] - [TESTING] video: 15 | frame: 1343 / 3653
[2024-06-14 15:33:39,337][func.train][INFO] - [TESTING] video: 15 | frame: 1407 / 3653
[2024-06-14 15:33:39,643][func.train][INFO] - [TESTING] video: 15 | frame: 1471 / 3653
[2024-06-14 15:33:39,947][func.train][INFO] - [TESTING] video: 15 | frame: 1535 / 3653
[2024-06-14 15:33:40,251][func.train][INFO] - [TESTING] video: 15 | frame: 1599 / 3653
[2024-06-14 15:33:40,555][func.train][INFO] - [TESTING] video: 15 | frame: 1663 / 3653
[2024-06-14 15:33:40,861][func.train][INFO] - [TESTING] video: 15 | frame: 1727 / 3653
[2024-06-14 15:33:41,181][func.train][INFO] - [TESTING] video: 15 | frame: 1791 / 3653
[2024-06-14 15:33:41,508][func.train][INFO] - [TESTING] video: 15 | frame: 1855 / 3653
[2024-06-14 15:33:41,832][func.train][INFO] - [TESTING] video: 15 | frame: 1919 / 3653
[2024-06-14 15:33:42,178][func.train][INFO] - [TESTING] video: 15 | frame: 1983 / 3653
[2024-06-14 15:33:42,535][func.train][INFO] - [TESTING] video: 15 | frame: 2047 / 3653
[2024-06-14 15:33:42,868][func.train][INFO] - [TESTING] video: 15 | frame: 2111 / 3653
[2024-06-14 15:33:43,194][func.train][INFO] - [TESTING] video: 15 | frame: 2175 / 3653
[2024-06-14 15:33:43,512][func.train][INFO] - [TESTING] video: 15 | frame: 2239 / 3653
[2024-06-14 15:33:43,832][func.train][INFO] - [TESTING] video: 15 | frame: 2303 / 3653
[2024-06-14 15:33:44,143][func.train][INFO] - [TESTING] video: 15 | frame: 2367 / 3653
[2024-06-14 15:33:44,449][func.train][INFO] - [TESTING] video: 15 | frame: 2431 / 3653
[2024-06-14 15:33:44,766][func.train][INFO] - [TESTING] video: 15 | frame: 2495 / 3653
[2024-06-14 15:33:45,101][func.train][INFO] - [TESTING] video: 15 | frame: 2559 / 3653
[2024-06-14 15:33:45,428][func.train][INFO] - [TESTING] video: 15 | frame: 2623 / 3653
[2024-06-14 15:33:45,747][func.train][INFO] - [TESTING] video: 15 | frame: 2687 / 3653
[2024-06-14 15:33:46,067][func.train][INFO] - [TESTING] video: 15 | frame: 2751 / 3653
[2024-06-14 15:33:46,396][func.train][INFO] - [TESTING] video: 15 | frame: 2815 / 3653
[2024-06-14 15:33:46,716][func.train][INFO] - [TESTING] video: 15 | frame: 2879 / 3653
[2024-06-14 15:33:47,032][func.train][INFO] - [TESTING] video: 15 | frame: 2943 / 3653
[2024-06-14 15:33:47,355][func.train][INFO] - [TESTING] video: 15 | frame: 3007 / 3653
[2024-06-14 15:33:47,682][func.train][INFO] - [TESTING] video: 15 | frame: 3071 / 3653
[2024-06-14 15:33:48,009][func.train][INFO] - [TESTING] video: 15 | frame: 3135 / 3653
[2024-06-14 15:33:48,346][func.train][INFO] - [TESTING] video: 15 | frame: 3199 / 3653
[2024-06-14 15:33:48,653][func.train][INFO] - [TESTING] video: 15 | frame: 3263 / 3653
[2024-06-14 15:33:48,970][func.train][INFO] - [TESTING] video: 15 | frame: 3327 / 3653
[2024-06-14 15:33:49,297][func.train][INFO] - [TESTING] video: 15 | frame: 3391 / 3653
[2024-06-14 15:33:49,616][func.train][INFO] - [TESTING] video: 15 | frame: 3455 / 3653
[2024-06-14 15:33:49,930][func.train][INFO] - [TESTING] video: 15 | frame: 3519 / 3653
[2024-06-14 15:33:50,237][func.train][INFO] - [TESTING] video: 15 | frame: 3583 / 3653
[2024-06-14 15:33:50,540][func.train][INFO] - [TESTING] video: 15 | frame: 3647 / 3653
[2024-06-14 15:33:50,764][func.train][INFO] - [TESTING] video: 15 | frame: 3652 / 3653
[2024-06-14 15:33:50,764][func.train][INFO] - [TESTING] video: 15 | video test time: 0.33 min | total test time: 0.33 min
[2024-06-14 15:33:50,835][func.train][INFO] - [TESTING] video: 15 | video_mean_curr_acc: 0.8538 | mean_acc_future_frames: 0.4712 | video_mean_cum_acc_future: 0.5567
[2024-06-14 15:33:51,169][func.train][INFO] - [TESTING] video: 16 | frame: 63 / 3612
[2024-06-14 15:33:51,536][func.train][INFO] - [TESTING] video: 16 | frame: 127 / 3612
[2024-06-14 15:33:51,847][func.train][INFO] - [TESTING] video: 16 | frame: 191 / 3612
[2024-06-14 15:33:52,170][func.train][INFO] - [TESTING] video: 16 | frame: 255 / 3612
[2024-06-14 15:33:52,517][func.train][INFO] - [TESTING] video: 16 | frame: 319 / 3612
[2024-06-14 15:33:52,843][func.train][INFO] - [TESTING] video: 16 | frame: 383 / 3612
[2024-06-14 15:33:53,207][func.train][INFO] - [TESTING] video: 16 | frame: 447 / 3612
[2024-06-14 15:33:53,547][func.train][INFO] - [TESTING] video: 16 | frame: 511 / 3612
[2024-06-14 15:33:53,864][func.train][INFO] - [TESTING] video: 16 | frame: 575 / 3612
[2024-06-14 15:33:54,202][func.train][INFO] - [TESTING] video: 16 | frame: 639 / 3612
[2024-06-14 15:33:54,524][func.train][INFO] - [TESTING] video: 16 | frame: 703 / 3612
[2024-06-14 15:33:54,839][func.train][INFO] - [TESTING] video: 16 | frame: 767 / 3612
[2024-06-14 15:33:55,153][func.train][INFO] - [TESTING] video: 16 | frame: 831 / 3612
[2024-06-14 15:33:55,481][func.train][INFO] - [TESTING] video: 16 | frame: 895 / 3612
[2024-06-14 15:33:55,808][func.train][INFO] - [TESTING] video: 16 | frame: 959 / 3612
[2024-06-14 15:33:56,136][func.train][INFO] - [TESTING] video: 16 | frame: 1023 / 3612
[2024-06-14 15:33:56,450][func.train][INFO] - [TESTING] video: 16 | frame: 1087 / 3612
[2024-06-14 15:33:56,768][func.train][INFO] - [TESTING] video: 16 | frame: 1151 / 3612
[2024-06-14 15:33:57,107][func.train][INFO] - [TESTING] video: 16 | frame: 1215 / 3612
[2024-06-14 15:33:57,433][func.train][INFO] - [TESTING] video: 16 | frame: 1279 / 3612
[2024-06-14 15:33:57,748][func.train][INFO] - [TESTING] video: 16 | frame: 1343 / 3612
[2024-06-14 15:33:58,061][func.train][INFO] - [TESTING] video: 16 | frame: 1407 / 3612
[2024-06-14 15:33:58,397][func.train][INFO] - [TESTING] video: 16 | frame: 1471 / 3612
[2024-06-14 15:33:58,725][func.train][INFO] - [TESTING] video: 16 | frame: 1535 / 3612
[2024-06-14 15:33:59,042][func.train][INFO] - [TESTING] video: 16 | frame: 1599 / 3612
[2024-06-14 15:33:59,355][func.train][INFO] - [TESTING] video: 16 | frame: 1663 / 3612
[2024-06-14 15:33:59,669][func.train][INFO] - [TESTING] video: 16 | frame: 1727 / 3612
[2024-06-14 15:34:00,002][func.train][INFO] - [TESTING] video: 16 | frame: 1791 / 3612
[2024-06-14 15:34:00,322][func.train][INFO] - [TESTING] video: 16 | frame: 1855 / 3612
[2024-06-14 15:34:00,637][func.train][INFO] - [TESTING] video: 16 | frame: 1919 / 3612
[2024-06-14 15:34:00,944][func.train][INFO] - [TESTING] video: 16 | frame: 1983 / 3612
[2024-06-14 15:34:01,257][func.train][INFO] - [TESTING] video: 16 | frame: 2047 / 3612
[2024-06-14 15:34:01,580][func.train][INFO] - [TESTING] video: 16 | frame: 2111 / 3612
[2024-06-14 15:34:01,917][func.train][INFO] - [TESTING] video: 16 | frame: 2175 / 3612
[2024-06-14 15:34:02,235][func.train][INFO] - [TESTING] video: 16 | frame: 2239 / 3612
[2024-06-14 15:34:02,548][func.train][INFO] - [TESTING] video: 16 | frame: 2303 / 3612
[2024-06-14 15:34:02,866][func.train][INFO] - [TESTING] video: 16 | frame: 2367 / 3612
[2024-06-14 15:34:03,194][func.train][INFO] - [TESTING] video: 16 | frame: 2431 / 3612
[2024-06-14 15:34:03,513][func.train][INFO] - [TESTING] video: 16 | frame: 2495 / 3612
[2024-06-14 15:34:03,830][func.train][INFO] - [TESTING] video: 16 | frame: 2559 / 3612
[2024-06-14 15:34:04,148][func.train][INFO] - [TESTING] video: 16 | frame: 2623 / 3612
[2024-06-14 15:34:04,454][func.train][INFO] - [TESTING] video: 16 | frame: 2687 / 3612
[2024-06-14 15:34:04,770][func.train][INFO] - [TESTING] video: 16 | frame: 2751 / 3612
[2024-06-14 15:34:05,108][func.train][INFO] - [TESTING] video: 16 | frame: 2815 / 3612
[2024-06-14 15:34:05,432][func.train][INFO] - [TESTING] video: 16 | frame: 2879 / 3612
[2024-06-14 15:34:05,751][func.train][INFO] - [TESTING] video: 16 | frame: 2943 / 3612
[2024-06-14 15:34:06,074][func.train][INFO] - [TESTING] video: 16 | frame: 3007 / 3612
[2024-06-14 15:34:06,411][func.train][INFO] - [TESTING] video: 16 | frame: 3071 / 3612
[2024-06-14 15:34:06,739][func.train][INFO] - [TESTING] video: 16 | frame: 3135 / 3612
[2024-06-14 15:34:07,053][func.train][INFO] - [TESTING] video: 16 | frame: 3199 / 3612
[2024-06-14 15:34:07,366][func.train][INFO] - [TESTING] video: 16 | frame: 3263 / 3612
[2024-06-14 15:34:07,690][func.train][INFO] - [TESTING] video: 16 | frame: 3327 / 3612
[2024-06-14 15:34:08,009][func.train][INFO] - [TESTING] video: 16 | frame: 3391 / 3612
[2024-06-14 15:34:08,335][func.train][INFO] - [TESTING] video: 16 | frame: 3455 / 3612
[2024-06-14 15:34:08,649][func.train][INFO] - [TESTING] video: 16 | frame: 3519 / 3612
[2024-06-14 15:34:08,959][func.train][INFO] - [TESTING] video: 16 | frame: 3583 / 3612
[2024-06-14 15:34:10,320][func.train][INFO] - [TESTING] video: 16 | frame: 3611 / 3612
[2024-06-14 15:34:10,320][func.train][INFO] - [TESTING] video: 16 | video test time: 0.32 min | total test time: 0.66 min
[2024-06-14 15:34:10,365][func.train][INFO] - [TESTING] video: 16 | video_mean_curr_acc: 0.8059 | mean_acc_future_frames: 0.4806 | video_mean_cum_acc_future: 0.5318
[2024-06-14 15:34:10,730][func.train][INFO] - [TESTING] video: 17 | frame: 63 / 4678
[2024-06-14 15:34:11,053][func.train][INFO] - [TESTING] video: 17 | frame: 127 / 4678
[2024-06-14 15:34:11,392][func.train][INFO] - [TESTING] video: 17 | frame: 191 / 4678
[2024-06-14 15:34:11,731][func.train][INFO] - [TESTING] video: 17 | frame: 255 / 4678
[2024-06-14 15:34:12,055][func.train][INFO] - [TESTING] video: 17 | frame: 319 / 4678
[2024-06-14 15:34:12,398][func.train][INFO] - [TESTING] video: 17 | frame: 383 / 4678
[2024-06-14 15:34:12,722][func.train][INFO] - [TESTING] video: 17 | frame: 447 / 4678
[2024-06-14 15:34:13,042][func.train][INFO] - [TESTING] video: 17 | frame: 511 / 4678
[2024-06-14 15:34:13,362][func.train][INFO] - [TESTING] video: 17 | frame: 575 / 4678
[2024-06-14 15:34:13,700][func.train][INFO] - [TESTING] video: 17 | frame: 639 / 4678
[2024-06-14 15:34:14,026][func.train][INFO] - [TESTING] video: 17 | frame: 703 / 4678
[2024-06-14 15:34:14,344][func.train][INFO] - [TESTING] video: 17 | frame: 767 / 4678
[2024-06-14 15:34:14,675][func.train][INFO] - [TESTING] video: 17 | frame: 831 / 4678
[2024-06-14 15:34:15,025][func.train][INFO] - [TESTING] video: 17 | frame: 895 / 4678
[2024-06-14 15:34:15,342][func.train][INFO] - [TESTING] video: 17 | frame: 959 / 4678
[2024-06-14 15:34:15,667][func.train][INFO] - [TESTING] video: 17 | frame: 1023 / 4678
[2024-06-14 15:34:16,005][func.train][INFO] - [TESTING] video: 17 | frame: 1087 / 4678
[2024-06-14 15:34:16,327][func.train][INFO] - [TESTING] video: 17 | frame: 1151 / 4678
[2024-06-14 15:34:16,647][func.train][INFO] - [TESTING] video: 17 | frame: 1215 / 4678
[2024-06-14 15:34:16,970][func.train][INFO] - [TESTING] video: 17 | frame: 1279 / 4678
[2024-06-14 15:34:17,304][func.train][INFO] - [TESTING] video: 17 | frame: 1343 / 4678
[2024-06-14 15:34:17,636][func.train][INFO] - [TESTING] video: 17 | frame: 1407 / 4678
[2024-06-14 15:34:17,952][func.train][INFO] - [TESTING] video: 17 | frame: 1471 / 4678
[2024-06-14 15:34:18,277][func.train][INFO] - [TESTING] video: 17 | frame: 1535 / 4678
[2024-06-14 15:34:18,605][func.train][INFO] - [TESTING] video: 17 | frame: 1599 / 4678
[2024-06-14 15:34:18,927][func.train][INFO] - [TESTING] video: 17 | frame: 1663 / 4678
[2024-06-14 15:34:19,242][func.train][INFO] - [TESTING] video: 17 | frame: 1727 / 4678
[2024-06-14 15:34:19,563][func.train][INFO] - [TESTING] video: 17 | frame: 1791 / 4678
[2024-06-14 15:34:19,892][func.train][INFO] - [TESTING] video: 17 | frame: 1855 / 4678
[2024-06-14 15:34:20,218][func.train][INFO] - [TESTING] video: 17 | frame: 1919 / 4678
[2024-06-14 15:34:20,532][func.train][INFO] - [TESTING] video: 17 | frame: 1983 / 4678
[2024-06-14 15:34:20,851][func.train][INFO] - [TESTING] video: 17 | frame: 2047 / 4678
[2024-06-14 15:34:21,163][func.train][INFO] - [TESTING] video: 17 | frame: 2111 / 4678
[2024-06-14 15:34:21,495][func.train][INFO] - [TESTING] video: 17 | frame: 2175 / 4678
[2024-06-14 15:34:21,812][func.train][INFO] - [TESTING] video: 17 | frame: 2239 / 4678
[2024-06-14 15:34:22,123][func.train][INFO] - [TESTING] video: 17 | frame: 2303 / 4678
[2024-06-14 15:34:22,439][func.train][INFO] - [TESTING] video: 17 | frame: 2367 / 4678
[2024-06-14 15:34:22,756][func.train][INFO] - [TESTING] video: 17 | frame: 2431 / 4678
[2024-06-14 15:34:23,067][func.train][INFO] - [TESTING] video: 17 | frame: 2495 / 4678
[2024-06-14 15:34:23,395][func.train][INFO] - [TESTING] video: 17 | frame: 2559 / 4678
[2024-06-14 15:34:23,719][func.train][INFO] - [TESTING] video: 17 | frame: 2623 / 4678
[2024-06-14 15:34:24,033][func.train][INFO] - [TESTING] video: 17 | frame: 2687 / 4678
[2024-06-14 15:34:24,342][func.train][INFO] - [TESTING] video: 17 | frame: 2751 / 4678
[2024-06-14 15:34:24,656][func.train][INFO] - [TESTING] video: 17 | frame: 2815 / 4678
[2024-06-14 15:34:24,973][func.train][INFO] - [TESTING] video: 17 | frame: 2879 / 4678
[2024-06-14 15:34:25,302][func.train][INFO] - [TESTING] video: 17 | frame: 2943 / 4678
[2024-06-14 15:34:25,633][func.train][INFO] - [TESTING] video: 17 | frame: 3007 / 4678
[2024-06-14 15:34:25,959][func.train][INFO] - [TESTING] video: 17 | frame: 3071 / 4678
[2024-06-14 15:34:26,281][func.train][INFO] - [TESTING] video: 17 | frame: 3135 / 4678
[2024-06-14 15:34:26,605][func.train][INFO] - [TESTING] video: 17 | frame: 3199 / 4678
[2024-06-14 15:34:26,933][func.train][INFO] - [TESTING] video: 17 | frame: 3263 / 4678
[2024-06-14 15:34:27,240][func.train][INFO] - [TESTING] video: 17 | frame: 3327 / 4678
[2024-06-14 15:34:27,553][func.train][INFO] - [TESTING] video: 17 | frame: 3391 / 4678
[2024-06-14 15:34:27,871][func.train][INFO] - [TESTING] video: 17 | frame: 3455 / 4678
[2024-06-14 15:34:28,201][func.train][INFO] - [TESTING] video: 17 | frame: 3519 / 4678
[2024-06-14 15:34:28,537][func.train][INFO] - [TESTING] video: 17 | frame: 3583 / 4678
[2024-06-14 15:34:28,845][func.train][INFO] - [TESTING] video: 17 | frame: 3647 / 4678
[2024-06-14 15:34:29,167][func.train][INFO] - [TESTING] video: 17 | frame: 3711 / 4678
[2024-06-14 15:34:29,501][func.train][INFO] - [TESTING] video: 17 | frame: 3775 / 4678
[2024-06-14 15:34:29,824][func.train][INFO] - [TESTING] video: 17 | frame: 3839 / 4678
[2024-06-14 15:34:30,147][func.train][INFO] - [TESTING] video: 17 | frame: 3903 / 4678
[2024-06-14 15:34:30,482][func.train][INFO] - [TESTING] video: 17 | frame: 3967 / 4678
[2024-06-14 15:34:30,822][func.train][INFO] - [TESTING] video: 17 | frame: 4031 / 4678
[2024-06-14 15:34:31,155][func.train][INFO] - [TESTING] video: 17 | frame: 4095 / 4678
[2024-06-14 15:34:31,494][func.train][INFO] - [TESTING] video: 17 | frame: 4159 / 4678
[2024-06-14 15:34:31,817][func.train][INFO] - [TESTING] video: 17 | frame: 4223 / 4678
[2024-06-14 15:34:32,158][func.train][INFO] - [TESTING] video: 17 | frame: 4287 / 4678
[2024-06-14 15:34:32,505][func.train][INFO] - [TESTING] video: 17 | frame: 4351 / 4678
[2024-06-14 15:34:32,827][func.train][INFO] - [TESTING] video: 17 | frame: 4415 / 4678
[2024-06-14 15:34:33,143][func.train][INFO] - [TESTING] video: 17 | frame: 4479 / 4678
[2024-06-14 15:34:33,461][func.train][INFO] - [TESTING] video: 17 | frame: 4543 / 4678
[2024-06-14 15:34:33,788][func.train][INFO] - [TESTING] video: 17 | frame: 4607 / 4678
[2024-06-14 15:34:34,111][func.train][INFO] - [TESTING] video: 17 | frame: 4671 / 4678
[2024-06-14 15:34:34,335][func.train][INFO] - [TESTING] video: 17 | frame: 4677 / 4678
[2024-06-14 15:34:34,335][func.train][INFO] - [TESTING] video: 17 | video test time: 0.40 min | total test time: 1.06 min
[2024-06-14 15:34:34,413][func.train][INFO] - [TESTING] video: 17 | video_mean_curr_acc: 0.8784 | mean_acc_future_frames: 0.4938 | video_mean_cum_acc_future: 0.5716
[2024-06-14 15:34:34,746][func.train][INFO] - [TESTING] video: 18 | frame: 63 / 3546
[2024-06-14 15:34:35,114][func.train][INFO] - [TESTING] video: 18 | frame: 127 / 3546
[2024-06-14 15:34:35,473][func.train][INFO] - [TESTING] video: 18 | frame: 191 / 3546
[2024-06-14 15:34:35,818][func.train][INFO] - [TESTING] video: 18 | frame: 255 / 3546
[2024-06-14 15:34:36,157][func.train][INFO] - [TESTING] video: 18 | frame: 319 / 3546
[2024-06-14 15:34:36,501][func.train][INFO] - [TESTING] video: 18 | frame: 383 / 3546
[2024-06-14 15:34:36,832][func.train][INFO] - [TESTING] video: 18 | frame: 447 / 3546
[2024-06-14 15:34:37,149][func.train][INFO] - [TESTING] video: 18 | frame: 511 / 3546
[2024-06-14 15:34:37,488][func.train][INFO] - [TESTING] video: 18 | frame: 575 / 3546
[2024-06-14 15:34:37,822][func.train][INFO] - [TESTING] video: 18 | frame: 639 / 3546
[2024-06-14 15:34:38,144][func.train][INFO] - [TESTING] video: 18 | frame: 703 / 3546
[2024-06-14 15:34:38,462][func.train][INFO] - [TESTING] video: 18 | frame: 767 / 3546
[2024-06-14 15:34:38,815][func.train][INFO] - [TESTING] video: 18 | frame: 831 / 3546
[2024-06-14 15:34:39,135][func.train][INFO] - [TESTING] video: 18 | frame: 895 / 3546
[2024-06-14 15:34:39,465][func.train][INFO] - [TESTING] video: 18 | frame: 959 / 3546
[2024-06-14 15:34:39,807][func.train][INFO] - [TESTING] video: 18 | frame: 1023 / 3546
[2024-06-14 15:34:40,137][func.train][INFO] - [TESTING] video: 18 | frame: 1087 / 3546
[2024-06-14 15:34:40,454][func.train][INFO] - [TESTING] video: 18 | frame: 1151 / 3546
[2024-06-14 15:34:40,803][func.train][INFO] - [TESTING] video: 18 | frame: 1215 / 3546
[2024-06-14 15:34:41,138][func.train][INFO] - [TESTING] video: 18 | frame: 1279 / 3546
[2024-06-14 15:34:41,468][func.train][INFO] - [TESTING] video: 18 | frame: 1343 / 3546
[2024-06-14 15:34:41,809][func.train][INFO] - [TESTING] video: 18 | frame: 1407 / 3546
[2024-06-14 15:34:42,123][func.train][INFO] - [TESTING] video: 18 | frame: 1471 / 3546
[2024-06-14 15:34:42,446][func.train][INFO] - [TESTING] video: 18 | frame: 1535 / 3546
[2024-06-14 15:34:42,754][func.train][INFO] - [TESTING] video: 18 | frame: 1599 / 3546
[2024-06-14 15:34:43,078][func.train][INFO] - [TESTING] video: 18 | frame: 1663 / 3546
[2024-06-14 15:34:43,404][func.train][INFO] - [TESTING] video: 18 | frame: 1727 / 3546
[2024-06-14 15:34:43,727][func.train][INFO] - [TESTING] video: 18 | frame: 1791 / 3546
[2024-06-14 15:34:44,037][func.train][INFO] - [TESTING] video: 18 | frame: 1855 / 3546
[2024-06-14 15:34:44,351][func.train][INFO] - [TESTING] video: 18 | frame: 1919 / 3546
[2024-06-14 15:34:44,662][func.train][INFO] - [TESTING] video: 18 | frame: 1983 / 3546
[2024-06-14 15:34:44,990][func.train][INFO] - [TESTING] video: 18 | frame: 2047 / 3546
[2024-06-14 15:34:45,315][func.train][INFO] - [TESTING] video: 18 | frame: 2111 / 3546
[2024-06-14 15:34:45,634][func.train][INFO] - [TESTING] video: 18 | frame: 2175 / 3546
[2024-06-14 15:34:45,949][func.train][INFO] - [TESTING] video: 18 | frame: 2239 / 3546
[2024-06-14 15:34:46,259][func.train][INFO] - [TESTING] video: 18 | frame: 2303 / 3546
[2024-06-14 15:34:46,593][func.train][INFO] - [TESTING] video: 18 | frame: 2367 / 3546
[2024-06-14 15:34:46,911][func.train][INFO] - [TESTING] video: 18 | frame: 2431 / 3546
[2024-06-14 15:34:47,228][func.train][INFO] - [TESTING] video: 18 | frame: 2495 / 3546
[2024-06-14 15:34:47,536][func.train][INFO] - [TESTING] video: 18 | frame: 2559 / 3546
[2024-06-14 15:34:47,845][func.train][INFO] - [TESTING] video: 18 | frame: 2623 / 3546
[2024-06-14 15:34:48,165][func.train][INFO] - [TESTING] video: 18 | frame: 2687 / 3546
[2024-06-14 15:34:48,491][func.train][INFO] - [TESTING] video: 18 | frame: 2751 / 3546
[2024-06-14 15:34:48,812][func.train][INFO] - [TESTING] video: 18 | frame: 2815 / 3546
[2024-06-14 15:34:49,132][func.train][INFO] - [TESTING] video: 18 | frame: 2879 / 3546
[2024-06-14 15:34:49,460][func.train][INFO] - [TESTING] video: 18 | frame: 2943 / 3546
[2024-06-14 15:34:49,801][func.train][INFO] - [TESTING] video: 18 | frame: 3007 / 3546
[2024-06-14 15:34:50,119][func.train][INFO] - [TESTING] video: 18 | frame: 3071 / 3546
[2024-06-14 15:34:50,439][func.train][INFO] - [TESTING] video: 18 | frame: 3135 / 3546
[2024-06-14 15:34:50,765][func.train][INFO] - [TESTING] video: 18 | frame: 3199 / 3546
[2024-06-14 15:34:51,096][func.train][INFO] - [TESTING] video: 18 | frame: 3263 / 3546
[2024-06-14 15:34:51,425][func.train][INFO] - [TESTING] video: 18 | frame: 3327 / 3546
[2024-06-14 15:34:51,756][func.train][INFO] - [TESTING] video: 18 | frame: 3391 / 3546
[2024-06-14 15:34:52,085][func.train][INFO] - [TESTING] video: 18 | frame: 3455 / 3546
[2024-06-14 15:34:52,401][func.train][INFO] - [TESTING] video: 18 | frame: 3519 / 3546
[2024-06-14 15:34:53,720][func.train][INFO] - [TESTING] video: 18 | frame: 3545 / 3546
[2024-06-14 15:34:53,721][func.train][INFO] - [TESTING] video: 18 | video test time: 0.32 min | total test time: 1.38 min
[2024-06-14 15:34:53,782][func.train][INFO] - [TESTING] video: 18 | video_mean_curr_acc: 0.8311 | mean_acc_future_frames: 0.5018 | video_mean_cum_acc_future: 0.5562
[2024-06-14 15:34:54,124][func.train][INFO] - [TESTING] video: 19 | frame: 63 / 3413
[2024-06-14 15:34:54,443][func.train][INFO] - [TESTING] video: 19 | frame: 127 / 3413
[2024-06-14 15:34:54,757][func.train][INFO] - [TESTING] video: 19 | frame: 191 / 3413
[2024-06-14 15:34:55,094][func.train][INFO] - [TESTING] video: 19 | frame: 255 / 3413
[2024-06-14 15:34:55,421][func.train][INFO] - [TESTING] video: 19 | frame: 319 / 3413
[2024-06-14 15:34:55,734][func.train][INFO] - [TESTING] video: 19 | frame: 383 / 3413
[2024-06-14 15:34:56,055][func.train][INFO] - [TESTING] video: 19 | frame: 447 / 3413
[2024-06-14 15:34:56,404][func.train][INFO] - [TESTING] video: 19 | frame: 511 / 3413
[2024-06-14 15:34:56,725][func.train][INFO] - [TESTING] video: 19 | frame: 575 / 3413
[2024-06-14 15:34:57,039][func.train][INFO] - [TESTING] video: 19 | frame: 639 / 3413
[2024-06-14 15:34:57,357][func.train][INFO] - [TESTING] video: 19 | frame: 703 / 3413
[2024-06-14 15:34:57,694][func.train][INFO] - [TESTING] video: 19 | frame: 767 / 3413
[2024-06-14 15:34:58,059][func.train][INFO] - [TESTING] video: 19 | frame: 831 / 3413
[2024-06-14 15:34:58,377][func.train][INFO] - [TESTING] video: 19 | frame: 895 / 3413
[2024-06-14 15:34:58,703][func.train][INFO] - [TESTING] video: 19 | frame: 959 / 3413
[2024-06-14 15:34:59,019][func.train][INFO] - [TESTING] video: 19 | frame: 1023 / 3413
[2024-06-14 15:34:59,382][func.train][INFO] - [TESTING] video: 19 | frame: 1087 / 3413
[2024-06-14 15:34:59,730][func.train][INFO] - [TESTING] video: 19 | frame: 1151 / 3413
[2024-06-14 15:35:00,079][func.train][INFO] - [TESTING] video: 19 | frame: 1215 / 3413
[2024-06-14 15:35:00,407][func.train][INFO] - [TESTING] video: 19 | frame: 1279 / 3413
[2024-06-14 15:35:00,724][func.train][INFO] - [TESTING] video: 19 | frame: 1343 / 3413
[2024-06-14 15:35:01,039][func.train][INFO] - [TESTING] video: 19 | frame: 1407 / 3413
[2024-06-14 15:35:01,352][func.train][INFO] - [TESTING] video: 19 | frame: 1471 / 3413
[2024-06-14 15:35:01,661][func.train][INFO] - [TESTING] video: 19 | frame: 1535 / 3413
[2024-06-14 15:35:01,977][func.train][INFO] - [TESTING] video: 19 | frame: 1599 / 3413
[2024-06-14 15:35:02,297][func.train][INFO] - [TESTING] video: 19 | frame: 1663 / 3413
[2024-06-14 15:35:02,617][func.train][INFO] - [TESTING] video: 19 | frame: 1727 / 3413
[2024-06-14 15:35:02,965][func.train][INFO] - [TESTING] video: 19 | frame: 1791 / 3413
[2024-06-14 15:35:03,306][func.train][INFO] - [TESTING] video: 19 | frame: 1855 / 3413
[2024-06-14 15:35:03,627][func.train][INFO] - [TESTING] video: 19 | frame: 1919 / 3413
[2024-06-14 15:35:03,937][func.train][INFO] - [TESTING] video: 19 | frame: 1983 / 3413
[2024-06-14 15:35:04,244][func.train][INFO] - [TESTING] video: 19 | frame: 2047 / 3413
[2024-06-14 15:35:04,560][func.train][INFO] - [TESTING] video: 19 | frame: 2111 / 3413
[2024-06-14 15:35:04,891][func.train][INFO] - [TESTING] video: 19 | frame: 2175 / 3413
[2024-06-14 15:35:05,209][func.train][INFO] - [TESTING] video: 19 | frame: 2239 / 3413
[2024-06-14 15:35:05,523][func.train][INFO] - [TESTING] video: 19 | frame: 2303 / 3413
[2024-06-14 15:35:05,841][func.train][INFO] - [TESTING] video: 19 | frame: 2367 / 3413
[2024-06-14 15:35:06,156][func.train][INFO] - [TESTING] video: 19 | frame: 2431 / 3413
[2024-06-14 15:35:06,486][func.train][INFO] - [TESTING] video: 19 | frame: 2495 / 3413
[2024-06-14 15:35:06,811][func.train][INFO] - [TESTING] video: 19 | frame: 2559 / 3413
[2024-06-14 15:35:07,123][func.train][INFO] - [TESTING] video: 19 | frame: 2623 / 3413
[2024-06-14 15:35:07,431][func.train][INFO] - [TESTING] video: 19 | frame: 2687 / 3413
[2024-06-14 15:35:07,749][func.train][INFO] - [TESTING] video: 19 | frame: 2751 / 3413
[2024-06-14 15:35:08,075][func.train][INFO] - [TESTING] video: 19 | frame: 2815 / 3413
[2024-06-14 15:35:08,406][func.train][INFO] - [TESTING] video: 19 | frame: 2879 / 3413
[2024-06-14 15:35:08,737][func.train][INFO] - [TESTING] video: 19 | frame: 2943 / 3413
[2024-06-14 15:35:09,057][func.train][INFO] - [TESTING] video: 19 | frame: 3007 / 3413
[2024-06-14 15:35:09,395][func.train][INFO] - [TESTING] video: 19 | frame: 3071 / 3413
[2024-06-14 15:35:09,710][func.train][INFO] - [TESTING] video: 19 | frame: 3135 / 3413
[2024-06-14 15:35:10,030][func.train][INFO] - [TESTING] video: 19 | frame: 3199 / 3413
[2024-06-14 15:35:10,357][func.train][INFO] - [TESTING] video: 19 | frame: 3263 / 3413
[2024-06-14 15:35:10,683][func.train][INFO] - [TESTING] video: 19 | frame: 3327 / 3413
[2024-06-14 15:35:11,015][func.train][INFO] - [TESTING] video: 19 | frame: 3391 / 3413
[2024-06-14 15:35:12,153][func.train][INFO] - [TESTING] video: 19 | frame: 3412 / 3413
[2024-06-14 15:35:12,154][func.train][INFO] - [TESTING] video: 19 | video test time: 0.31 min | total test time: 1.69 min
[2024-06-14 15:35:12,214][func.train][INFO] - [TESTING] video: 19 | video_mean_curr_acc: 0.7132 | mean_acc_future_frames: 0.4226 | video_mean_cum_acc_future: 0.4928
[2024-06-14 15:35:12,550][func.train][INFO] - [TESTING] video: 20 | frame: 63 / 4832
[2024-06-14 15:35:12,921][func.train][INFO] - [TESTING] video: 20 | frame: 127 / 4832
[2024-06-14 15:35:13,264][func.train][INFO] - [TESTING] video: 20 | frame: 191 / 4832
[2024-06-14 15:35:13,616][func.train][INFO] - [TESTING] video: 20 | frame: 255 / 4832
[2024-06-14 15:35:13,939][func.train][INFO] - [TESTING] video: 20 | frame: 319 / 4832
[2024-06-14 15:35:14,259][func.train][INFO] - [TESTING] video: 20 | frame: 383 / 4832
[2024-06-14 15:35:14,602][func.train][INFO] - [TESTING] video: 20 | frame: 447 / 4832
[2024-06-14 15:35:14,932][func.train][INFO] - [TESTING] video: 20 | frame: 511 / 4832
[2024-06-14 15:35:15,257][func.train][INFO] - [TESTING] video: 20 | frame: 575 / 4832
[2024-06-14 15:35:15,589][func.train][INFO] - [TESTING] video: 20 | frame: 639 / 4832
[2024-06-14 15:35:15,927][func.train][INFO] - [TESTING] video: 20 | frame: 703 / 4832
[2024-06-14 15:35:16,252][func.train][INFO] - [TESTING] video: 20 | frame: 767 / 4832
[2024-06-14 15:35:16,584][func.train][INFO] - [TESTING] video: 20 | frame: 831 / 4832
[2024-06-14 15:35:16,924][func.train][INFO] - [TESTING] video: 20 | frame: 895 / 4832
[2024-06-14 15:35:17,246][func.train][INFO] - [TESTING] video: 20 | frame: 959 / 4832
[2024-06-14 15:35:17,568][func.train][INFO] - [TESTING] video: 20 | frame: 1023 / 4832
[2024-06-14 15:35:17,922][func.train][INFO] - [TESTING] video: 20 | frame: 1087 / 4832
[2024-06-14 15:35:18,250][func.train][INFO] - [TESTING] video: 20 | frame: 1151 / 4832
[2024-06-14 15:35:18,594][func.train][INFO] - [TESTING] video: 20 | frame: 1215 / 4832
[2024-06-14 15:35:18,924][func.train][INFO] - [TESTING] video: 20 | frame: 1279 / 4832
[2024-06-14 15:35:19,246][func.train][INFO] - [TESTING] video: 20 | frame: 1343 / 4832
[2024-06-14 15:35:19,564][func.train][INFO] - [TESTING] video: 20 | frame: 1407 / 4832
[2024-06-14 15:35:19,903][func.train][INFO] - [TESTING] video: 20 | frame: 1471 / 4832
[2024-06-14 15:35:20,219][func.train][INFO] - [TESTING] video: 20 | frame: 1535 / 4832
[2024-06-14 15:35:20,537][func.train][INFO] - [TESTING] video: 20 | frame: 1599 / 4832
[2024-06-14 15:35:20,847][func.train][INFO] - [TESTING] video: 20 | frame: 1663 / 4832
[2024-06-14 15:35:21,154][func.train][INFO] - [TESTING] video: 20 | frame: 1727 / 4832
[2024-06-14 15:35:21,479][func.train][INFO] - [TESTING] video: 20 | frame: 1791 / 4832
[2024-06-14 15:35:21,805][func.train][INFO] - [TESTING] video: 20 | frame: 1855 / 4832
[2024-06-14 15:35:22,133][func.train][INFO] - [TESTING] video: 20 | frame: 1919 / 4832
[2024-06-14 15:35:22,446][func.train][INFO] - [TESTING] video: 20 | frame: 1983 / 4832
[2024-06-14 15:35:22,759][func.train][INFO] - [TESTING] video: 20 | frame: 2047 / 4832
[2024-06-14 15:35:23,089][func.train][INFO] - [TESTING] video: 20 | frame: 2111 / 4832
[2024-06-14 15:35:23,407][func.train][INFO] - [TESTING] video: 20 | frame: 2175 / 4832
[2024-06-14 15:35:23,725][func.train][INFO] - [TESTING] video: 20 | frame: 2239 / 4832
[2024-06-14 15:35:24,046][func.train][INFO] - [TESTING] video: 20 | frame: 2303 / 4832
[2024-06-14 15:35:24,367][func.train][INFO] - [TESTING] video: 20 | frame: 2367 / 4832
[2024-06-14 15:35:24,704][func.train][INFO] - [TESTING] video: 20 | frame: 2431 / 4832
[2024-06-14 15:35:25,036][func.train][INFO] - [TESTING] video: 20 | frame: 2495 / 4832
[2024-06-14 15:35:25,353][func.train][INFO] - [TESTING] video: 20 | frame: 2559 / 4832
[2024-06-14 15:35:25,672][func.train][INFO] - [TESTING] video: 20 | frame: 2623 / 4832
[2024-06-14 15:35:26,007][func.train][INFO] - [TESTING] video: 20 | frame: 2687 / 4832
[2024-06-14 15:35:26,324][func.train][INFO] - [TESTING] video: 20 | frame: 2751 / 4832
[2024-06-14 15:35:26,634][func.train][INFO] - [TESTING] video: 20 | frame: 2815 / 4832
[2024-06-14 15:35:26,953][func.train][INFO] - [TESTING] video: 20 | frame: 2879 / 4832
[2024-06-14 15:35:27,267][func.train][INFO] - [TESTING] video: 20 | frame: 2943 / 4832
[2024-06-14 15:35:27,608][func.train][INFO] - [TESTING] video: 20 | frame: 3007 / 4832
[2024-06-14 15:35:27,932][func.train][INFO] - [TESTING] video: 20 | frame: 3071 / 4832
[2024-06-14 15:35:28,254][func.train][INFO] - [TESTING] video: 20 | frame: 3135 / 4832
[2024-06-14 15:35:28,579][func.train][INFO] - [TESTING] video: 20 | frame: 3199 / 4832
[2024-06-14 15:35:28,906][func.train][INFO] - [TESTING] video: 20 | frame: 3263 / 4832
[2024-06-14 15:35:29,226][func.train][INFO] - [TESTING] video: 20 | frame: 3327 / 4832
[2024-06-14 15:35:29,537][func.train][INFO] - [TESTING] video: 20 | frame: 3391 / 4832
[2024-06-14 15:35:29,848][func.train][INFO] - [TESTING] video: 20 | frame: 3455 / 4832
[2024-06-14 15:35:30,208][func.train][INFO] - [TESTING] video: 20 | frame: 3519 / 4832
[2024-06-14 15:35:30,533][func.train][INFO] - [TESTING] video: 20 | frame: 3583 / 4832
[2024-06-14 15:35:30,841][func.train][INFO] - [TESTING] video: 20 | frame: 3647 / 4832
[2024-06-14 15:35:31,161][func.train][INFO] - [TESTING] video: 20 | frame: 3711 / 4832
[2024-06-14 15:35:31,491][func.train][INFO] - [TESTING] video: 20 | frame: 3775 / 4832
[2024-06-14 15:35:31,833][func.train][INFO] - [TESTING] video: 20 | frame: 3839 / 4832
[2024-06-14 15:35:32,163][func.train][INFO] - [TESTING] video: 20 | frame: 3903 / 4832
[2024-06-14 15:35:32,513][func.train][INFO] - [TESTING] video: 20 | frame: 3967 / 4832
[2024-06-14 15:35:32,832][func.train][INFO] - [TESTING] video: 20 | frame: 4031 / 4832
[2024-06-14 15:35:33,143][func.train][INFO] - [TESTING] video: 20 | frame: 4095 / 4832
[2024-06-14 15:35:33,463][func.train][INFO] - [TESTING] video: 20 | frame: 4159 / 4832
[2024-06-14 15:35:33,794][func.train][INFO] - [TESTING] video: 20 | frame: 4223 / 4832
[2024-06-14 15:35:34,120][func.train][INFO] - [TESTING] video: 20 | frame: 4287 / 4832
[2024-06-14 15:35:34,440][func.train][INFO] - [TESTING] video: 20 | frame: 4351 / 4832
[2024-06-14 15:35:34,753][func.train][INFO] - [TESTING] video: 20 | frame: 4415 / 4832
[2024-06-14 15:35:35,084][func.train][INFO] - [TESTING] video: 20 | frame: 4479 / 4832
[2024-06-14 15:35:35,414][func.train][INFO] - [TESTING] video: 20 | frame: 4543 / 4832
[2024-06-14 15:35:35,726][func.train][INFO] - [TESTING] video: 20 | frame: 4607 / 4832
[2024-06-14 15:35:36,042][func.train][INFO] - [TESTING] video: 20 | frame: 4671 / 4832
[2024-06-14 15:35:36,359][func.train][INFO] - [TESTING] video: 20 | frame: 4735 / 4832
[2024-06-14 15:35:36,681][func.train][INFO] - [TESTING] video: 20 | frame: 4799 / 4832
[2024-06-14 15:35:38,267][func.train][INFO] - [TESTING] video: 20 | frame: 4831 / 4832
[2024-06-14 15:35:38,268][func.train][INFO] - [TESTING] video: 20 | video test time: 0.43 min | total test time: 2.12 min
[2024-06-14 15:35:38,353][func.train][INFO] - [TESTING] video: 20 | video_mean_curr_acc: 0.8218 | mean_acc_future_frames: 0.4825 | video_mean_cum_acc_future: 0.559
[2024-06-14 15:35:38,702][func.train][INFO] - [TESTING] video: 21 | frame: 63 / 4326
[2024-06-14 15:35:39,038][func.train][INFO] - [TESTING] video: 21 | frame: 127 / 4326
[2024-06-14 15:35:39,402][func.train][INFO] - [TESTING] video: 21 | frame: 191 / 4326
[2024-06-14 15:35:39,745][func.train][INFO] - [TESTING] video: 21 | frame: 255 / 4326
[2024-06-14 15:35:40,067][func.train][INFO] - [TESTING] video: 21 | frame: 319 / 4326
[2024-06-14 15:35:40,403][func.train][INFO] - [TESTING] video: 21 | frame: 383 / 4326
[2024-06-14 15:35:40,724][func.train][INFO] - [TESTING] video: 21 | frame: 447 / 4326
[2024-06-14 15:35:41,038][func.train][INFO] - [TESTING] video: 21 | frame: 511 / 4326
[2024-06-14 15:35:41,357][func.train][INFO] - [TESTING] video: 21 | frame: 575 / 4326
[2024-06-14 15:35:41,688][func.train][INFO] - [TESTING] video: 21 | frame: 639 / 4326
[2024-06-14 15:35:42,012][func.train][INFO] - [TESTING] video: 21 | frame: 703 / 4326
[2024-06-14 15:35:42,336][func.train][INFO] - [TESTING] video: 21 | frame: 767 / 4326
[2024-06-14 15:35:42,664][func.train][INFO] - [TESTING] video: 21 | frame: 831 / 4326
[2024-06-14 15:35:42,996][func.train][INFO] - [TESTING] video: 21 | frame: 895 / 4326
[2024-06-14 15:35:43,323][func.train][INFO] - [TESTING] video: 21 | frame: 959 / 4326
[2024-06-14 15:35:43,643][func.train][INFO] - [TESTING] video: 21 | frame: 1023 / 4326
[2024-06-14 15:35:43,955][func.train][INFO] - [TESTING] video: 21 | frame: 1087 / 4326
[2024-06-14 15:35:44,303][func.train][INFO] - [TESTING] video: 21 | frame: 1151 / 4326
[2024-06-14 15:35:44,623][func.train][INFO] - [TESTING] video: 21 | frame: 1215 / 4326
[2024-06-14 15:35:44,944][func.train][INFO] - [TESTING] video: 21 | frame: 1279 / 4326
[2024-06-14 15:35:45,269][func.train][INFO] - [TESTING] video: 21 | frame: 1343 / 4326
[2024-06-14 15:35:45,601][func.train][INFO] - [TESTING] video: 21 | frame: 1407 / 4326
[2024-06-14 15:35:45,921][func.train][INFO] - [TESTING] video: 21 | frame: 1471 / 4326
[2024-06-14 15:35:46,231][func.train][INFO] - [TESTING] video: 21 | frame: 1535 / 4326
[2024-06-14 15:35:46,538][func.train][INFO] - [TESTING] video: 21 | frame: 1599 / 4326
[2024-06-14 15:35:46,846][func.train][INFO] - [TESTING] video: 21 | frame: 1663 / 4326
[2024-06-14 15:35:47,162][func.train][INFO] - [TESTING] video: 21 | frame: 1727 / 4326
[2024-06-14 15:35:47,498][func.train][INFO] - [TESTING] video: 21 | frame: 1791 / 4326
[2024-06-14 15:35:47,811][func.train][INFO] - [TESTING] video: 21 | frame: 1855 / 4326
[2024-06-14 15:35:48,130][func.train][INFO] - [TESTING] video: 21 | frame: 1919 / 4326
[2024-06-14 15:35:48,443][func.train][INFO] - [TESTING] video: 21 | frame: 1983 / 4326
[2024-06-14 15:35:48,759][func.train][INFO] - [TESTING] video: 21 | frame: 2047 / 4326
[2024-06-14 15:35:49,109][func.train][INFO] - [TESTING] video: 21 | frame: 2111 / 4326
[2024-06-14 15:35:49,440][func.train][INFO] - [TESTING] video: 21 | frame: 2175 / 4326
[2024-06-14 15:35:49,750][func.train][INFO] - [TESTING] video: 21 | frame: 2239 / 4326
[2024-06-14 15:35:50,065][func.train][INFO] - [TESTING] video: 21 | frame: 2303 / 4326
[2024-06-14 15:35:50,394][func.train][INFO] - [TESTING] video: 21 | frame: 2367 / 4326
[2024-06-14 15:35:50,716][func.train][INFO] - [TESTING] video: 21 | frame: 2431 / 4326
[2024-06-14 15:35:51,045][func.train][INFO] - [TESTING] video: 21 | frame: 2495 / 4326
[2024-06-14 15:35:51,360][func.train][INFO] - [TESTING] video: 21 | frame: 2559 / 4326
[2024-06-14 15:35:51,699][func.train][INFO] - [TESTING] video: 21 | frame: 2623 / 4326
[2024-06-14 15:35:52,024][func.train][INFO] - [TESTING] video: 21 | frame: 2687 / 4326
[2024-06-14 15:35:52,343][func.train][INFO] - [TESTING] video: 21 | frame: 2751 / 4326
[2024-06-14 15:35:52,653][func.train][INFO] - [TESTING] video: 21 | frame: 2815 / 4326
[2024-06-14 15:35:52,971][func.train][INFO] - [TESTING] video: 21 | frame: 2879 / 4326
[2024-06-14 15:35:53,308][func.train][INFO] - [TESTING] video: 21 | frame: 2943 / 4326
[2024-06-14 15:35:53,641][func.train][INFO] - [TESTING] video: 21 | frame: 3007 / 4326
[2024-06-14 15:35:53,971][func.train][INFO] - [TESTING] video: 21 | frame: 3071 / 4326
[2024-06-14 15:35:54,295][func.train][INFO] - [TESTING] video: 21 | frame: 3135 / 4326
[2024-06-14 15:35:54,614][func.train][INFO] - [TESTING] video: 21 | frame: 3199 / 4326
[2024-06-14 15:35:54,942][func.train][INFO] - [TESTING] video: 21 | frame: 3263 / 4326
[2024-06-14 15:35:55,259][func.train][INFO] - [TESTING] video: 21 | frame: 3327 / 4326
[2024-06-14 15:35:55,586][func.train][INFO] - [TESTING] video: 21 | frame: 3391 / 4326
[2024-06-14 15:35:55,910][func.train][INFO] - [TESTING] video: 21 | frame: 3455 / 4326
[2024-06-14 15:35:56,233][func.train][INFO] - [TESTING] video: 21 | frame: 3519 / 4326
[2024-06-14 15:35:56,554][func.train][INFO] - [TESTING] video: 21 | frame: 3583 / 4326
[2024-06-14 15:35:56,885][func.train][INFO] - [TESTING] video: 21 | frame: 3647 / 4326
[2024-06-14 15:35:57,218][func.train][INFO] - [TESTING] video: 21 | frame: 3711 / 4326
[2024-06-14 15:35:57,540][func.train][INFO] - [TESTING] video: 21 | frame: 3775 / 4326
[2024-06-14 15:35:57,870][func.train][INFO] - [TESTING] video: 21 | frame: 3839 / 4326
[2024-06-14 15:35:58,201][func.train][INFO] - [TESTING] video: 21 | frame: 3903 / 4326
[2024-06-14 15:35:58,521][func.train][INFO] - [TESTING] video: 21 | frame: 3967 / 4326
[2024-06-14 15:35:58,835][func.train][INFO] - [TESTING] video: 21 | frame: 4031 / 4326
[2024-06-14 15:35:59,146][func.train][INFO] - [TESTING] video: 21 | frame: 4095 / 4326
[2024-06-14 15:35:59,464][func.train][INFO] - [TESTING] video: 21 | frame: 4159 / 4326
[2024-06-14 15:35:59,783][func.train][INFO] - [TESTING] video: 21 | frame: 4223 / 4326
[2024-06-14 15:36:00,114][func.train][INFO] - [TESTING] video: 21 | frame: 4287 / 4326
[2024-06-14 15:36:01,922][func.train][INFO] - [TESTING] video: 21 | frame: 4325 / 4326
[2024-06-14 15:36:01,922][func.train][INFO] - [TESTING] video: 21 | video test time: 0.39 min | total test time: 2.52 min
[2024-06-14 15:36:01,996][func.train][INFO] - [TESTING] video: 21 | video_mean_curr_acc: 0.562 | mean_acc_future_frames: 0.3882 | video_mean_cum_acc_future: 0.4114
[2024-06-14 15:36:17,882][func.train][INFO] - [TESTING] Best epoch: 1 | Best cum_acc_future: 0.4
