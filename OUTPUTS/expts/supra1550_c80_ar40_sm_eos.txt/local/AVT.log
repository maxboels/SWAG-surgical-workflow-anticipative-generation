[2024-04-26 19:54:51,708][func.train][INFO] - Dist info:
[2024-04-26 19:54:51,709][func.train][INFO] - torch version: 2.2.2+cu121
[2024-04-26 19:54:51,709][func.train][INFO] - torchvision version: 0.17.2+cu121
[2024-04-26 19:54:51,710][func.train][INFO] - hydra version: 1.3.2
[2024-04-26 19:54:51,729][func.train][INFO] - Loading data
[2024-04-26 19:54:51,730][func.train][INFO] - Loading datasets
[2024-04-26 19:57:59,041][func.train][INFO] - [DATASET] ALL loaded dataframe in 3m 7s
[2024-04-26 19:57:59,043][func.train][INFO] - [DATASET] ALL loaded dataframe: (4612530, 11)
[2024-04-26 19:58:29,748][func.train][INFO] - [DATASET] params: {'debug': False, 'dataset_name': 'cholec80', 'reduc_feats_folder': 'train_targets_x_mp/', 'num_classes': 7, 'num_next_labels': 6, 'last_seg_class': 7, 'predict_next_phase': True, 'get_target_feats': False, 'replace_current_with_next_class': False}
[2024-04-26 20:00:57,218][func.train][INFO] - [DATASET] train size: 2157640
[2024-04-26 20:00:57,221][func.train][INFO] - [DATASET] train video_indices: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40]
[2024-04-26 20:00:57,428][func.train][INFO] - [DATASET] Sampling video_idx: 1 at 25 fps to 1733 frames
[2024-04-26 20:00:57,896][func.train][INFO] - [DATASET] video 1 label_list: torch.Size([1733])
[2024-04-26 20:00:58,418][func.train][INFO] - [DATASET] Sampling video_idx: 2 at 25 fps to 2839 frames
[2024-04-26 20:00:58,422][func.train][INFO] - [DATASET] video 2 label_list: torch.Size([2839])
[2024-04-26 20:00:58,656][func.train][INFO] - [DATASET] Sampling video_idx: 3 at 25 fps to 5828 frames
[2024-04-26 20:00:58,661][func.train][INFO] - [DATASET] video 3 label_list: torch.Size([5828])
[2024-04-26 20:00:58,883][func.train][INFO] - [DATASET] Sampling video_idx: 4 at 25 fps to 1522 frames
[2024-04-26 20:00:58,885][func.train][INFO] - [DATASET] video 4 label_list: torch.Size([1522])
[2024-04-26 20:00:59,096][func.train][INFO] - [DATASET] Sampling video_idx: 5 at 25 fps to 2344 frames
[2024-04-26 20:00:59,099][func.train][INFO] - [DATASET] video 5 label_list: torch.Size([2344])
[2024-04-26 20:00:59,304][func.train][INFO] - [DATASET] Sampling video_idx: 6 at 25 fps to 2153 frames
[2024-04-26 20:00:59,307][func.train][INFO] - [DATASET] video 6 label_list: torch.Size([2153])
[2024-04-26 20:00:59,534][func.train][INFO] - [DATASET] Sampling video_idx: 7 at 25 fps to 4557 frames
[2024-04-26 20:00:59,538][func.train][INFO] - [DATASET] video 7 label_list: torch.Size([4557])
[2024-04-26 20:00:59,743][func.train][INFO] - [DATASET] Sampling video_idx: 8 at 25 fps to 1519 frames
[2024-04-26 20:00:59,746][func.train][INFO] - [DATASET] video 8 label_list: torch.Size([1519])
[2024-04-26 20:00:59,972][func.train][INFO] - [DATASET] Sampling video_idx: 9 at 25 fps to 2702 frames
[2024-04-26 20:00:59,975][func.train][INFO] - [DATASET] video 9 label_list: torch.Size([2702])
[2024-04-26 20:01:00,184][func.train][INFO] - [DATASET] Sampling video_idx: 10 at 25 fps to 1749 frames
[2024-04-26 20:01:00,187][func.train][INFO] - [DATASET] video 10 label_list: torch.Size([1749])
[2024-04-26 20:01:00,422][func.train][INFO] - [DATASET] Sampling video_idx: 11 at 25 fps to 3220 frames
[2024-04-26 20:01:00,426][func.train][INFO] - [DATASET] video 11 label_list: torch.Size([3220])
[2024-04-26 20:01:00,635][func.train][INFO] - [DATASET] Sampling video_idx: 12 at 25 fps to 1090 frames
[2024-04-26 20:01:00,637][func.train][INFO] - [DATASET] video 12 label_list: torch.Size([1090])
[2024-04-26 20:01:00,824][func.train][INFO] - [DATASET] Sampling video_idx: 13 at 25 fps to 981 frames
[2024-04-26 20:01:00,826][func.train][INFO] - [DATASET] video 13 label_list: torch.Size([981])
[2024-04-26 20:01:01,049][func.train][INFO] - [DATASET] Sampling video_idx: 14 at 25 fps to 1708 frames
[2024-04-26 20:01:01,052][func.train][INFO] - [DATASET] video 14 label_list: torch.Size([1708])
[2024-04-26 20:01:01,259][func.train][INFO] - [DATASET] Sampling video_idx: 15 at 25 fps to 2058 frames
[2024-04-26 20:01:01,262][func.train][INFO] - [DATASET] video 15 label_list: torch.Size([2058])
[2024-04-26 20:01:01,476][func.train][INFO] - [DATASET] Sampling video_idx: 16 at 25 fps to 2957 frames
[2024-04-26 20:01:01,480][func.train][INFO] - [DATASET] video 16 label_list: torch.Size([2957])
[2024-04-26 20:01:01,686][func.train][INFO] - [DATASET] Sampling video_idx: 17 at 25 fps to 1304 frames
[2024-04-26 20:01:01,689][func.train][INFO] - [DATASET] video 17 label_list: torch.Size([1304])
[2024-04-26 20:01:01,880][func.train][INFO] - [DATASET] Sampling video_idx: 18 at 25 fps to 1942 frames
[2024-04-26 20:01:01,883][func.train][INFO] - [DATASET] video 18 label_list: torch.Size([1942])
[2024-04-26 20:01:02,127][func.train][INFO] - [DATASET] Sampling video_idx: 19 at 25 fps to 2424 frames
[2024-04-26 20:01:02,130][func.train][INFO] - [DATASET] video 19 label_list: torch.Size([2424])
[2024-04-26 20:01:02,331][func.train][INFO] - [DATASET] Sampling video_idx: 20 at 25 fps to 1449 frames
[2024-04-26 20:01:02,333][func.train][INFO] - [DATASET] video 20 label_list: torch.Size([1449])
[2024-04-26 20:01:02,490][func.train][INFO] - [DATASET] Sampling video_idx: 21 at 25 fps to 1258 frames
[2024-04-26 20:01:02,492][func.train][INFO] - [DATASET] video 21 label_list: torch.Size([1258])
[2024-04-26 20:01:02,626][func.train][INFO] - [DATASET] Sampling video_idx: 22 at 25 fps to 1532 frames
[2024-04-26 20:01:02,628][func.train][INFO] - [DATASET] video 22 label_list: torch.Size([1532])
[2024-04-26 20:01:02,743][func.train][INFO] - [DATASET] Sampling video_idx: 23 at 25 fps to 1635 frames
[2024-04-26 20:01:02,744][func.train][INFO] - [DATASET] video 23 label_list: torch.Size([1635])
[2024-04-26 20:01:02,875][func.train][INFO] - [DATASET] Sampling video_idx: 24 at 25 fps to 1975 frames
[2024-04-26 20:01:02,877][func.train][INFO] - [DATASET] video 24 label_list: torch.Size([1975])
[2024-04-26 20:01:03,001][func.train][INFO] - [DATASET] Sampling video_idx: 25 at 25 fps to 2129 frames
[2024-04-26 20:01:03,003][func.train][INFO] - [DATASET] video 25 label_list: torch.Size([2129])
[2024-04-26 20:01:03,237][func.train][INFO] - [DATASET] Sampling video_idx: 26 at 25 fps to 1773 frames
[2024-04-26 20:01:03,240][func.train][INFO] - [DATASET] video 26 label_list: torch.Size([1773])
[2024-04-26 20:01:03,469][func.train][INFO] - [DATASET] Sampling video_idx: 27 at 25 fps to 2084 frames
[2024-04-26 20:01:03,471][func.train][INFO] - [DATASET] video 27 label_list: torch.Size([2084])
[2024-04-26 20:01:03,683][func.train][INFO] - [DATASET] Sampling video_idx: 28 at 25 fps to 1199 frames
[2024-04-26 20:01:03,685][func.train][INFO] - [DATASET] video 28 label_list: torch.Size([1199])
[2024-04-26 20:01:03,829][func.train][INFO] - [DATASET] Sampling video_idx: 29 at 25 fps to 2350 frames
[2024-04-26 20:01:03,831][func.train][INFO] - [DATASET] video 29 label_list: torch.Size([2350])
[2024-04-26 20:01:03,988][func.train][INFO] - [DATASET] Sampling video_idx: 30 at 25 fps to 2925 frames
[2024-04-26 20:01:03,990][func.train][INFO] - [DATASET] video 30 label_list: torch.Size([2925])
[2024-04-26 20:01:04,190][func.train][INFO] - [DATASET] Sampling video_idx: 31 at 25 fps to 3945 frames
[2024-04-26 20:01:04,195][func.train][INFO] - [DATASET] video 31 label_list: torch.Size([3945])
[2024-04-26 20:01:04,489][func.train][INFO] - [DATASET] Sampling video_idx: 32 at 25 fps to 2116 frames
[2024-04-26 20:01:04,493][func.train][INFO] - [DATASET] video 32 label_list: torch.Size([2116])
[2024-04-26 20:01:04,683][func.train][INFO] - [DATASET] Sampling video_idx: 33 at 25 fps to 1307 frames
[2024-04-26 20:01:04,684][func.train][INFO] - [DATASET] video 33 label_list: torch.Size([1307])
[2024-04-26 20:01:04,890][func.train][INFO] - [DATASET] Sampling video_idx: 34 at 25 fps to 1323 frames
[2024-04-26 20:01:04,893][func.train][INFO] - [DATASET] video 34 label_list: torch.Size([1323])
[2024-04-26 20:01:05,099][func.train][INFO] - [DATASET] Sampling video_idx: 35 at 25 fps to 2106 frames
[2024-04-26 20:01:05,109][func.train][INFO] - [DATASET] video 35 label_list: torch.Size([2106])
[2024-04-26 20:01:05,333][func.train][INFO] - [DATASET] Sampling video_idx: 36 at 25 fps to 2387 frames
[2024-04-26 20:01:05,336][func.train][INFO] - [DATASET] video 36 label_list: torch.Size([2387])
[2024-04-26 20:01:05,580][func.train][INFO] - [DATASET] Sampling video_idx: 37 at 25 fps to 1232 frames
[2024-04-26 20:01:05,581][func.train][INFO] - [DATASET] video 37 label_list: torch.Size([1232])
[2024-04-26 20:01:05,787][func.train][INFO] - [DATASET] Sampling video_idx: 38 at 25 fps to 3080 frames
[2024-04-26 20:01:05,790][func.train][INFO] - [DATASET] video 38 label_list: torch.Size([3080])
[2024-04-26 20:01:06,023][func.train][INFO] - [DATASET] Sampling video_idx: 39 at 25 fps to 1647 frames
[2024-04-26 20:01:06,026][func.train][INFO] - [DATASET] video 39 label_list: torch.Size([1647])
[2024-04-26 20:01:06,251][func.train][INFO] - [DATASET] Sampling video_idx: 40 at 25 fps to 2222 frames
[2024-04-26 20:01:06,263][func.train][INFO] - [DATASET] video 40 label_list: torch.Size([2222])
[2024-04-26 20:01:06,905][func.train][INFO] - [DATASET] number of train videos: 40
[2024-04-26 20:01:06,906][func.train][INFO] - [DATASET] avg video length: 35.96 minutes
[2024-04-26 20:01:50,360][func.train][INFO] - [DATASET] classes_counts: {0: 93902, 1: 922150, 2: 183225, 3: 602975, 4: 92900, 5: 180478, 6: 82010}
[2024-04-26 20:01:50,372][func.train][INFO] - [DATASET] curr_class_weights: tensor([0.3342, 1.6821, 0.5112, 3.3171, 1.7077, 3.7575, 3.2818])
[2024-04-26 20:03:50,848][func.train][INFO] - [DATASET] test size: 77576
[2024-04-26 20:03:50,849][func.train][INFO] - [DATASET] test video_indices: [41]
[2024-04-26 20:03:50,881][func.train][INFO] - [DATASET] Sampling video_idx: 41 at 25 fps to 3103 frames
[2024-04-26 20:03:50,883][func.train][INFO] - [DATASET] video 41 label_list: torch.Size([3103])
[2024-04-26 20:03:50,905][func.train][INFO] - [DATASET] number of test videos: 1
[2024-04-26 20:03:50,906][func.train][INFO] - [DATASET] avg video length: 51.72 minutes
[2024-04-26 20:06:21,826][func.train][INFO] - [DATASET] test size: 92801
[2024-04-26 20:06:21,827][func.train][INFO] - [DATASET] test video_indices: [42]
[2024-04-26 20:06:21,873][func.train][INFO] - [DATASET] Sampling video_idx: 42 at 25 fps to 3712 frames
[2024-04-26 20:06:21,878][func.train][INFO] - [DATASET] video 42 label_list: torch.Size([3712])
[2024-04-26 20:06:21,986][func.train][INFO] - [DATASET] number of test videos: 1
[2024-04-26 20:06:21,987][func.train][INFO] - [DATASET] avg video length: 61.87 minutes
[2024-04-26 20:08:47,599][func.train][INFO] - [DATASET] test size: 59051
[2024-04-26 20:08:47,600][func.train][INFO] - [DATASET] test video_indices: [43]
[2024-04-26 20:08:47,620][func.train][INFO] - [DATASET] Sampling video_idx: 43 at 25 fps to 2362 frames
[2024-04-26 20:08:47,622][func.train][INFO] - [DATASET] video 43 label_list: torch.Size([2362])
[2024-04-26 20:08:47,705][func.train][INFO] - [DATASET] number of test videos: 1
[2024-04-26 20:08:47,705][func.train][INFO] - [DATASET] avg video length: 39.37 minutes
[2024-04-26 20:11:45,865][func.train][INFO] - [DATASET] test size: 78176
[2024-04-26 20:11:45,867][func.train][INFO] - [DATASET] test video_indices: [44]
[2024-04-26 20:11:45,888][func.train][INFO] - [DATASET] Sampling video_idx: 44 at 25 fps to 3127 frames
[2024-04-26 20:11:45,890][func.train][INFO] - [DATASET] video 44 label_list: torch.Size([3127])
[2024-04-26 20:11:45,988][func.train][INFO] - [DATASET] number of test videos: 1
[2024-04-26 20:11:45,989][func.train][INFO] - [DATASET] avg video length: 52.12 minutes
